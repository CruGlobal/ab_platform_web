{"version":3,"file":"reports.min.js","sources":["../node_modules/webix-jet/dist/es6/jet.js","../node_modules/jet-restate/index.js","../sources/views/common/export.js","../sources/views/common/toolbar.js","../sources/views/chart.js","../sources/jet-restate-bind/index.js","../sources/helpers/inputlist.js","../sources/helpers/icons.js","../node_modules/@xbs/query/codebase/query.js","../sources/views/editor/common.js","../sources/helpers/prompt.js","../sources/helpers/queryselect.js","../sources/views/editor/query.js","../sources/views/editor/data.js","../sources/views/editor/index.js","../sources/views/editor/other/summarypopup.js","../sources/views/editor/other/bucket.js","../sources/views/editor/other/bucketpopup.js","../sources/helpers/groupselect.js","../sources/views/editor/other/buckets.js","../sources/views/editor/other/datepopup.js","../sources/views/editor/other/summary.js","../sources/views/editor/other/groups.js","../sources/views/editor/other/index.js","../sources/views/editor/other/sorts.js","../sources/views/editor/structure/axis.js","../sources/views/editor/structure/baseview.js","../sources/views/editor/structure/colorpopup.js","../sources/helpers/rsearch.js","../sources/views/editor/structure/chartseries.js","../sources/views/editor/structure/chart.js","../sources/views/editor/structure/column.js","../sources/views/editor/structure/heatmap.js","../sources/views/editor/structure/index.js","../sources/views/editor/structure/table.js","../sources/views/empty.js","../sources/views/heatmap.js","../sources/views/menu.js","../sources/views/modules.js","../sources/views/table/export.js","../sources/views/table/toolbar.js","../sources/views/table/index.js","../node_modules/jet-hotkey/index.js","../sources/views/toolbar.js","../sources/views/top.js","../sources/export_views.js","../node_modules/@xbs/jet-helpers/jetWin.js","../sources/models/Local.js","../sources/models/Backend.js","../sources/models/Operations.js","../sources/models/Helpers.js","../sources/models/Charts.js","../sources/app.js","../sources/locales/en.js"],"sourcesContent":["class NavigationBlocked {\r\n}\n\nclass JetBase {\r\n    constructor(webix, config) {\r\n        this.webixJet = true;\r\n        this.webix = webix;\r\n        this._events = [];\r\n        this._subs = {};\r\n        this._data = {};\r\n        if (config && config.params)\r\n            webix.extend(this._data, config.params);\r\n    }\r\n    getRoot() {\r\n        return this._root;\r\n    }\r\n    destructor() {\r\n        this._detachEvents();\r\n        this._destroySubs();\r\n        this._events = this._container = this.app = this._parent = this._root = null;\r\n    }\r\n    setParam(id, value, url) {\r\n        if (this._data[id] !== value) {\r\n            this._data[id] = value;\r\n            this._segment.update(id, value, 0);\r\n            if (url) {\r\n                return this.show(null);\r\n            }\r\n        }\r\n    }\r\n    getParam(id, parent) {\r\n        const value = this._data[id];\r\n        if (typeof value !== \"undefined\" || !parent) {\r\n            return value;\r\n        }\r\n        const view = this.getParentView();\r\n        if (view) {\r\n            return view.getParam(id, parent);\r\n        }\r\n    }\r\n    getUrl() {\r\n        return this._segment.suburl();\r\n    }\r\n    getUrlString() {\r\n        return this._segment.toString();\r\n    }\r\n    getParentView() {\r\n        return this._parent;\r\n    }\r\n    $$(id) {\r\n        if (typeof id === \"string\") {\r\n            const root = this.getRoot();\r\n            return root.queryView((obj => (obj.config.id === id || obj.config.localId === id) &&\r\n                (obj.$scope === root.$scope)), \"self\");\r\n        }\r\n        else {\r\n            return id;\r\n        }\r\n    }\r\n    on(obj, name, code) {\r\n        const id = obj.attachEvent(name, code);\r\n        this._events.push({ obj, id });\r\n        return id;\r\n    }\r\n    contains(view) {\r\n        for (const key in this._subs) {\r\n            const kid = this._subs[key].view;\r\n            if (kid === view || kid.contains(view)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    getSubView(name) {\r\n        const sub = this.getSubViewInfo(name);\r\n        if (sub) {\r\n            return sub.subview.view;\r\n        }\r\n    }\r\n    getSubViewInfo(name) {\r\n        const sub = this._subs[name || \"default\"];\r\n        if (sub) {\r\n            return { subview: sub, parent: this };\r\n        }\r\n        if (name === \"_top\") {\r\n            this._subs[name] = { url: \"\", id: null, popup: true };\r\n            return this.getSubViewInfo(name);\r\n        }\r\n        // when called from a child view, searches for nearest parent with subview\r\n        if (this._parent) {\r\n            return this._parent.getSubViewInfo(name);\r\n        }\r\n        return null;\r\n    }\r\n    _detachEvents() {\r\n        const events = this._events;\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            events[i].obj.detachEvent(events[i].id);\r\n        }\r\n    }\r\n    _destroySubs() {\r\n        // destroy sub views\r\n        for (const key in this._subs) {\r\n            const subView = this._subs[key].view;\r\n            // it possible that subview was not loaded with any content yet\r\n            // so check on null\r\n            if (subView) {\r\n                subView.destructor();\r\n            }\r\n        }\r\n        // reset to prevent memory leaks\r\n        this._subs = {};\r\n    }\r\n    _init_url_data() {\r\n        const url = this._segment.current();\r\n        this._data = {};\r\n        this.webix.extend(this._data, url.params, true);\r\n    }\r\n    _getDefaultSub() {\r\n        if (this._subs.default) {\r\n            return this._subs.default;\r\n        }\r\n        for (const key in this._subs) {\r\n            const sub = this._subs[key];\r\n            if (!sub.branch && sub.view && key !== \"_top\") {\r\n                const child = sub.view._getDefaultSub();\r\n                if (child) {\r\n                    return child;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _routed_view() {\r\n        const parent = this.getParentView();\r\n        if (!parent) {\r\n            return true;\r\n        }\r\n        const sub = parent._getDefaultSub();\r\n        if (!sub && sub !== this) {\r\n            return false;\r\n        }\r\n        return parent._routed_view();\r\n    }\r\n}\n\nfunction parse(url) {\r\n    // remove starting /\r\n    if (url[0] === \"/\") {\r\n        url = url.substr(1);\r\n    }\r\n    // split url by \"/\"\r\n    const parts = url.split(\"/\");\r\n    const chunks = [];\r\n    // for each page in url\r\n    for (let i = 0; i < parts.length; i++) {\r\n        const test = parts[i];\r\n        const result = {};\r\n        // detect params\r\n        // support old \t\t\tsome:a=b:c=d\r\n        // and new notation\t\tsome?a=b&c=d\r\n        let pos = test.indexOf(\":\");\r\n        if (pos === -1) {\r\n            pos = test.indexOf(\"?\");\r\n        }\r\n        if (pos !== -1) {\r\n            const params = test.substr(pos + 1).split(/[\\:\\?\\&]/g);\r\n            // create hash of named params\r\n            for (const param of params) {\r\n                const dchunk = param.split(\"=\");\r\n                result[dchunk[0]] = decodeURIComponent(dchunk[1]);\r\n            }\r\n        }\r\n        // store parsed values\r\n        chunks[i] = {\r\n            page: (pos > -1 ? test.substr(0, pos) : test),\r\n            params: result,\r\n            isNew: true\r\n        };\r\n    }\r\n    // return array of page objects\r\n    return chunks;\r\n}\r\nfunction url2str(stack) {\r\n    const url = [];\r\n    for (const chunk of stack) {\r\n        url.push(\"/\" + chunk.page);\r\n        const params = obj2str(chunk.params);\r\n        if (params) {\r\n            url.push(\"?\" + params);\r\n        }\r\n    }\r\n    return url.join(\"\");\r\n}\r\nfunction obj2str(obj) {\r\n    const str = [];\r\n    for (const key in obj) {\r\n        if (typeof obj[key] === \"object\")\r\n            continue;\r\n        if (str.length) {\r\n            str.push(\"&\");\r\n        }\r\n        str.push(key + \"=\" + encodeURIComponent(obj[key]));\r\n    }\r\n    return str.join(\"\");\r\n}\n\nclass Route {\r\n    constructor(route, index) {\r\n        this._next = 1;\r\n        if (typeof route === \"string\") {\r\n            this.route = {\r\n                url: parse(route),\r\n                path: route\r\n            };\r\n        }\r\n        else {\r\n            this.route = route;\r\n        }\r\n        this.index = index;\r\n    }\r\n    current() {\r\n        return this.route.url[this.index];\r\n    }\r\n    next() {\r\n        return this.route.url[this.index + this._next];\r\n    }\r\n    suburl() {\r\n        return this.route.url.slice(this.index);\r\n    }\r\n    shift(params) {\r\n        const route = new Route(this.route, this.index + this._next);\r\n        route.setParams(route.route.url, params, route.index);\r\n        return route;\r\n    }\r\n    setParams(url, params, index) {\r\n        if (params) {\r\n            const old = url[index].params;\r\n            for (var key in params)\r\n                old[key] = params[key];\r\n        }\r\n    }\r\n    refresh() {\r\n        const url = this.route.url;\r\n        for (let i = this.index + 1; i < url.length; i++) {\r\n            url[i].isNew = true;\r\n        }\r\n    }\r\n    toString() {\r\n        const str = url2str(this.suburl());\r\n        return str ? str.substr(1) : \"\";\r\n    }\r\n    _join(path, kids) {\r\n        let url = this.route.url;\r\n        if (path === null) { // change of parameters, route elements are not affected\r\n            return url;\r\n        }\r\n        const old = this.route.url;\r\n        let reset = true;\r\n        url = old.slice(0, this.index + (kids ? this._next : 0));\r\n        if (path) {\r\n            url = url.concat(parse(path));\r\n            for (let i = 0; i < url.length; i++) {\r\n                if (old[i]) {\r\n                    url[i].view = old[i].view;\r\n                }\r\n                if (reset && old[i] && url[i].page === old[i].page) {\r\n                    url[i].isNew = false;\r\n                }\r\n                else if (url[i].isNew) {\r\n                    // if some segment was marked as new, all subsegments must be updated as well\r\n                    reset = false;\r\n                }\r\n            }\r\n        }\r\n        return url;\r\n    }\r\n    append(path) {\r\n        const url = this._join(path, true);\r\n        this.route.path = url2str(url);\r\n        this.route.url = url;\r\n        return this.route.path;\r\n    }\r\n    show(path, view, kids) {\r\n        const url = this._join(path.url, kids);\r\n        this.setParams(url, path.params, this.index + (kids ? this._next : 0));\r\n        return new Promise((res, rej) => {\r\n            const redirect = url2str(url);\r\n            const obj = {\r\n                url,\r\n                redirect,\r\n                confirm: Promise.resolve()\r\n            };\r\n            const app = view ? view.app : null;\r\n            // when creating a new route, it possible that it will not have any content\r\n            // guard is not necessary in such case\r\n            if (app) {\r\n                const result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\r\n                if (!result) {\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n            }\r\n            obj.confirm.catch(err => rej(err)).then(() => {\r\n                if (obj.redirect === null) {\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n                if (obj.redirect !== redirect) {\r\n                    app.show(obj.redirect);\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n                this.route.path = redirect;\r\n                this.route.url = url;\r\n                res();\r\n            });\r\n        });\r\n    }\r\n    size(n) {\r\n        this._next = n;\r\n    }\r\n    split() {\r\n        const route = {\r\n            url: this.route.url.slice(this.index + 1),\r\n            path: \"\"\r\n        };\r\n        if (route.url.length) {\r\n            route.path = url2str(route.url);\r\n        }\r\n        return new Route(route, 0);\r\n    }\r\n    update(name, value, index) {\r\n        const chunk = this.route.url[this.index + (index || 0)];\r\n        if (!chunk) {\r\n            this.route.url.push({ page: \"\", params: {} });\r\n            return this.update(name, value, index);\r\n        }\r\n        if (name === \"\") {\r\n            chunk.page = value;\r\n        }\r\n        else {\r\n            chunk.params[name] = value;\r\n        }\r\n        this.route.path = url2str(this.route.url);\r\n    }\r\n}\n\nclass JetView extends JetBase {\r\n    constructor(app, config) {\r\n        super(app.webix);\r\n        this.app = app;\r\n        //this.$config = config;\r\n        this._children = [];\r\n    }\r\n    ui(ui, config) {\r\n        config = config || {};\r\n        const container = config.container || ui.container;\r\n        const jetview = this.app.createView(ui);\r\n        this._children.push(jetview);\r\n        jetview.render(container, this._segment, this);\r\n        if (typeof ui !== \"object\" || (ui instanceof JetBase)) {\r\n            // raw webix UI\r\n            return jetview;\r\n        }\r\n        else {\r\n            return jetview.getRoot();\r\n        }\r\n    }\r\n    show(path, config) {\r\n        config = config || {};\r\n        // convert parameters object to url\r\n        if (typeof path === \"object\") {\r\n            for (const key in path) {\r\n                this.setParam(key, path[key]);\r\n            }\r\n            path = null;\r\n        }\r\n        else {\r\n            // deligate to app in case of root prefix\r\n            if (path.substr(0, 1) === \"/\") {\r\n                return this.app.show(path, config);\r\n            }\r\n            // local path, do nothing\r\n            if (path.indexOf(\"./\") === 0) {\r\n                path = path.substr(2);\r\n            }\r\n            // parent path, call parent view\r\n            if (path.indexOf(\"../\") === 0) {\r\n                const parent = this.getParentView();\r\n                if (parent) {\r\n                    return parent.show(path.substr(3), config);\r\n                }\r\n                else {\r\n                    return this.app.show(\"/\" + path.substr(3));\r\n                }\r\n            }\r\n            const sub = this.getSubViewInfo(config.target);\r\n            if (sub) {\r\n                if (sub.parent !== this) {\r\n                    return sub.parent.show(path, config);\r\n                }\r\n                else if (config.target && config.target !== \"default\") {\r\n                    return this._renderFrameLock(config.target, sub.subview, {\r\n                        url: path,\r\n                        params: config.params,\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                if (path) {\r\n                    return this.app.show(\"/\" + path, config);\r\n                }\r\n            }\r\n        }\r\n        return this._show(this._segment, { url: path, params: config.params }, this);\r\n    }\r\n    _show(segment, path, view) {\r\n        return segment.show(path, view, true).then(() => {\r\n            this._init_url_data();\r\n            return this._urlChange();\r\n        }).then(() => {\r\n            if (segment.route.linkRouter) {\r\n                this.app.getRouter().set(segment.route.path, { silent: true });\r\n                this.app.callEvent(\"app:route\", [segment.route.path]);\r\n            }\r\n        });\r\n    }\r\n    init(_$view, _$) {\r\n        // stub\r\n    }\r\n    ready(_$view, _$url) {\r\n        // stub\r\n    }\r\n    config() {\r\n        this.app.webix.message(\"View:Config is not implemented\");\r\n    }\r\n    urlChange(_$view, _$url) {\r\n        // stub\r\n    }\r\n    destroy() {\r\n        // stub\r\n    }\r\n    destructor() {\r\n        this.destroy();\r\n        this._destroyKids();\r\n        // destroy actual UI\r\n        if (this._root) {\r\n            this._root.destructor();\r\n            super.destructor();\r\n        }\r\n    }\r\n    use(plugin, config) {\r\n        plugin(this.app, this, config);\r\n    }\r\n    refresh() {\r\n        const url = this.getUrl();\r\n        this.destroy();\r\n        this._destroyKids();\r\n        this._destroySubs();\r\n        this._detachEvents();\r\n        if (this._container.tagName) {\r\n            this._root.destructor();\r\n        }\r\n        this._segment.refresh();\r\n        return this._render(this._segment);\r\n    }\r\n    render(root, url, parent) {\r\n        if (typeof url === \"string\") {\r\n            url = new Route(url, 0);\r\n        }\r\n        this._segment = url;\r\n        this._parent = parent;\r\n        this._init_url_data();\r\n        root = root || document.body;\r\n        const _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\r\n        if (this._container !== _container) {\r\n            this._container = _container;\r\n            return this._render(url);\r\n        }\r\n        else {\r\n            return this._urlChange().then(() => this.getRoot());\r\n        }\r\n    }\r\n    _render(url) {\r\n        const config = this.config();\r\n        if (config.then) {\r\n            return config.then(cfg => this._render_final(cfg, url));\r\n        }\r\n        else {\r\n            return this._render_final(config, url);\r\n        }\r\n    }\r\n    _render_final(config, url) {\r\n        // get previous view in the same slot\r\n        let slot = null;\r\n        let container = null;\r\n        let show = false;\r\n        if (!this._container.tagName) {\r\n            slot = this._container;\r\n            if (slot.popup) {\r\n                container = document.body;\r\n                show = true;\r\n            }\r\n            else {\r\n                container = this.webix.$$(slot.id);\r\n            }\r\n        }\r\n        else {\r\n            container = this._container;\r\n        }\r\n        // view already destroyed\r\n        if (!this.app || !container) {\r\n            return Promise.reject(null);\r\n        }\r\n        let response;\r\n        const current = this._segment.current();\r\n        // using wrapper object, so ui can be changed from app:render event\r\n        const result = { ui: {} };\r\n        this.app.copyConfig(config, result.ui, this._subs);\r\n        this.app.callEvent(\"app:render\", [this, url, result]);\r\n        result.ui.$scope = this;\r\n        /* destroy old HTML attached views before creating new one */\r\n        if (!slot && current.isNew && current.view) {\r\n            current.view.destructor();\r\n        }\r\n        try {\r\n            // special handling for adding inside of multiview - preserve old id\r\n            if (slot && !show) {\r\n                const oldui = container;\r\n                const parent = oldui.getParentView();\r\n                if (parent && parent.name === \"multiview\" && !result.ui.id) {\r\n                    result.ui.id = oldui.config.id;\r\n                }\r\n            }\r\n            this._root = this.app.webix.ui(result.ui, container);\r\n            const asWin = this._root;\r\n            // check for url added to ignore this.ui calls\r\n            if (show && asWin.setPosition && !asWin.isVisible()) {\r\n                asWin.show();\r\n            }\r\n            // check, if we are replacing some older view\r\n            if (slot) {\r\n                if (slot.view && slot.view !== this && slot.view !== this.app) {\r\n                    slot.view.destructor();\r\n                }\r\n                slot.id = this._root.config.id;\r\n                if (this.getParentView() || !this.app.app)\r\n                    slot.view = this;\r\n                else {\r\n                    // when we have subapp, set whole app as a view\r\n                    // so on destruction, the whole app will be destroyed\r\n                    slot.view = this.app;\r\n                }\r\n            }\r\n            if (current.isNew) {\r\n                current.view = this;\r\n                current.isNew = false;\r\n            }\r\n            response = Promise.resolve(this._init(this._root, url)).then(() => {\r\n                return this._urlChange().then(() => {\r\n                    this._initUrl = null;\r\n                    return this.ready(this._root, url.suburl());\r\n                });\r\n            });\r\n        }\r\n        catch (e) {\r\n            response = Promise.reject(e);\r\n        }\r\n        return response.catch(err => this._initError(this, err));\r\n    }\r\n    _init(view, url) {\r\n        return this.init(view, url.suburl());\r\n    }\r\n    _urlChange() {\r\n        this.app.callEvent(\"app:urlchange\", [this, this._segment]);\r\n        const waits = [];\r\n        for (const key in this._subs) {\r\n            const frame = this._subs[key];\r\n            const wait = this._renderFrameLock(key, frame, null);\r\n            if (wait) {\r\n                waits.push(wait);\r\n            }\r\n        }\r\n        return Promise.all(waits).then(() => {\r\n            return this.urlChange(this._root, this._segment.suburl());\r\n        });\r\n    }\r\n    _renderFrameLock(key, frame, path) {\r\n        // if subview is not occupied by some rendering yet\r\n        if (!frame.lock) {\r\n            // retreive and store rendering end promise\r\n            const lock = this._renderFrame(key, frame, path);\r\n            if (lock) {\r\n                // clear lock after frame rendering\r\n                // as promise.finally is not supported by  Webix lesser than 6.2\r\n                // using a more verbose notation\r\n                frame.lock = lock.then(() => frame.lock = null, () => frame.lock = null);\r\n            }\r\n        }\r\n        // return rendering end promise\r\n        return frame.lock;\r\n    }\r\n    _renderFrame(key, frame, path) {\r\n        //default route\r\n        if (key === \"default\") {\r\n            if (this._segment.next()) {\r\n                // we have a next segment in url, render it\r\n                let params = path ? path.params : null;\r\n                if (frame.params) {\r\n                    params = this.webix.extend(params || {}, frame.params);\r\n                }\r\n                return this._createSubView(frame, this._segment.shift(params));\r\n            }\r\n            else if (frame.view && frame.popup) {\r\n                // there is no next segment, delete the existing sub-view\r\n                frame.view.destructor();\r\n                frame.view = null;\r\n            }\r\n        }\r\n        //if new path provided, set it to the frame\r\n        if (path !== null) {\r\n            frame.url = path.url;\r\n            if (frame.params) {\r\n                path.params = this.webix.extend(path.params || {}, frame.params);\r\n            }\r\n        }\r\n        // in case of routed sub-view\r\n        if (frame.route) {\r\n            // we have a new path for sub-view\r\n            if (path !== null) {\r\n                return frame.route.show(path, frame.view).then(() => {\r\n                    return this._createSubView(frame, frame.route);\r\n                });\r\n            }\r\n            // do not trigger onChange for isolated sub-views\r\n            if (frame.branch) {\r\n                return;\r\n            }\r\n        }\r\n        let view = frame.view;\r\n        // if view doesn't exists yet, init it\r\n        if (!view && frame.url) {\r\n            if (typeof frame.url === \"string\") {\r\n                // string, so we have isolated subview url\r\n                frame.route = new Route(frame.url, 0);\r\n                if (path)\r\n                    frame.route.setParams(frame.route.route.url, path.params, 0);\r\n                if (frame.params)\r\n                    frame.route.setParams(frame.route.route.url, frame.params, 0);\r\n                return this._createSubView(frame, frame.route);\r\n            }\r\n            else {\r\n                // object, so we have an embeded subview\r\n                if (typeof frame.url === \"function\" && !(view instanceof frame.url)) {\r\n                    view = new (this.app._override(frame.url))(this.app, \"\");\r\n                }\r\n                if (!view) {\r\n                    view = frame.url;\r\n                }\r\n            }\r\n        }\r\n        // trigger onChange for already existed view\r\n        if (view) {\r\n            return view.render(frame, (frame.route || this._segment), this);\r\n        }\r\n    }\r\n    _initError(view, err) {\r\n        /*\r\n            if view is destroyed, ignore any view related errors\r\n        */\r\n        if (this.app) {\r\n            this.app.error(\"app:error:initview\", [err, view]);\r\n        }\r\n        return true;\r\n    }\r\n    _createSubView(sub, suburl) {\r\n        return this.app.createFromURL(suburl.current()).then(view => {\r\n            return view.render(sub, suburl, this);\r\n        });\r\n    }\r\n    _destroyKids() {\r\n        // destroy child views\r\n        const uis = this._children;\r\n        for (let i = uis.length - 1; i >= 0; i--) {\r\n            if (uis[i] && uis[i].destructor) {\r\n                uis[i].destructor();\r\n            }\r\n        }\r\n        // reset vars for better GC processing\r\n        this._children = [];\r\n    }\r\n}\n\n// wrapper for raw objects and Jet 1.x structs\r\nclass JetViewRaw extends JetView {\r\n    constructor(app, config) {\r\n        super(app, config);\r\n        this._ui = config.ui;\r\n    }\r\n    config() {\r\n        return this._ui;\r\n    }\r\n}\n\nclass SubRouter {\r\n    constructor(cb, config, app) {\r\n        this.path = \"\";\r\n        this.app = app;\r\n    }\r\n    set(path, config) {\r\n        this.path = path;\r\n        const a = this.app;\r\n        a.app.getRouter().set(a._segment.append(this.path), { silent: true });\r\n    }\r\n    get() {\r\n        return this.path;\r\n    }\r\n}\n\nlet _once = true;\r\nclass JetAppBase extends JetBase {\r\n    constructor(config) {\r\n        const webix = (config || {}).webix || window.webix;\r\n        config = webix.extend({\r\n            name: \"App\",\r\n            version: \"1.0\",\r\n            start: \"/home\"\r\n        }, config, true);\r\n        super(webix, config);\r\n        this.config = config;\r\n        this.app = this.config.app;\r\n        this.ready = Promise.resolve();\r\n        this._services = {};\r\n        this.webix.extend(this, this.webix.EventSystem);\r\n    }\r\n    getUrl() {\r\n        return this._subSegment.suburl();\r\n    }\r\n    getUrlString() {\r\n        return this._subSegment.toString();\r\n    }\r\n    getService(name) {\r\n        let obj = this._services[name];\r\n        if (typeof obj === \"function\") {\r\n            obj = this._services[name] = obj(this);\r\n        }\r\n        return obj;\r\n    }\r\n    setService(name, handler) {\r\n        this._services[name] = handler;\r\n    }\r\n    destructor() {\r\n        this.getSubView().destructor();\r\n        super.destructor();\r\n    }\r\n    // copy object and collect extra handlers\r\n    copyConfig(obj, target, config) {\r\n        // raw ui config\r\n        if (obj instanceof JetBase ||\r\n            (typeof obj === \"function\" && obj.prototype instanceof JetBase)) {\r\n            obj = { $subview: obj };\r\n        }\r\n        // subview placeholder\r\n        if (typeof obj.$subview != \"undefined\") {\r\n            return this.addSubView(obj, target, config);\r\n        }\r\n        // process sub-properties\r\n        const isArray = obj instanceof Array;\r\n        target = target || (isArray ? [] : {});\r\n        for (const method in obj) {\r\n            let point = obj[method];\r\n            // view class\r\n            if (typeof point === \"function\" && point.prototype instanceof JetBase) {\r\n                point = { $subview: point };\r\n            }\r\n            if (point && typeof point === \"object\" &&\r\n                !(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\r\n                if (point instanceof Date) {\r\n                    target[method] = new Date(point);\r\n                }\r\n                else {\r\n                    const copy = this.copyConfig(point, (point instanceof Array ? [] : {}), config);\r\n                    if (copy !== null) {\r\n                        if (isArray)\r\n                            target.push(copy);\r\n                        else\r\n                            target[method] = copy;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                target[method] = point;\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n    getRouter() {\r\n        return this.$router;\r\n    }\r\n    clickHandler(e, target) {\r\n        if (e) {\r\n            target = target || (e.target || e.srcElement);\r\n            if (target && target.getAttribute) {\r\n                const trigger = target.getAttribute(\"trigger\");\r\n                if (trigger) {\r\n                    this._forView(target, view => view.app.trigger(trigger));\r\n                    e.cancelBubble = true;\r\n                    return e.preventDefault();\r\n                }\r\n                const route = target.getAttribute(\"route\");\r\n                if (route) {\r\n                    this._forView(target, view => view.show(route));\r\n                    e.cancelBubble = true;\r\n                    return e.preventDefault();\r\n                }\r\n            }\r\n        }\r\n        const parent = target.parentNode;\r\n        if (parent) {\r\n            this.clickHandler(e, parent);\r\n        }\r\n    }\r\n    getRoot() {\r\n        return this.getSubView().getRoot();\r\n    }\r\n    refresh() {\r\n        if (!this._subSegment) {\r\n            return Promise.resolve(null);\r\n        }\r\n        return this.getSubView().refresh().then(view => {\r\n            this.callEvent(\"app:route\", [this.getUrl()]);\r\n            return view;\r\n        });\r\n    }\r\n    loadView(url) {\r\n        const views = this.config.views;\r\n        let result = null;\r\n        if (url === \"\") {\r\n            return Promise.resolve(this._loadError(\"\", new Error(\"Webix Jet: Empty url segment\")));\r\n        }\r\n        try {\r\n            if (views) {\r\n                if (typeof views === \"function\") {\r\n                    // custom loading strategy\r\n                    result = views(url);\r\n                }\r\n                else {\r\n                    // predefined hash\r\n                    result = views[url];\r\n                }\r\n                if (typeof result === \"string\") {\r\n                    url = result;\r\n                    result = null;\r\n                }\r\n            }\r\n            if (!result) {\r\n                if (url === \"_hidden\") {\r\n                    result = { hidden: true };\r\n                }\r\n                else if (url === \"_blank\") {\r\n                    result = {};\r\n                }\r\n                else {\r\n                    url = url.replace(/\\./g, \"/\");\r\n                    result = this.require(\"jet-views\", url);\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            result = this._loadError(url, e);\r\n        }\r\n        // custom handler can return view or its promise\r\n        if (!result.then) {\r\n            result = Promise.resolve(result);\r\n        }\r\n        // set error handler\r\n        result = result\r\n            .then(module => module.__esModule ? module.default : module)\r\n            .catch(err => this._loadError(url, err));\r\n        return result;\r\n    }\r\n    _forView(target, handler) {\r\n        const view = this.webix.$$(target);\r\n        if (view) {\r\n            handler(view.$scope);\r\n        }\r\n    }\r\n    _loadViewDynamic(url) {\r\n        return null;\r\n    }\r\n    createFromURL(chunk) {\r\n        let view;\r\n        if (chunk.isNew || !chunk.view) {\r\n            view = this.loadView(chunk.page)\r\n                .then(ui => this.createView(ui, name, chunk.params));\r\n        }\r\n        else {\r\n            view = Promise.resolve(chunk.view);\r\n        }\r\n        return view;\r\n    }\r\n    _override(ui) {\r\n        const over = this.config.override;\r\n        if (over) {\r\n            let dv;\r\n            while (ui) {\r\n                dv = ui;\r\n                ui = over.get(ui);\r\n            }\r\n            return dv;\r\n        }\r\n        return ui;\r\n    }\r\n    createView(ui, name, params) {\r\n        ui = this._override(ui);\r\n        let obj;\r\n        if (typeof ui === \"function\") {\r\n            if (ui.prototype instanceof JetAppBase) {\r\n                // UI class\r\n                return new ui({ app: this, name, params, router: SubRouter });\r\n            }\r\n            else if (ui.prototype instanceof JetBase) {\r\n                // UI class\r\n                return new ui(this, { name, params });\r\n            }\r\n            else {\r\n                // UI factory functions\r\n                ui = ui(this);\r\n            }\r\n        }\r\n        if (ui instanceof JetBase) {\r\n            obj = ui;\r\n        }\r\n        else {\r\n            // UI object\r\n            obj = new JetViewRaw(this, { name, ui });\r\n        }\r\n        return obj;\r\n    }\r\n    // show view path\r\n    show(url, config) {\r\n        if (url && this.app && url.indexOf(\"//\") == 0)\r\n            return this.app.show(url.substr(1), config);\r\n        return this.render(this._container, url || this.config.start, config);\r\n    }\r\n    // event helpers\r\n    trigger(name, ...rest) {\r\n        this.apply(name, rest);\r\n    }\r\n    apply(name, data) {\r\n        this.callEvent(name, data);\r\n    }\r\n    action(name) {\r\n        return this.webix.bind(function (...rest) {\r\n            this.apply(name, rest);\r\n        }, this);\r\n    }\r\n    on(name, handler) {\r\n        this.attachEvent(name, handler);\r\n    }\r\n    use(plugin, config) {\r\n        plugin(this, null, config);\r\n    }\r\n    error(name, er) {\r\n        this.callEvent(name, er);\r\n        this.callEvent(\"app:error\", er);\r\n        /* tslint:disable */\r\n        if (this.config.debug) {\r\n            for (var i = 0; i < er.length; i++) {\r\n                console.error(er[i]);\r\n                if (er[i] instanceof Error) {\r\n                    let text = er[i].message;\r\n                    if (text.indexOf(\"Module build failed\") === 0) {\r\n                        text = text.replace(/\\x1b\\[[0-9;]*m/g, \"\");\r\n                        document.body.innerHTML = `<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>${text}</pre>`;\r\n                    }\r\n                    else {\r\n                        text += \"<br><br>Check console for more details\";\r\n                        this.webix.message({ type: \"error\", text: text, expire: -1 });\r\n                    }\r\n                }\r\n            }\r\n            debugger;\r\n        }\r\n        /* tslint:enable */\r\n    }\r\n    // renders top view\r\n    render(root, url, config) {\r\n        this._container = (typeof root === \"string\") ?\r\n            this.webix.toNode(root) :\r\n            (root || document.body);\r\n        const firstInit = !this.$router;\r\n        let path = null;\r\n        if (firstInit) {\r\n            if (_once && \"tagName\" in this._container) {\r\n                this.webix.event(document.body, \"click\", e => this.clickHandler(e));\r\n                _once = false;\r\n            }\r\n            if (typeof url === \"string\") {\r\n                url = new Route(url, 0);\r\n            }\r\n            this._subSegment = this._first_start(url);\r\n            this._subSegment.route.linkRouter = true;\r\n        }\r\n        else {\r\n            if (typeof url === \"string\") {\r\n                path = url;\r\n            }\r\n            else {\r\n                if (this.app) {\r\n                    path = url.split().route.path || this.config.start;\r\n                }\r\n                else {\r\n                    path = url.toString();\r\n                }\r\n            }\r\n        }\r\n        const params = config ? config.params : this.config.params || null;\r\n        const top = this.getSubView();\r\n        const segment = this._subSegment;\r\n        const ready = segment\r\n            .show({ url: path, params }, top)\r\n            .then(() => this.createFromURL(segment.current()))\r\n            .then(view => view.render(root, segment))\r\n            .then(base => {\r\n            this.$router.set(segment.route.path, { silent: true });\r\n            this.callEvent(\"app:route\", [this.getUrl()]);\r\n            return base;\r\n        });\r\n        this.ready = this.ready.then(() => ready);\r\n        return ready;\r\n    }\r\n    getSubView() {\r\n        if (this._subSegment) {\r\n            const view = this._subSegment.current().view;\r\n            if (view)\r\n                return view;\r\n        }\r\n        return new JetView(this, {});\r\n    }\r\n    require(type, url) { return null; }\r\n    _first_start(route) {\r\n        this._segment = route;\r\n        const cb = (a) => setTimeout(() => {\r\n            this.show(a).catch(e => {\r\n                if (!(e instanceof NavigationBlocked))\r\n                    throw e;\r\n            });\r\n        }, 1);\r\n        this.$router = new (this.config.router)(cb, this.config, this);\r\n        // start animation for top-level app\r\n        if (this._container === document.body && this.config.animation !== false) {\r\n            const node = this._container;\r\n            this.webix.html.addCss(node, \"webixappstart\");\r\n            setTimeout(() => {\r\n                this.webix.html.removeCss(node, \"webixappstart\");\r\n                this.webix.html.addCss(node, \"webixapp\");\r\n            }, 10);\r\n        }\r\n        if (!route) {\r\n            // if no url defined, check router first\r\n            let urlString = this.$router.get();\r\n            if (!urlString) {\r\n                urlString = this.config.start;\r\n                this.$router.set(urlString, { silent: true });\r\n            }\r\n            route = new Route(urlString, 0);\r\n        }\r\n        else if (this.app) {\r\n            const now = route.current().view;\r\n            route.current().view = this;\r\n            if (route.next()) {\r\n                route.refresh();\r\n                route = route.split();\r\n            }\r\n            else {\r\n                route = new Route(this.config.start, 0);\r\n            }\r\n            route.current().view = now;\r\n        }\r\n        return route;\r\n    }\r\n    // error during view resolving\r\n    _loadError(url, err) {\r\n        this.error(\"app:error:resolve\", [err, url]);\r\n        return { template: \" \" };\r\n    }\r\n    addSubView(obj, target, config) {\r\n        const url = obj.$subview !== true ? obj.$subview : null;\r\n        const name = obj.name || (url ? this.webix.uid() : \"default\");\r\n        target.id = obj.id || \"s\" + this.webix.uid();\r\n        const view = config[name] = {\r\n            id: target.id,\r\n            url,\r\n            branch: obj.branch,\r\n            popup: obj.popup,\r\n            params: obj.params\r\n        };\r\n        return view.popup ? null : target;\r\n    }\r\n}\n\nclass HashRouter {\r\n    constructor(cb, config) {\r\n        this.config = config || {};\r\n        this._detectPrefix();\r\n        this.cb = cb;\r\n        window.onpopstate = () => this.cb(this.get());\r\n    }\r\n    set(path, config) {\r\n        if (this.config.routes) {\r\n            const compare = path.split(\"?\", 2);\r\n            for (const key in this.config.routes) {\r\n                if (this.config.routes[key] === compare[0]) {\r\n                    path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (this.get() !== path) {\r\n            window.history.pushState(null, null, this.prefix + this.sufix + path);\r\n        }\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        let path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\r\n        path = (path !== \"/\" && path !== \"#\") ? path : \"\";\r\n        if (this.config.routes) {\r\n            const compare = path.split(\"?\", 2);\r\n            const key = this.config.routes[compare[0]];\r\n            if (key) {\r\n                path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\r\n            }\r\n        }\r\n        return path;\r\n    }\r\n    _detectPrefix() {\r\n        // use \"#!\" for backward compatibility\r\n        const sufix = this.config.routerPrefix;\r\n        this.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\r\n        this.prefix = document.location.href.split(\"#\", 2)[0];\r\n    }\r\n    _getRaw() {\r\n        return document.location.href;\r\n    }\r\n}\n\nlet isPatched = false;\r\nfunction patch(w) {\r\n    if (isPatched || !w) {\r\n        return;\r\n    }\r\n    isPatched = true;\r\n    // custom promise for IE8\r\n    const win = window;\r\n    if (!win.Promise) {\r\n        win.Promise = w.promise;\r\n    }\r\n    const version = w.version.split(\".\");\r\n    // will be fixed in webix 5.3\r\n    if (version[0] * 10 + version[1] * 1 < 53) {\r\n        w.ui.freeze = function (handler) {\r\n            // disabled because webix jet 5.0 can't handle resize of scrollview correctly\r\n            // w.ui.$freeze = true;\r\n            const res = handler();\r\n            if (res && res.then) {\r\n                res.then(function (some) {\r\n                    w.ui.$freeze = false;\r\n                    w.ui.resize();\r\n                    return some;\r\n                });\r\n            }\r\n            else {\r\n                w.ui.$freeze = false;\r\n                w.ui.resize();\r\n            }\r\n            return res;\r\n        };\r\n    }\r\n    // adding views as classes\r\n    const baseAdd = w.ui.baselayout.prototype.addView;\r\n    const baseRemove = w.ui.baselayout.prototype.removeView;\r\n    const config = {\r\n        addView(view, index) {\r\n            // trigger logic only for widgets inside of jet-view\r\n            // ignore case when addView used with already initialized widget\r\n            if (this.$scope && this.$scope.webixJet && !view.queryView) {\r\n                const jview = this.$scope;\r\n                const subs = {};\r\n                view = jview.app.copyConfig(view, {}, subs);\r\n                baseAdd.apply(this, [view, index]);\r\n                for (const key in subs) {\r\n                    jview._renderFrame(key, subs[key], null).then(() => {\r\n                        jview._subs[key] = subs[key];\r\n                    });\r\n                }\r\n                return view.id;\r\n            }\r\n            else {\r\n                return baseAdd.apply(this, arguments);\r\n            }\r\n        },\r\n        removeView() {\r\n            baseRemove.apply(this, arguments);\r\n            if (this.$scope && this.$scope.webixJet) {\r\n                const subs = this.$scope._subs;\r\n                // check all sub-views, destroy and clean the removed one\r\n                for (const key in subs) {\r\n                    const test = subs[key];\r\n                    if (!w.$$(test.id)) {\r\n                        test.view.destructor();\r\n                        delete subs[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    w.extend(w.ui.layout.prototype, config, true);\r\n    w.extend(w.ui.baselayout.prototype, config, true);\r\n    // wrapper for using Jet Apps as views\r\n    w.protoUI({\r\n        name: \"jetapp\",\r\n        $init(cfg) {\r\n            this.$app = new this.app(cfg);\r\n            const id = w.uid().toString();\r\n            cfg.body = { id };\r\n            this.$ready.push(function () {\r\n                this.callEvent(\"onInit\", [this.$app]);\r\n                this.$app.render({ id });\r\n            });\r\n        }\r\n    }, w.ui.proxy, w.EventSystem);\r\n}\n\nclass JetApp extends JetAppBase {\r\n    constructor(config) {\r\n        config.router = config.router || HashRouter;\r\n        super(config);\r\n        patch(this.webix);\r\n    }\r\n    require(type, url) {\r\n        return require(type + \"/\" + url);\r\n    }\r\n}\n\nclass StoreRouter {\r\n    constructor(cb, config, app) {\r\n        this.storage = config.storage || app.webix.storage.session;\r\n        this.name = (config.storeName || config.id + \":route\");\r\n        this.cb = cb;\r\n    }\r\n    set(path, config) {\r\n        this.storage.put(this.name, path);\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        return this.storage.get(this.name);\r\n    }\r\n}\n\nclass UrlRouter extends HashRouter {\r\n    _detectPrefix() {\r\n        this.prefix = \"\";\r\n        this.sufix = this.config.routerPrefix || \"\";\r\n    }\r\n    _getRaw() {\r\n        return document.location.pathname + (document.location.search || \"\");\r\n    }\r\n}\n\nclass EmptyRouter {\r\n    constructor(cb, _$config) {\r\n        this.path = \"\";\r\n        this.cb = cb;\r\n    }\r\n    set(path, config) {\r\n        this.path = path;\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        return this.path;\r\n    }\r\n}\n\nfunction UnloadGuard(app, view, config) {\r\n    view.on(app, `app:guard`, function (_$url, point, promise) {\r\n        if (point === view || point.contains(view)) {\r\n            const res = config();\r\n            if (res === false) {\r\n                promise.confirm = Promise.reject(new NavigationBlocked());\r\n            }\r\n            else {\r\n                promise.confirm = promise.confirm.then(() => res);\r\n            }\r\n        }\r\n    });\r\n}\n\n//     (c) 2012-2018 Airbnb, Inc.\n\n// var has = require('has');\nfunction has(store, key) {\n  return Object.prototype.hasOwnProperty.call(store, key);\n}\n// var forEach = require('for-each');\nfunction forEach(obj, handler, context) {\n  for (var key in obj) {\n    if (has(obj, key)) {\n      handler.call((context || obj), obj[key], key, obj);\n    }\n  }\n}\n// var trim = require('string.prototype.trim');\nfunction trim(str) {\n  return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n}\n// var warning = require('warning');\nfunction warn(message) {\n  message = 'Warning: ' + message;\n  if (typeof console !== 'undefined') {\n    console.error(message);\n  }\n\n  try { throw new Error(message); } catch (x) {}\n}\n\nvar replace = String.prototype.replace;\nvar split = String.prototype.split;\n\n// #### Pluralization methods\n// The string that separates the different phrase possibilities.\nvar delimiter = '||||';\n\nvar russianPluralGroups = function (n) {\n  var end = n % 10;\n  if (n !== 11 && end === 1) {\n    return 0;\n  }\n  if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n    return 1;\n  }\n  return 2;\n};\n\n// Mapping from pluralization group plural logic.\nvar pluralTypes = {\n  arabic: function (n) {\n    // http://www.arabeyes.org/Plural_Forms\n    if (n < 3) { return n; }\n    var lastTwo = n % 100;\n    if (lastTwo >= 3 && lastTwo <= 10) return 3;\n    return lastTwo >= 11 ? 4 : 5;\n  },\n  bosnian_serbian: russianPluralGroups,\n  chinese: function () { return 0; },\n  croatian: russianPluralGroups,\n  french: function (n) { return n > 1 ? 1 : 0; },\n  german: function (n) { return n !== 1 ? 1 : 0; },\n  russian: russianPluralGroups,\n  lithuanian: function (n) {\n    if (n % 10 === 1 && n % 100 !== 11) { return 0; }\n    return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n  },\n  czech: function (n) {\n    if (n === 1) { return 0; }\n    return (n >= 2 && n <= 4) ? 1 : 2;\n  },\n  polish: function (n) {\n    if (n === 1) { return 0; }\n    var end = n % 10;\n    return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n  },\n  icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n  slovenian: function (n) {\n    var lastTwo = n % 100;\n    if (lastTwo === 1) {\n      return 0;\n    }\n    if (lastTwo === 2) {\n      return 1;\n    }\n    if (lastTwo === 3 || lastTwo === 4) {\n      return 2;\n    }\n    return 3;\n  }\n};\n\n\n// Mapping from pluralization group to individual language codes/locales.\n// Will look up based on exact match, if not found and it's a locale will parse the locale\n// for language code, and if that does not exist will default to 'en'\nvar pluralTypeToLanguages = {\n  arabic: ['ar'],\n  bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n  chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n  croatian: ['hr', 'hr-HR'],\n  german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n  french: ['fr', 'tl', 'pt-br'],\n  russian: ['ru', 'ru-RU'],\n  lithuanian: ['lt'],\n  czech: ['cs', 'cs-CZ', 'sk'],\n  polish: ['pl'],\n  icelandic: ['is'],\n  slovenian: ['sl-SL']\n};\n\nfunction langToTypeMap(mapping) {\n  var ret = {};\n  forEach(mapping, function (langs, type) {\n    forEach(langs, function (lang) {\n      ret[lang] = type;\n    });\n  });\n  return ret;\n}\n\nfunction pluralTypeName(locale) {\n  var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n  return langToPluralType[locale]\n    || langToPluralType[split.call(locale, /-/, 1)[0]]\n    || langToPluralType.en;\n}\n\nfunction pluralTypeIndex(locale, count) {\n  return pluralTypes[pluralTypeName(locale)](count);\n}\n\nfunction escape(token) {\n  return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\nfunction constructTokenRegex(opts) {\n  var prefix = (opts && opts.prefix) || '%{';\n  var suffix = (opts && opts.suffix) || '}';\n\n  if (prefix === delimiter || suffix === delimiter) {\n    throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n  }\n\n  return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n}\n\nvar dollarRegex = /\\$/g;\nvar dollarBillsYall = '$$';\nvar defaultTokenRegex = /%\\{(.*?)\\}/g;\n\n// ### transformPhrase(phrase, substitutions, locale)\n//\n// Takes a phrase string and transforms it by choosing the correct\n// plural form and interpolating it.\n//\n//     transformPhrase('Hello, %{name}!', {name: 'Spike'});\n//     // \"Hello, Spike!\"\n//\n// The correct plural form is selected if substitutions.smart_count\n// is set. You can pass in a number instead of an Object as `substitutions`\n// as a shortcut for `smart_count`.\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 1}, 'en');\n//     // \"1 new message\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 2}, 'en');\n//     // \"2 new messages\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', 5, 'en');\n//     // \"5 new messages\"\n//\n// You should pass in a third argument, the locale, to specify the correct plural type.\n// It defaults to `'en'` with 2 plural forms.\nfunction transformPhrase(phrase, substitutions, locale, tokenRegex) {\n  if (typeof phrase !== 'string') {\n    throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n  }\n\n  if (substitutions == null) {\n    return phrase;\n  }\n\n  var result = phrase;\n  var interpolationRegex = tokenRegex || defaultTokenRegex;\n\n  // allow number as a pluralization shortcut\n  var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n\n  // Select plural form: based on a phrase text that contains `n`\n  // plural forms separated by `delimiter`, a `locale`, and a `substitutions.smart_count`,\n  // choose the correct plural form. This is only done if `count` is set.\n  if (options.smart_count != null && result) {\n    var texts = split.call(result, delimiter);\n    result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n  }\n\n  // Interpolate: Creates a `RegExp` object for each interpolation placeholder.\n  result = replace.call(result, interpolationRegex, function (expression, argument) {\n    if (!has(options, argument) || options[argument] == null) { return expression; }\n    // Ensure replacement value is escaped to prevent special $-prefixed regex replace tokens.\n    return replace.call(options[argument], dollarRegex, dollarBillsYall);\n  });\n\n  return result;\n}\n\n// ### Polyglot class constructor\nfunction Polyglot(options) {\n  var opts = options || {};\n  this.phrases = {};\n  this.extend(opts.phrases || {});\n  this.currentLocale = opts.locale || 'en';\n  var allowMissing = opts.allowMissing ? transformPhrase : null;\n  this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n  this.warn = opts.warn || warn;\n  this.tokenRegex = constructTokenRegex(opts.interpolation);\n}\n\n// ### polyglot.locale([locale])\n//\n// Get or set locale. Internally, Polyglot only uses locale for pluralization.\nPolyglot.prototype.locale = function (newLocale) {\n  if (newLocale) this.currentLocale = newLocale;\n  return this.currentLocale;\n};\n\n// ### polyglot.extend(phrases)\n//\n// Use `extend` to tell Polyglot how to translate a given key.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The key can be any string.  Feel free to call `extend` multiple times;\n// it will override any phrases with the same key, but leave existing phrases\n// untouched.\n//\n// It is also possible to pass nested phrase objects, which get flattened\n// into an object with the nested keys concatenated using dot notation.\n//\n//     polyglot.extend({\n//       \"nav\": {\n//         \"hello\": \"Hello\",\n//         \"hello_name\": \"Hello, %{name}\",\n//         \"sidebar\": {\n//           \"welcome\": \"Welcome\"\n//         }\n//       }\n//     });\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}',\n//     //   'nav.sidebar.welcome': 'Welcome'\n//     // }\n//\n// `extend` accepts an optional second argument, `prefix`, which can be used\n// to prefix every key in the phrases object with some string, using dot\n// notation.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     }, \"nav\");\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}'\n//     // }\n//\n// This feature is used internally to support nested phrase objects.\nPolyglot.prototype.extend = function (morePhrases, prefix) {\n  forEach(morePhrases, function (phrase, key) {\n    var prefixedKey = prefix ? prefix + '.' + key : key;\n    if (typeof phrase === 'object') {\n      this.extend(phrase, prefixedKey);\n    } else {\n      this.phrases[prefixedKey] = phrase;\n    }\n  }, this);\n};\n\n// ### polyglot.unset(phrases)\n// Use `unset` to selectively remove keys from a polyglot instance.\n//\n//     polyglot.unset(\"some_key\");\n//     polyglot.unset({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The unset method can take either a string (for the key), or an object hash with\n// the keys that you would like to unset.\nPolyglot.prototype.unset = function (morePhrases, prefix) {\n  if (typeof morePhrases === 'string') {\n    delete this.phrases[morePhrases];\n  } else {\n    forEach(morePhrases, function (phrase, key) {\n      var prefixedKey = prefix ? prefix + '.' + key : key;\n      if (typeof phrase === 'object') {\n        this.unset(phrase, prefixedKey);\n      } else {\n        delete this.phrases[prefixedKey];\n      }\n    }, this);\n  }\n};\n\n// ### polyglot.clear()\n//\n// Clears all phrases. Useful for special cases, such as freeing\n// up memory if you have lots of phrases but no longer need to\n// perform any translation. Also used internally by `replace`.\nPolyglot.prototype.clear = function () {\n  this.phrases = {};\n};\n\n// ### polyglot.replace(phrases)\n//\n// Completely replace the existing phrases with a new set of phrases.\n// Normally, just use `extend` to add more phrases, but under certain\n// circumstances, you may want to make sure no old phrases are lying around.\nPolyglot.prototype.replace = function (newPhrases) {\n  this.clear();\n  this.extend(newPhrases);\n};\n\n\n// ### polyglot.t(key, options)\n//\n// The most-used method. Provide a key, and `t` will return the\n// phrase.\n//\n//     polyglot.t(\"hello\");\n//     => \"Hello\"\n//\n// The phrase value is provided first by a call to `polyglot.extend()` or\n// `polyglot.replace()`.\n//\n// Pass in an object as the second argument to perform interpolation.\n//\n//     polyglot.t(\"hello_name\", {name: \"Spike\"});\n//     => \"Hello, Spike\"\n//\n// If you like, you can provide a default value in case the phrase is missing.\n// Use the special option key \"_\" to specify a default.\n//\n//     polyglot.t(\"i_like_to_write_in_language\", {\n//       _: \"I like to write in %{language}.\",\n//       language: \"JavaScript\"\n//     });\n//     => \"I like to write in JavaScript.\"\n//\nPolyglot.prototype.t = function (key, options) {\n  var phrase, result;\n  var opts = options == null ? {} : options;\n  if (typeof this.phrases[key] === 'string') {\n    phrase = this.phrases[key];\n  } else if (typeof opts._ === 'string') {\n    phrase = opts._;\n  } else if (this.onMissingKey) {\n    var onMissingKey = this.onMissingKey;\n    result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n  } else {\n    this.warn('Missing translation for key: \"' + key + '\"');\n    result = key;\n  }\n  if (typeof phrase === 'string') {\n    result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n  }\n  return result;\n};\n\n\n// ### polyglot.has(key)\n//\n// Check if polyglot has a translation for given key\nPolyglot.prototype.has = function (key) {\n  return has(this.phrases, key);\n};\n\n// export transformPhrase\nPolyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n  return transformPhrase(phrase, substitutions, locale);\n};\n\nvar webixPolyglot = Polyglot;\n\nfunction Locale(app, _view, config) {\r\n    config = config || {};\r\n    const storage = config.storage;\r\n    let lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\r\n    function setLangData(name, data, silent) {\r\n        if (data.__esModule) {\r\n            data = data.default;\r\n        }\r\n        const pconfig = { phrases: data };\r\n        if (config.polyglot) {\r\n            app.webix.extend(pconfig, config.polyglot);\r\n        }\r\n        const poly = service.polyglot = new webixPolyglot(pconfig);\r\n        poly.locale(name);\r\n        service._ = app.webix.bind(poly.t, poly);\r\n        lang = name;\r\n        if (storage) {\r\n            storage.put(\"lang\", lang);\r\n        }\r\n        if (config.webix) {\r\n            const locName = config.webix[name];\r\n            if (locName) {\r\n                app.webix.i18n.setLocale(locName);\r\n            }\r\n        }\r\n        if (!silent) {\r\n            return app.refresh();\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n    function getLang() { return lang; }\r\n    function setLang(name, silent) {\r\n        // ignore setLang if loading by path is disabled\r\n        if (config.path === false) {\r\n            return;\r\n        }\r\n        const path = (config.path ? config.path + \"/\" : \"\") + name;\r\n        const data = app.require(\"jet-locales\", path);\r\n        setLangData(name, data, silent);\r\n    }\r\n    const service = {\r\n        getLang, setLang, setLangData, _: null, polyglot: null\r\n    };\r\n    app.setService(\"locale\", service);\r\n    setLang(lang, true);\r\n}\n\nfunction show(view, config, value) {\r\n    if (config.urls) {\r\n        value = config.urls[value] || value;\r\n    }\r\n    else if (config.param) {\r\n        value = { [config.param]: value };\r\n    }\r\n    view.show(value);\r\n}\r\nfunction Menu(app, view, config) {\r\n    const frame = view.getSubViewInfo().parent;\r\n    const ui = view.$$(config.id || config);\r\n    let silent = false;\r\n    ui.attachEvent(\"onchange\", function () {\r\n        if (!silent) {\r\n            show(frame, config, this.getValue());\r\n        }\r\n    });\r\n    ui.attachEvent(\"onafterselect\", function () {\r\n        if (!silent) {\r\n            let id = null;\r\n            if (ui.setValue) {\r\n                id = this.getValue();\r\n            }\r\n            else if (ui.getSelectedId) {\r\n                id = ui.getSelectedId();\r\n            }\r\n            show(frame, config, id);\r\n        }\r\n    });\r\n    view.on(app, `app:route`, function () {\r\n        let name = \"\";\r\n        if (config.param) {\r\n            name = view.getParam(config.param, true);\r\n        }\r\n        else {\r\n            const segment = frame.getUrl()[1];\r\n            if (segment) {\r\n                name = segment.page;\r\n            }\r\n        }\r\n        if (name) {\r\n            silent = true;\r\n            if (ui.setValue && ui.getValue() !== name) {\r\n                ui.setValue(name);\r\n            }\r\n            else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name) {\r\n                ui.select(name);\r\n            }\r\n            silent = false;\r\n        }\r\n    });\r\n}\n\nconst baseicons = {\r\n    good: \"check\",\r\n    error: \"warning\",\r\n    saving: \"refresh fa-spin\"\r\n};\r\nconst basetext = {\r\n    good: \"Ok\",\r\n    error: \"Error\",\r\n    saving: \"Connecting...\"\r\n};\r\nfunction Status(app, view, config) {\r\n    let status = \"good\";\r\n    let count = 0;\r\n    let iserror = false;\r\n    let expireDelay = config.expire;\r\n    if (!expireDelay && expireDelay !== false) {\r\n        expireDelay = 2000;\r\n    }\r\n    const texts = config.texts || basetext;\r\n    const icons = config.icons || baseicons;\r\n    if (typeof config === \"string\") {\r\n        config = { target: config };\r\n    }\r\n    function refresh(content) {\r\n        const area = view.$$(config.target);\r\n        if (area) {\r\n            if (!content) {\r\n                content = \"<div class='status_\" +\r\n                    status +\r\n                    \"'><span class='webix_icon fa-\" +\r\n                    icons[status] + \"'></span> \" + texts[status] + \"</div>\";\r\n            }\r\n            area.setHTML(content);\r\n        }\r\n    }\r\n    function success() {\r\n        count--;\r\n        setStatus(\"good\");\r\n    }\r\n    function fail(err) {\r\n        count--;\r\n        setStatus(\"error\", err);\r\n    }\r\n    function start(promise) {\r\n        count++;\r\n        setStatus(\"saving\");\r\n        if (promise && promise.then) {\r\n            promise.then(success, fail);\r\n        }\r\n    }\r\n    function getStatus() {\r\n        return status;\r\n    }\r\n    function hideStatus() {\r\n        if (count === 0) {\r\n            refresh(\" \");\r\n        }\r\n    }\r\n    function setStatus(mode, err) {\r\n        if (count < 0) {\r\n            count = 0;\r\n        }\r\n        if (mode === \"saving\") {\r\n            status = \"saving\";\r\n            refresh();\r\n        }\r\n        else {\r\n            iserror = (mode === \"error\");\r\n            if (count === 0) {\r\n                status = iserror ? \"error\" : \"good\";\r\n                if (iserror) {\r\n                    app.error(\"app:error:server\", [err.responseText || err]);\r\n                }\r\n                else {\r\n                    if (expireDelay) {\r\n                        setTimeout(hideStatus, expireDelay);\r\n                    }\r\n                }\r\n                refresh();\r\n            }\r\n        }\r\n    }\r\n    function track(data) {\r\n        const dp = app.webix.dp(data);\r\n        if (dp) {\r\n            view.on(dp, \"onAfterDataSend\", start);\r\n            view.on(dp, \"onAfterSaveError\", (_id, _obj, response) => fail(response));\r\n            view.on(dp, \"onAfterSave\", success);\r\n        }\r\n    }\r\n    app.setService(\"status\", {\r\n        getStatus,\r\n        setStatus,\r\n        track\r\n    });\r\n    if (config.remote) {\r\n        view.on(app.webix, \"onRemoteCall\", start);\r\n    }\r\n    if (config.ajax) {\r\n        view.on(app.webix, \"onBeforeAjax\", (_mode, _url, _data, _request, _headers, _files, promise) => {\r\n            start(promise);\r\n        });\r\n    }\r\n    if (config.data) {\r\n        track(config.data);\r\n    }\r\n}\n\nfunction Theme(app, _view, config) {\r\n    config = config || {};\r\n    const storage = config.storage;\r\n    let theme = storage ?\r\n        (storage.get(\"theme\") || \"flat-default\")\r\n        :\r\n            (config.theme || \"flat-default\");\r\n    const service = {\r\n        getTheme() { return theme; },\r\n        setTheme(name, silent) {\r\n            const parts = name.split(\"-\");\r\n            const links = document.getElementsByTagName(\"link\");\r\n            for (let i = 0; i < links.length; i++) {\r\n                const lname = links[i].getAttribute(\"title\");\r\n                if (lname) {\r\n                    if (lname === name || lname === parts[0]) {\r\n                        links[i].disabled = false;\r\n                    }\r\n                    else {\r\n                        links[i].disabled = true;\r\n                    }\r\n                }\r\n            }\r\n            app.webix.skin.set(parts[0]);\r\n            // remove old css\r\n            app.webix.html.removeCss(document.body, \"theme-\" + theme);\r\n            // add new css\r\n            app.webix.html.addCss(document.body, \"theme-\" + name);\r\n            theme = name;\r\n            if (storage) {\r\n                storage.put(\"theme\", name);\r\n            }\r\n            if (!silent) {\r\n                app.refresh();\r\n            }\r\n        }\r\n    };\r\n    app.setService(\"theme\", service);\r\n    service.setTheme(theme, true);\r\n}\n\nfunction copyParams(data, url, route) {\r\n    for (let i = 0; i < route.length; i++) {\r\n        data[route[i]] = url[i + 1] ? url[i + 1].page : \"\";\r\n    }\r\n}\r\nfunction UrlParam(app, view, config) {\r\n    const route = config.route || config;\r\n    const data = {};\r\n    view.on(app, \"app:urlchange\", function (subview, segment) {\r\n        if (view === subview) {\r\n            copyParams(data, segment.suburl(), route);\r\n            segment.size(route.length + 1);\r\n        }\r\n    });\r\n    const os = view.setParam;\r\n    const og = view.getParam;\r\n    view.setParam = function (name, value, show) {\r\n        const index = route.indexOf(name);\r\n        if (index >= 0) {\r\n            data[name] = value;\r\n            this._segment.update(\"\", value, index + 1);\r\n            if (show) {\r\n                return view.show(null);\r\n            }\r\n        }\r\n        else {\r\n            return os.call(this, name, value, show);\r\n        }\r\n    };\r\n    view.getParam = function (key, mode) {\r\n        const val = data[key];\r\n        if (typeof val !== \"undefined\") {\r\n            return val;\r\n        }\r\n        return og.call(this, key, mode);\r\n    };\r\n    copyParams(data, view.getUrl(), route);\r\n}\n\nfunction User(app, _view, config) {\r\n    config = config || {};\r\n    const login = config.login || \"/login\";\r\n    const logout = config.logout || \"/logout\";\r\n    const afterLogin = config.afterLogin || app.config.start;\r\n    const afterLogout = config.afterLogout || \"/login\";\r\n    const ping = config.ping || 5 * 60 * 1000;\r\n    const model = config.model;\r\n    let user = config.user;\r\n    const service = {\r\n        getUser() {\r\n            return user;\r\n        },\r\n        getStatus(server) {\r\n            if (!server) {\r\n                return user !== null;\r\n            }\r\n            return model.status().catch(() => null).then(data => {\r\n                user = data;\r\n            });\r\n        },\r\n        login(name, pass) {\r\n            return model.login(name, pass).then(data => {\r\n                user = data;\r\n                if (!data) {\r\n                    throw new Error(\"Access denied\");\r\n                }\r\n                app.callEvent(\"app:user:login\", [user]);\r\n                app.show(afterLogin);\r\n            });\r\n        },\r\n        logout() {\r\n            user = null;\r\n            return model.logout().then(res => {\r\n                app.callEvent(\"app:user:logout\", []);\r\n                return res;\r\n            });\r\n        }\r\n    };\r\n    function canNavigate(url, obj) {\r\n        if (url === logout) {\r\n            service.logout();\r\n            obj.redirect = afterLogout;\r\n        }\r\n        else if (url !== login && !service.getStatus()) {\r\n            obj.redirect = login;\r\n        }\r\n    }\r\n    app.setService(\"user\", service);\r\n    app.attachEvent(`app:guard`, function (url, _$root, obj) {\r\n        if (config.public && config.public(url)) {\r\n            return true;\r\n        }\r\n        if (typeof user === \"undefined\") {\r\n            obj.confirm = service.getStatus(true).then(() => canNavigate(url, obj));\r\n        }\r\n        return canNavigate(url, obj);\r\n    });\r\n    if (ping) {\r\n        setInterval(() => service.getStatus(true), ping);\r\n    }\r\n}\n\n/*\r\nMIT License\r\nCopyright (c) 2019 XB Software\r\n*/\r\nlet webix = window.webix;\r\nif (webix) {\r\n    patch(webix);\r\n}\r\nconst plugins = {\r\n    UnloadGuard, Locale, Menu, Theme, User, Status, UrlParam\r\n};\r\nconst errors = { NavigationBlocked };\r\nconst w = window;\r\nif (!w.Promise) {\r\n    w.Promise = w.webix.promise;\r\n}\n\nexport { plugins, errors, JetApp, JetView, HashRouter, StoreRouter, UrlRouter, EmptyRouter, SubRouter };\n//# sourceMappingURL=jet.js.map\n","var index = 1;\nfunction uid() {\n\treturn index++;\n}\n\nvar empty = undefined;\n\nexport function ignoreInitial(code) {\n\tlet init = false;\n\treturn function() {\n\t\tif (init) return code.apply(this, arguments);\n\t\telse init = true;\n\t};\n}\n\nvar context = null;\nexport function withContext(value, code) {\n\tcontext = value;\n\tcode();\n\tcontext = null;\n}\n\nexport function filter(rule, handler) {\n\treturn function(v, o, obj, meta) {\n\t\tif (rule(v, meta)) handler.apply(this, arguments);\n\t};\n}\n\nexport function link(source, target, key) {\n\tObject.defineProperty(target, key, {\n\t\tget: () => source[key],\n\t\tset: value => (source[key] = value),\n\t});\n}\n\nexport function debounce(handler, delay) {\n\tdelay = delay || 200;\n\tlet timer = null;\n\tlet data = null;\n\treturn function() {\n\t\tdata = arguments;\n\t\tif (!timer) {\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = null;\n\n\t\t\t\thandler.apply(this, data);\n\t\t\t}, delay);\n\t\t}\n\t};\n}\n\nexport function createState(data, config) {\n\tconfig = config || {};\n\tconst handlers = {};\n\tconst out = {};\n\n\tconst observe = function(mask, handler) {\n\t\tconst key = uid();\n\t\thandlers[key] = { mask, handler };\n\t\tif (mask === \"*\") handler(out, empty, mask);\n\t\telse handler(out[mask], empty, mask);\n\n\t\treturn key;\n\t};\n\n\tconst extend = function(data, sconfig){\n\t\tsconfig = sconfig || config;\n\t\t// normal js object\n\t\tfor (const key in data) {\n\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\tconst test = data[key];\n\t\t\t\tif (sconfig.nested && typeof test === \"object\" && test) {\n\t\t\t\t\tout[key] = createState(test, sconfig);\n\t\t\t\t} else {\n\t\t\t\t\treactive(out, test, key, notify);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst observeEnd = function(id) {\n\t\tdelete handlers[id];\n\t};\n\n\tconst queue = [];\n\tlet waitInQueue = false;\n\n\tvar batch = function(code) {\n\t\tif (typeof code !== \"function\") {\n\t\t\tconst values = code;\n\t\t\tcode = () => {\n\t\t\t\tfor (const key in values) out[key] = values[key];\n\t\t\t};\n\t\t}\n\n\t\twaitInQueue = true;\n\t\tcode(out);\n\t\twaitInQueue = false;\n\t\twhile (queue.length) {\n\t\t\tconst obj = queue.shift();\n\t\t\tnotify.apply(this, obj);\n\t\t}\n\t};\n\n\tconst notify = function(key, old, value, meta) {\n\t\tif (waitInQueue) {\n\t\t\tqueue.push([key, old, value, meta]);\n\t\t\treturn;\n\t\t}\n\n\t\tconst list = Object.keys(handlers);\n\t\tfor (let i = 0; i < list.length; i++) {\n\t\t\tconst obj = handlers[list[i]];\n\t\t\tif (!obj) continue;\n\t\t\tif (obj.mask === \"*\" || obj.mask === key) {\n\t\t\t\tobj.handler(value, old, key, meta);\n\t\t\t}\n\t\t}\n\t};\n\n\tObject.defineProperty(out, \"$changes\", {\n\t\tvalue: {\n\t\t\tattachEvent: observe,\n\t\t\tdetachEvent: observeEnd,\n\t\t},\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$observe\", {\n\t\tvalue: observe,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$batch\", {\n\t\tvalue: batch,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$extend\", {\n\t\tvalue: extend,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\n\tout.$extend(data, config);\n\treturn out;\n}\n\nfunction reactive(obj, val, key, notify) {\n\tObject.defineProperty(obj, key, {\n\t\tget: function() {\n\t\t\treturn val;\n\t\t},\n\t\tset: function(value) {\n\t\t\tvar changed = false;\n\t\t\tif (val === null || value === null) {\n\t\t\t\tchanged = val !== value;\n\t\t\t} else {\n\t\t\t\tchanged = val.valueOf() != value.valueOf();\n\t\t\t}\n\n\t\t\tif (changed) {\n\t\t\t\tvar old = val;\n\t\t\t\tval = value;\n\t\t\t\tnotify(key, old, value, context);\n\t\t\t}\n\t\t},\n\t\tenumerable: true,\n\t\tconfigurable: false,\n\t});\n}","import { JetView } from \"webix-jet\";\n\nexport default class BaseExportView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tpadding: 0,\n\t\t\tpoint: false,\n\t\t\tbody: {\n\t\t\t\tview: \"menu\",\n\t\t\t\tsubMenuPos: \"right\",\n\t\t\t\tlayout: \"y\",\n\t\t\t\tborderless: true,\n\t\t\t\ttype: {\n\t\t\t\t\tsubsign: true,\n\t\t\t\t},\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\twidth: 160,\n\t\t\t\tsubmenuConfig: {\n\t\t\t\t\tpoint: false,\n\t\t\t\t\twidth: 190,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\t},\n\t\t\t\tautowidth: true,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: this.GetData(),\n\t\t\t\ton: {\n\t\t\t\t\tonMenuItemClick: (id, e) => this.PopupAction(id, e),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\t/** Returns menu data */\n\tGetData() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ value: _(\"To PNG\"), id: \"png\" },\n\t\t\t{ value: _(\"To PDF\"), id: \"pdf\" },\n\t\t];\n\t}\n\t/**\n\t * Calls \"exportModule\" event for app\n\t * @param {number} id - the ID of clicked menu option\n\t */\n\tPopupAction(id) {\n\t\tthis.app.callEvent(\"exportModule\", [id]);\n\t\tthis.getRoot().hide();\n\t}\n\t/**\n\t * Returns html template menu option\n\t * @param {Object} obj - data of menu option\n\t * @returns {String} - a string with html for an option\n\t */\n\tGetTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span>${obj.value}`;\n\t}\n\t/**\n\t * Shows menu\n\t * @param {Object} node - html node where menu should be shown\n\t */\n\tShow(node) {\n\t\tif (this.getRoot().isVisible()) return;\n\t\tthis.webix.delay(() => this.getRoot().show(node));\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport ExportMenu from \"./export\";\n\nexport default class BaseToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"toolbar\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\thidden: true,\n\t\t\tpadding: { left: 10, right: 10, top: 6, bottom: 6 },\n\t\t\tmargin: 10,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\twidth: 140,\n\t\t\t\t\tlabel: _(\"Export\"),\n\t\t\t\t\ticon: \"rpi-export\",\n\t\t\t\t\tclick: id => this.ShowExportPopup(id),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Shows menu\n\t * @param {String} viewId - webix view id\n\t */\n\tShowExportPopup(viewId) {\n\t\tif (!this.ExportMenu || !this.ExportMenu.$view)\n\t\t\tthis.ExportMenu = this.ui(ExportMenu);\n\t\tconst node = webix.$$(viewId);\n\t\tthis.ExportMenu.Show(node.$view);\n\t}\n}\n","import Toolbar from \"./common/toolbar\";\nimport { JetView } from \"webix-jet\";\n\nexport default class ChartView extends JetView {\n\tconfig() {\n\t\tconst page = {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\t\t\tcols: [{}],\n\t\t};\n\n\t\treturn { rows: [Toolbar, page] };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t}\n\tready() {\n\t\tconst parts = this.getRoot().getChildViews();\n\t\tthis.Bar = parts[0];\n\t\tthis.Host = parts[1];\n\n\t\tthis.on(this.State.$changes, \"module\", mod => this.Show(mod));\n\t\tthis.on(this.app, \"exportModule\", mode => this.Export(mode));\n\t}\n\n\tShow(mod) {\n\t\tconst host = this.Host;\n\n\t\tif (mod && mod.type === \"chart\" && this.CheckColumns(mod.columns)) {\n\t\t\tconst config = this.GetChartConfig(mod);\n\n\t\t\tif (!config.view) return;\n\t\t\tthis.Bar.show();\n\t\t\tthis.GetChartData(mod).then(([data, options]) => {\n\t\t\t\tdata = webix.copy(data);\n\t\t\t\tif (mod.meta.chart.seriesFrom == \"rows\")\n\t\t\t\t\tdata = this.ConvertDataBySeries(data);\n\t\t\t\tconfig.data = this.FormatLabels(\n\t\t\t\t\tdata.slice(0, this.Charts.numLimit),\n\t\t\t\t\toptions\n\t\t\t\t);\n\t\t\t\twebix.ui([config], host);\n\t\t\t\tthis.Chart = host.getChildViews()[0];\n\t\t\t});\n\t\t} else {\n\t\t\twebix.ui([{ template: \" \" }], host);\n\t\t\tthis.Bar.hide();\n\t\t\tthis.Chart = null;\n\t\t}\n\t}\n\n\tFormatLabels(data, options) {\n\t\tconst labelColumn = this.State.module.meta.chart.labelColumn;\n\n\t\tconst labelOptions =\n\t\t\tlabelColumn && options.length\n\t\t\t\t? options.find(op => op.field == labelColumn)\n\t\t\t\t: null;\n\n\t\tif (labelOptions)\n\t\t\tdata.forEach(item => {\n\t\t\t\tconst option = labelOptions.data.find(o => o.id == item[labelColumn]);\n\t\t\t\titem[labelColumn] = option ? option.value : item[labelColumn];\n\t\t\t});\n\t\telse {\n\t\t\tconst field = (\n\t\t\t\tthis.State.module.fields || this.State.module.columns\n\t\t\t).find(field => field.id == labelColumn);\n\t\t\tif (field && field.type == \"date\") {\n\t\t\t\tdata.forEach(item => {\n\t\t\t\t\titem[labelColumn] = webix.i18n.dateFormatStr(\n\t\t\t\t\t\tnew Date(item[labelColumn])\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t}\n\n\tCheckColumns(columns) {\n\t\tconst result = columns.length && columns.indexOf(webix.undefined) == -1;\n\t\treturn result;\n\t}\n\n\tGetChartConfig(mod) {\n\t\tconst { columns, meta } = mod;\n\t\tif (!columns || !meta.chart) return {};\n\n\t\tconst {\n\t\t\tchartType,\n\t\t\tlabelColumn,\n\t\t\tlegendPosition,\n\t\t\tseries,\n\t\t\taxises,\n\t\t} = meta.chart;\n\n\t\tif (!series) return {};\n\t\tconst seriesConfig = [];\n\n\t\tseries.forEach(s => {\n\t\t\tif (s.show !== false) {\n\t\t\t\tconst type = s.chartType || chartType;\n\t\t\t\tseriesConfig.push({\n\t\t\t\t\t...this.ApplyTypeConfig(s, type),\n\t\t\t\t\tvalue: item => item[s.id],\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tlet config = {\n\t\t\tview: \"chart\",\n\t\t\ttype: chartType,\n\t\t\tlocalId: \"chart\",\n\t\t\tseries: seriesConfig,\n\t\t\tpadding: {\n\t\t\t\tleft: 80,\n\t\t\t\tright: 40,\n\t\t\t\ttop: 50,\n\t\t\t\tbottom: 80,\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonAfterRender: () => this.CorrectLabels(),\n\t\t\t},\n\t\t\tlegend: this.GetLegendConfig(series, chartType, legendPosition),\n\t\t};\n\t\tif (axises) {\n\t\t\tconfig.xAxis = {\n\t\t\t\ttemplate: item => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t\"<div class='webix_rpt_chart_label'>\" +\n\t\t\t\t\t\t(item[labelColumn] || \"\") +\n\t\t\t\t\t\t\"</div>\"\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t...axises.x,\n\t\t\t};\n\t\t\tconfig.yAxis = {\n\t\t\t\t...axises.y,\n\t\t\t};\n\t\t\tif (axises.y.logarithmic) config.scale = \"logarithmic\";\n\t\t\tif (axises.x.verticalLabels)\n\t\t\t\tconfig.css = \"webix_rpt_vertical_chart_labels\";\n\t\t}\n\t\tif (config.legendPosition == \"right\")\n\t\t\tconfig.padding.right = config.legend.width + 10;\n\t\telse {\n\t\t\tconfig.padding.bottom = 90;\n\t\t}\n\n\t\treturn config;\n\t}\n\n\tGetLegendConfig(series, type, legendPosition) {\n\t\tif (legendPosition == \"none\") return null;\n\t\tlet values = [];\n\t\tlet text = [];\n\t\tconst itemTypes = this.Charts.itemSupport;\n\t\tseries.forEach(s => {\n\t\t\tif (s.show !== false) {\n\t\t\t\tvalues.push({\n\t\t\t\t\ttext: s.meta.name,\n\t\t\t\t\tcolor: s.meta.color,\n\t\t\t\t\tmarkerType:\n\t\t\t\t\t\titemTypes.indexOf(series.chartType || type) != -1\n\t\t\t\t\t\t\t? \"item\"\n\t\t\t\t\t\t\t: \"square\",\n\t\t\t\t});\n\t\t\t\ttext.push(s.name);\n\t\t\t}\n\t\t});\n\t\tlet config = {\n\t\t\tvalues,\n\t\t\tmargin: 8,\n\t\t};\n\n\t\tif (legendPosition == \"right\") {\n\t\t\tconfig.width = webix.html.getTextSize(text).width + 30;\n\t\t\tconfig.valign = \"middle\";\n\t\t\tconfig.align = \"right\";\n\t\t} else {\n\t\t\tconfig.layout = \"x\";\n\t\t\tconfig.valign = \"bottom\";\n\t\t\tconfig.align = \"center\";\n\t\t}\n\t\treturn config;\n\t}\n\n\tGetChartData(mod) {\n\t\treturn Promise.all([\n\t\t\tthis.Local.getData(\n\t\t\t\tthis.Local.getDataConfig(mod),\n\t\t\t\tthis.State.mode == \"edit\"\n\t\t\t),\n\t\t\tthis.Local.getOptions(mod.columns),\n\t\t]);\n\t}\n\n\tApplyTypeConfig(series, type) {\n\t\tconst meta = series.meta;\n\t\tif (this.Charts.itemSupport.indexOf(type) != -1) {\n\t\t\treturn {\n\t\t\t\tfill: meta.area ? meta.color : null,\n\t\t\t\talpha: meta.area ? 0.2 : 1,\n\t\t\t\titem: {\n\t\t\t\t\ttype: meta.markerType,\n\t\t\t\t\tradius: meta.markerType == \"no\" ? 0 : 3,\n\t\t\t\t\tborderColor: meta.color,\n\t\t\t\t\tcolor: meta.fillMarker ? meta.color : \"#ffffff\",\n\t\t\t\t},\n\t\t\t\tline: {\n\t\t\t\t\tcolor: meta.color,\n\t\t\t\t\twidth: meta.area ? 1 : 2,\n\t\t\t\t},\n\t\t\t\tdisableItems: meta.area ? true : false,\n\t\t\t};\n\t\t} else if (type == \"area\" || type == \"splineArea\")\n\t\t\treturn {\n\t\t\t\tborder: true,\n\t\t\t\talpha: 0.3,\n\t\t\t\tcolor: meta.color,\n\t\t\t};\n\t\telse\n\t\t\treturn {\n\t\t\t\tcolor: meta.color,\n\t\t\t};\n\t}\n\n\tConvertDataBySeries(data) {\n\t\tconst {\n\t\t\tlabelColumn,\n\t\t\tbaseColumn,\n\t\t\tdataColumn,\n\t\t} = this.State.module.meta.chart;\n\t\tif (!(labelColumn && baseColumn && dataColumn)) return [];\n\t\tlet arr = [];\n\t\tdata.forEach(row => {\n\t\t\tlet group = arr.find(aRow => aRow[labelColumn] == row[labelColumn]);\n\t\t\tif (!group) {\n\t\t\t\tgroup = {};\n\t\t\t\tgroup[labelColumn] = row[labelColumn];\n\t\t\t}\n\t\t\tif (!group[row[baseColumn]]) group[row[baseColumn]] = row[dataColumn];\n\t\t\tarr.push(group);\n\t\t});\n\n\t\treturn arr;\n\t}\n\n\tCorrectLabels() {\n\t\tconst chart = this.$$(\"chart\");\n\t\tif (chart && !chart.config.offset) {\n\t\t\tconst res = chart.$view.querySelector(\".webix_axis_item_x\");\n\t\t\tif (res) res.className += \" webix_rpt_chart_label0\";\n\t\t}\n\t}\n\t/**\n\t * Exports chart to png image or PDF\n\t * @param {String} mode - export mode ( \"png\" or PDF \"table\"/\"image\"/\"all\"),\n\t */\n\tExport(mode) {\n\t\tif (this.Chart) {\n\t\t\tif (mode == \"png\") webix.toPNG(this.Chart);\n\t\t\telse if (mode == \"pdf\") {\n\t\t\t\tlet params = { autowidth: true, display: \"image\" };\n\t\t\t\twebix.toPDF(this.Chart, params);\n\t\t\t}\n\t\t}\n\t}\n}\n","import { createState, withContext } from \"jet-restate\";\n\nexport function bind(obj, key, ctrl, view) {\n\tbindOut(obj, key, ctrl);\n\treturn bindIn(obj, key, ctrl, view);\n}\n\nfunction bindIn(obj, key, ctrl, view) {\n\tconst handler = (v, o, k, meta) => {\n\t\tif (k === \"*\") {\n\t\t\tvar els = ctrl.elements;\n\t\t\tfor (var subkey in els) {\n\t\t\t\tif (typeof v[subkey] !== \"undefined\") els[subkey].setValue(v[subkey]);\n\t\t\t}\n\t\t} else if (key === \"*\") {\n\t\t\tvar el = ctrl.elements[k];\n\t\t\tif (el && el != meta) el.setValue(v);\n\t\t} else if (meta != ctrl) ctrl.setValue(v);\n\t};\n\n\treturn view\n\t\t? view.on(obj.$changes, key, handler)\n\t\t: obj.$changes.attachEvent(key, handler);\n}\n\nfunction bindOut(obj, key, ctrl) {\n\tif (key === \"*\") {\n\t\tvar els = ctrl.elements;\n\t\tfor (var subkey in els) {\n\t\t\tif (typeof obj[subkey] !== \"undefined\") bindOut(obj, subkey, els[subkey]);\n\t\t}\n\t\treturn;\n\t}\n\n\tconst trigger = function(newValue) {\n\t\tconst oldValue = obj[key];\n\t\tif (newValue !== oldValue) {\n\t\t\tobj[key] = newValue;\n\t\t}\n\t};\n\n\tif (!ctrl.getList)\n\t\tctrl.attachEvent(\"onTimedKeyPress\", function() {\n\t\t\tconst newValue = this.getValue();\n\t\t\tif (this.config.value !== newValue) {\n\t\t\t\tthis.config.value = newValue;\n\t\t\t\tthis.callEvent(\"onChange\", [newValue]);\n\t\t\t}\n\t\t});\n\n\tctrl.attachEvent(\"onChange\", function() {\n\t\twithContext(this, () => {\n\t\t\ttrigger(this.getValue());\n\t\t});\n\t});\n}\n\nexport function track(obj) {\n\tif (!obj.$changes) obj = createState(obj);\n\n\tvar observe = function(key, ctrl) {\n\t\treturn bind(obj, key, ctrl, ctrl);\n\t};\n\n\tvar observeEnd = function(id) {\n\t\tobj.$changes.detachEvent(id);\n\t};\n\n\treturn {\n\t\tattachEvent: observe,\n\t\tdetachEvent: observeEnd,\n\t};\n}\n","webix.protoUI(\n\t{\n\t\tname: \"input-list\",\n\t\tgetValue() {\n\t\t\treturn this._value || [];\n\t\t},\n\t\tsetValue(data) {\n\t\t\tthis._value = data;\n\n\t\t\tthis.clearAll();\n\t\t\tthis.parse([].concat(data));\n\t\t},\n\t},\n\twebix.ui.list\n);\n","export const menu = \"<span class='webix_icon action-menu mdi mdi-menu'></span>\";\nexport const edit =\n\t\"<span class='webix_icon action-edit mdi mdi-pencil'></span>\";\nexport const remove =\n\t\"<span class='webix_icon webix_rpt_action_remove rpi-trash-can-outline'></span>\";\n\nexport const menuRight =\n\t\"<span style='float:right' class='webix_icon action-menu mdi mdi-menu'></span>\";\nexport const editRight =\n\t\"<span style='float:right' class='webix_icon action-edit mdi mdi-pencil'></span>\";\nexport const removeRight =\n\t\"<span style='float:right' class='webix_icon webix_rpt_action_remove rpi-delete'></span>\";\n\nexport const visible =\n\t\"<span class='webix_icon action-visible mdi mdi-eye'></span>\";\nexport const hidden =\n\t\"<span class='webix_icon action-hidden mdi mdi-eye-off-outline'></span>\";\n\nexport const checked =\n\t\"<span class='webix_icon wbx-action_check mdi mdi-checkbox-marked-outline'></span>\";\nexport const notChecked =\n\t\"<span class='webix_icon wbx-action_check mdi mdi-checkbox-blank-outline'></span>\";\n\nexport const sortAsc =\n\t\"<span class='webix_icon rpi-sort-alphabetical-ascending'></span>\";\nexport const sortDesc =\n\t\"<span class='webix_icon rpi-sort-alphabetical-descending'></span>\";\n\nexport const types = {\n\ttable: \"<span class='rpi-table'></span>\",\n\tchart: \"<span class='rpi-poll'></span>\",\n\theatmap: \"<span class='rpi-chart-tree'></span>\",\n};\n\nexport const empty = {\n\tmain:\n\t\t\"<svg  xmlns='http://www.w3.org/2000/svg' viewBox='0 0 390 320'><path class='webix_rpt_cls1' d='M369.51,182.77c-23.18-52.39,32-103.23,13.74-148.28s-77.61-39.42-162.07-20S78.47-6.35,34.66,14.46c-29.39,14-27.27,58.82-5,107,38.95,84.29-51.86,117.32-24.38,166s118.91-.95,183.37,4.22c37.62.59,62.88,6.26,109.52,21.27C387.63,341.7,412.41,279.75,369.51,182.77Z'/><rect class='webix_rpt_cls2' x='111.53' y='226.04' width='212.47' height='0.91'/><rect class='webix_rpt_cls3' x='97' y='89.51' width='212' height='151.96'/><rect class='webix_rpt_cls4' x='67' y='159.96' width='136.33' height='81.98' rx='2'/><polygon class='webix_rpt_cls5' points='199.32 235.55 72.61 235.55 72.61 165.28 71.01 165.28 71.01 235.55 71.01 237.68 71.01 237.68 72.61 237.68 72.61 237.68 199.32 237.68 199.32 235.55'/><rect class='webix_rpt_cls6' x='84.64' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='97.47' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='110.3' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='123.14' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='135.97' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls7' x='148.8' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='161.63' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='174.46' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='187.29' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls7' x='111.53' y='94.41' width='212.47' height='132.54'/><rect class='webix_rpt_cls8' x='111.53' y='109.85' width='212.47' height='0.91'/><path class='webix_rpt_cls9' d='M111.53,94.41H324v15.44H111.53Z'/><path class='webix_rpt_cls7' d='M111.53,79H324V94.41H111.53Z'/><path class='webix_rpt_cls2' d='M324,125.28v-.91H287.68V109.84h-.91v14.53H250.45V109.84h-.91v14.53H213.22V109.84h-.9v14.53H176V109.85h-.91v14.52H111.53v.91h63.56v13.61H111.53v.91h63.56v13.62H111.53v.91h63.56v13.61H111.53v.91h63.56v13.62H111.53v.91h63.56V197H111.53v.91h63.56v13.62H111.53v.9h63.56V227H176V212.42h36.32V227h.9V212.42h36.32V227h.91V212.42h36.32V227h.91V212.42H324v-.9H287.68V197.9H324V197H287.68V183.38H324v-.91H287.68V168.85H324v-.91H287.68V154.33H324v-.91H287.68V139.8H324v-.91H287.68V125.28Zm-74.46,0v13.61H213.22V125.28Zm-36.32,57.19V168.85h36.32v13.62Zm36.32.91V197H213.22V183.38Zm-36.32-15.44V154.33h36.32v13.61Zm0-14.52V139.8h36.32v13.62ZM176,125.28h36.32v13.61H176Zm0,14.52h36.32v13.62H176Zm0,14.53h36.32v13.61H176Zm0,14.52h36.32v13.62H176Zm0,14.53h36.32V197H176Zm0,28.14V197.9h36.32v13.62Zm37.22,0V197.9h36.32v13.62Zm73.55,0H250.45V197.9h36.32Zm0-14.53H250.45V183.38h36.32Zm0-14.52H250.45V168.85h36.32Zm0-14.53H250.45V154.33h36.32Zm0-14.52H250.45V139.8h36.32Zm0-14.53H250.45V125.28h36.32Z'/><rect class='webix_rpt_cls2' x='175.09' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='212.32' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='249.54' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='286.77' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls9' x='118.79' y='84.43' width='21.79' height='5.45'/><rect class='webix_rpt_cls9' x='250.45' y='84.43' width='66.28' height='5.45'/></svg>\",\n\talt:\n\t\t\"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 390 320' fill='none'><g clip-path='url(#clip0_4706_8889)'><path d='M369.502 182.763C346.322 130.373 401.502 79.5332 383.242 34.4832C364.982 -10.5668 305.632 -4.93676 221.172 14.4832C136.712 33.9032 78.4622 -6.35676 34.6522 14.4532C5.26223 28.4532 7.38222 73.2732 29.6522 121.453C68.6022 205.743 -22.2078 238.773 5.27222 287.453C32.7522 336.133 124.182 286.503 188.642 291.673C226.262 292.263 251.522 297.933 298.162 312.943C387.622 341.693 412.402 279.743 369.502 182.763Z' class='webix_rpt_cls1'/><path d='M112.545 76.0479C112.545 74.9421 113.475 74.0457 114.622 74.0457H215.368L256.913 114.09V251.238C256.913 252.344 255.983 253.241 254.836 253.241H114.622C113.475 253.241 112.545 252.344 112.545 251.238V76.0479Z' class='webix_rpt_cls6'/><path d='M128.322 60.5902C128.322 59.4844 129.252 58.588 130.399 58.588H231.145L272.69 98.6313V235.781C272.69 236.887 271.76 237.783 270.612 237.783H130.399C129.252 237.783 128.322 236.887 128.322 235.781V60.5902Z' class='webix_rpt_cls4'/><path fill-rule='evenodd' clip-rule='evenodd' d='M130.399 59.588C129.769 59.588 129.322 60.0708 129.322 60.5902V235.781C129.322 236.3 129.769 236.783 130.399 236.783H270.612C271.243 236.783 271.69 236.299 271.69 235.781V99.0563L230.742 59.588H130.399ZM231.145 58.588H130.399C129.252 58.588 128.322 59.4844 128.322 60.5902V235.781C128.322 236.887 129.252 237.783 130.399 237.783H270.612C271.76 237.783 272.69 236.887 272.69 235.781V98.6313L231.145 58.588Z' class='webix_rpt_cls3'/><path d='M231.146 96.6297V58.588L272.69 98.6313H233.222C232.075 98.6313 231.146 97.7353 231.146 96.6297Z' class='webix_rpt_cls3'/><path d='M184.729 74.0457H143.184C142.323 74.0457 141.626 74.718 141.626 75.5473V75.5473C141.626 76.3766 142.323 77.0489 143.184 77.0489H184.729C185.589 77.0489 186.287 76.3766 186.287 75.5473C186.287 74.718 185.589 74.0457 184.729 74.0457Z' class='webix_rpt_cls2'/><path d='M184.729 87.0457H143.184C142.323 87.0457 141.626 87.718 141.626 88.5473V88.5473C141.626 89.3766 142.323 90.0489 143.184 90.0489H184.729C185.589 90.0489 186.287 89.3766 186.287 88.5473C186.287 87.718 185.589 87.0457 184.729 87.0457Z' class='webix_rpt_cls2'/><path d='M222.443 101H143.557C142.697 101 142 101.672 142 102.5C142 103.328 142.697 104 143.557 104H222.443C223.303 104 224 103.328 224 102.5C224 101.672 223.303 101 222.443 101Z' class='webix_rpt_cls2'/><path d='M222.443 115H143.557C142.697 115 142 115.672 142 116.5V116.5C142 117.328 142.697 118 143.557 118H222.443C223.303 118 224 117.328 224 116.5C224 115.672 223.303 115 222.443 115Z' class='webix_rpt_cls2'/><path fill-rule='evenodd' clip-rule='evenodd' d='M218 223C240.644 223 259 204.644 259 182C259 159.356 240.644 141 218 141C195.356 141 177 159.356 177 182C177 204.644 195.356 223 218 223ZM218 227C242.853 227 263 206.853 263 182C263 157.147 242.853 137 218 137C193.147 137 173 157.147 173 182C173 206.853 193.147 227 218 227Z' class='webix_rpt_cls4'/><path d='M219.686 134C231.802 134 243.423 138.813 251.99 147.381C260.558 155.949 265.371 167.569 265.371 179.686C265.371 191.002 261.225 201.404 254.407 209.417L256.305 211.314H261.857L297 246.457L286.457 257L251.314 221.857V216.305L249.417 214.407C241.404 221.225 231.002 225.371 219.686 225.371C207.569 225.371 195.949 220.558 187.381 211.99C178.813 203.423 174 191.802 174 179.686C174 167.569 178.813 155.949 187.381 147.381C195.949 138.813 207.569 134 219.686 134ZM219.686 148.057C202.114 148.057 188.057 162.114 188.057 179.686C188.057 197.257 202.114 211.314 219.686 211.314C237.257 211.314 251.314 197.257 251.314 179.686C251.314 162.114 237.257 148.057 219.686 148.057Z' class='webix_rpt_cls5'/><path fill-rule='evenodd' clip-rule='evenodd' d='M253.047 209.471L253.645 208.769C260.316 200.928 264.371 190.754 264.371 179.686C264.371 167.834 259.663 156.468 251.283 148.088C242.903 139.708 231.537 135 219.686 135C207.834 135 196.468 139.708 188.088 148.088C179.708 156.468 175 167.834 175 179.686C175 191.537 179.708 202.903 188.088 211.283C196.468 219.663 207.834 224.371 219.686 224.371C230.754 224.371 240.928 220.316 248.769 213.645L249.471 213.047L252.314 215.89V221.443L286.457 255.586L295.586 246.457L261.443 212.314H255.89L253.047 209.471ZM261.857 211.314L297 246.457L286.457 257L251.314 221.857V216.305L249.417 214.407C241.404 221.225 231.002 225.371 219.686 225.371C207.569 225.371 195.949 220.558 187.381 211.99C178.813 203.423 174 191.802 174 179.686C174 167.569 178.813 155.949 187.381 147.381C195.949 138.813 207.569 134 219.686 134C231.802 134 243.423 138.813 251.99 147.381C260.558 155.949 265.371 167.569 265.371 179.686C265.371 191.002 261.225 201.404 254.407 209.417L256.305 211.314H261.857ZM187.057 179.686C187.057 161.562 201.562 147.057 219.686 147.057C237.809 147.057 252.314 161.562 252.314 179.686C252.314 197.809 237.809 212.314 219.686 212.314C201.562 212.314 187.057 197.809 187.057 179.686ZM188.057 179.686C188.057 162.114 202.114 148.057 219.686 148.057C237.257 148.057 251.314 162.114 251.314 179.686C251.314 197.257 237.257 211.314 219.686 211.314C202.114 211.314 188.057 197.257 188.057 179.686Z' class='webix_rpt_cls3'/><path d='M236.083 167.231L232.852 164L220.042 176.81L207.231 164L204 167.231L216.81 180.042L204 192.852L207.231 196.083L220.042 183.273L232.852 196.083L236.083 192.852L223.273 180.042L236.083 167.231Z' class='webix_rpt_cls3'/></g><defs><clipPath id='clip0_4706_8889'><rect width='390' height='320' class='webix_rpt_cls4'/></clipPath></defs></svg>\",\n};\n","/*\n@license\nWebix Query v.10.0.9\nThis software is covered by Webix Commercial License.\nUsage without proper license is prohibited.\n(c) XB Software Ltd.\n*/\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = global || self, factory(global.query = {}));\n}(this, (function (exports) { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation. All rights reserved.\r\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\n    this file except in compliance with the License. You may obtain a copy of the\r\n    License at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\n    MERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\n    See the Apache Version 2.0 License for specific language governing permissions\r\n    and limitations under the License.\r\n    ***************************************************************************** */\r\n    /* global Reflect, Promise */\r\n\r\n    var extendStatics = function(d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n\r\n    function __extends(d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    }\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\n\n    var NavigationBlocked = (function () {\n        function NavigationBlocked() {\n        }\n        return NavigationBlocked;\n    }());\n    var JetBase = (function () {\n        function JetBase(webix, config) {\n            this.webixJet = true;\n            this.webix = webix;\n            this._events = [];\n            this._subs = {};\n            this._data = {};\n            if (config && config.params)\n                webix.extend(this._data, config.params);\n        }\n        JetBase.prototype.getRoot = function () {\n            return this._root;\n        };\n        JetBase.prototype.destructor = function () {\n            this._detachEvents();\n            this._destroySubs();\n            this._events = this._container = this.app = this._parent = this._root = null;\n        };\n        JetBase.prototype.setParam = function (id, value, url) {\n            if (this._data[id] !== value) {\n                this._data[id] = value;\n                this._segment.update(id, value, 0);\n                if (url) {\n                    return this.show(null);\n                }\n            }\n        };\n        JetBase.prototype.getParam = function (id, parent) {\n            var value = this._data[id];\n            if (typeof value !== \"undefined\" || !parent) {\n                return value;\n            }\n            var view = this.getParentView();\n            if (view) {\n                return view.getParam(id, parent);\n            }\n        };\n        JetBase.prototype.getUrl = function () {\n            return this._segment.suburl();\n        };\n        JetBase.prototype.getUrlString = function () {\n            return this._segment.toString();\n        };\n        JetBase.prototype.getParentView = function () {\n            return this._parent;\n        };\n        JetBase.prototype.$$ = function (id) {\n            if (typeof id === \"string\") {\n                var root_1 = this.getRoot();\n                return root_1.queryView((function (obj) { return (obj.config.id === id || obj.config.localId === id) &&\n                    (obj.$scope === root_1.$scope); }), \"self\");\n            }\n            else {\n                return id;\n            }\n        };\n        JetBase.prototype.on = function (obj, name, code) {\n            var id = obj.attachEvent(name, code);\n            this._events.push({ obj: obj, id: id });\n            return id;\n        };\n        JetBase.prototype.contains = function (view) {\n            for (var key in this._subs) {\n                var kid = this._subs[key].view;\n                if (kid === view || kid.contains(view)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        JetBase.prototype.getSubView = function (name) {\n            var sub = this.getSubViewInfo(name);\n            if (sub) {\n                return sub.subview.view;\n            }\n        };\n        JetBase.prototype.getSubViewInfo = function (name) {\n            var sub = this._subs[name || \"default\"];\n            if (sub) {\n                return { subview: sub, parent: this };\n            }\n            if (name === \"_top\") {\n                this._subs[name] = { url: \"\", id: null, popup: true };\n                return this.getSubViewInfo(name);\n            }\n            if (this._parent) {\n                return this._parent.getSubViewInfo(name);\n            }\n            return null;\n        };\n        JetBase.prototype._detachEvents = function () {\n            var events = this._events;\n            for (var i = events.length - 1; i >= 0; i--) {\n                events[i].obj.detachEvent(events[i].id);\n            }\n        };\n        JetBase.prototype._destroySubs = function () {\n            for (var key in this._subs) {\n                var subView = this._subs[key].view;\n                if (subView) {\n                    subView.destructor();\n                }\n            }\n            this._subs = {};\n        };\n        JetBase.prototype._init_url_data = function () {\n            var url = this._segment.current();\n            this._data = {};\n            this.webix.extend(this._data, url.params, true);\n        };\n        JetBase.prototype._getDefaultSub = function () {\n            if (this._subs.default) {\n                return this._subs.default;\n            }\n            for (var key in this._subs) {\n                var sub = this._subs[key];\n                if (!sub.branch && sub.view && key !== \"_top\") {\n                    var child = sub.view._getDefaultSub();\n                    if (child) {\n                        return child;\n                    }\n                }\n            }\n        };\n        JetBase.prototype._routed_view = function () {\n            var parent = this.getParentView();\n            if (!parent) {\n                return true;\n            }\n            var sub = parent._getDefaultSub();\n            if (!sub && sub !== this) {\n                return false;\n            }\n            return parent._routed_view();\n        };\n        return JetBase;\n    }());\n    function parse(url) {\n        if (url[0] === \"/\") {\n            url = url.substr(1);\n        }\n        var parts = url.split(\"/\");\n        var chunks = [];\n        for (var i = 0; i < parts.length; i++) {\n            var test = parts[i];\n            var result = {};\n            var pos = test.indexOf(\":\");\n            if (pos === -1) {\n                pos = test.indexOf(\"?\");\n            }\n            if (pos !== -1) {\n                var params = test.substr(pos + 1).split(/[\\:\\?\\&]/g);\n                for (var _i = 0, params_1 = params; _i < params_1.length; _i++) {\n                    var param = params_1[_i];\n                    var dchunk = param.split(\"=\");\n                    result[dchunk[0]] = decodeURIComponent(dchunk[1]);\n                }\n            }\n            chunks[i] = {\n                page: (pos > -1 ? test.substr(0, pos) : test),\n                params: result,\n                isNew: true\n            };\n        }\n        return chunks;\n    }\n    function url2str(stack) {\n        var url = [];\n        for (var _i = 0, stack_1 = stack; _i < stack_1.length; _i++) {\n            var chunk = stack_1[_i];\n            url.push(\"/\" + chunk.page);\n            var params = obj2str(chunk.params);\n            if (params) {\n                url.push(\"?\" + params);\n            }\n        }\n        return url.join(\"\");\n    }\n    function obj2str(obj) {\n        var str = [];\n        for (var key in obj) {\n            if (typeof obj[key] === \"object\")\n                continue;\n            if (str.length) {\n                str.push(\"&\");\n            }\n            str.push(key + \"=\" + encodeURIComponent(obj[key]));\n        }\n        return str.join(\"\");\n    }\n    var Route = (function () {\n        function Route(route, index) {\n            this._next = 1;\n            if (typeof route === \"string\") {\n                this.route = {\n                    url: parse(route),\n                    path: route\n                };\n            }\n            else {\n                this.route = route;\n            }\n            this.index = index;\n        }\n        Route.prototype.current = function () {\n            return this.route.url[this.index];\n        };\n        Route.prototype.next = function () {\n            return this.route.url[this.index + this._next];\n        };\n        Route.prototype.suburl = function () {\n            return this.route.url.slice(this.index);\n        };\n        Route.prototype.shift = function (params) {\n            var route = new Route(this.route, this.index + this._next);\n            route.setParams(route.route.url, params, route.index);\n            return route;\n        };\n        Route.prototype.setParams = function (url, params, index) {\n            if (params) {\n                var old = url[index].params;\n                for (var key in params)\n                    old[key] = params[key];\n            }\n        };\n        Route.prototype.refresh = function () {\n            var url = this.route.url;\n            for (var i = this.index + 1; i < url.length; i++) {\n                url[i].isNew = true;\n            }\n        };\n        Route.prototype.toString = function () {\n            var str = url2str(this.suburl());\n            return str ? str.substr(1) : \"\";\n        };\n        Route.prototype._join = function (path, kids) {\n            var url = this.route.url;\n            if (path === null) {\n                return url;\n            }\n            var old = this.route.url;\n            var reset = true;\n            url = old.slice(0, this.index + (kids ? this._next : 0));\n            if (path) {\n                url = url.concat(parse(path));\n                for (var i = 0; i < url.length; i++) {\n                    if (old[i]) {\n                        url[i].view = old[i].view;\n                    }\n                    if (reset && old[i] && url[i].page === old[i].page) {\n                        url[i].isNew = false;\n                    }\n                    else if (url[i].isNew) {\n                        reset = false;\n                    }\n                }\n            }\n            return url;\n        };\n        Route.prototype.append = function (path) {\n            var url = this._join(path, true);\n            this.route.path = url2str(url);\n            this.route.url = url;\n            return this.route.path;\n        };\n        Route.prototype.show = function (path, view, kids) {\n            var _this = this;\n            var url = this._join(path.url, kids);\n            this.setParams(url, path.params, this.index + (kids ? this._next : 0));\n            return new Promise(function (res, rej) {\n                var redirect = url2str(url);\n                var obj = {\n                    url: url,\n                    redirect: redirect,\n                    confirm: Promise.resolve()\n                };\n                var app = view ? view.app : null;\n                if (app) {\n                    var result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\n                    if (!result) {\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                }\n                obj.confirm.catch(function (err) { return rej(err); }).then(function () {\n                    if (obj.redirect === null) {\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                    if (obj.redirect !== redirect) {\n                        app.show(obj.redirect);\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                    _this.route.path = redirect;\n                    _this.route.url = url;\n                    res();\n                });\n            });\n        };\n        Route.prototype.size = function (n) {\n            this._next = n;\n        };\n        Route.prototype.split = function () {\n            var route = {\n                url: this.route.url.slice(this.index + 1),\n                path: \"\"\n            };\n            if (route.url.length) {\n                route.path = url2str(route.url);\n            }\n            return new Route(route, 0);\n        };\n        Route.prototype.update = function (name, value, index) {\n            var chunk = this.route.url[this.index + (index || 0)];\n            if (!chunk) {\n                this.route.url.push({ page: \"\", params: {} });\n                return this.update(name, value, index);\n            }\n            if (name === \"\") {\n                chunk.page = value;\n            }\n            else {\n                chunk.params[name] = value;\n            }\n            this.route.path = url2str(this.route.url);\n        };\n        return Route;\n    }());\n    var JetView = (function (_super) {\n        __extends(JetView, _super);\n        function JetView(app, config) {\n            var _this = _super.call(this, app.webix) || this;\n            _this.app = app;\n            _this._children = [];\n            return _this;\n        }\n        JetView.prototype.ui = function (ui, config) {\n            config = config || {};\n            var container = config.container || ui.container;\n            var jetview = this.app.createView(ui);\n            this._children.push(jetview);\n            jetview.render(container, this._segment, this);\n            if (typeof ui !== \"object\" || (ui instanceof JetBase)) {\n                return jetview;\n            }\n            else {\n                return jetview.getRoot();\n            }\n        };\n        JetView.prototype.show = function (path, config) {\n            config = config || {};\n            if (typeof path === \"object\") {\n                for (var key in path) {\n                    this.setParam(key, path[key]);\n                }\n                path = null;\n            }\n            else {\n                if (path.substr(0, 1) === \"/\") {\n                    return this.app.show(path, config);\n                }\n                if (path.indexOf(\"./\") === 0) {\n                    path = path.substr(2);\n                }\n                if (path.indexOf(\"../\") === 0) {\n                    var parent_1 = this.getParentView();\n                    if (parent_1) {\n                        return parent_1.show(path.substr(3), config);\n                    }\n                    else {\n                        return this.app.show(\"/\" + path.substr(3));\n                    }\n                }\n                var sub = this.getSubViewInfo(config.target);\n                if (sub) {\n                    if (sub.parent !== this) {\n                        return sub.parent.show(path, config);\n                    }\n                    else if (config.target && config.target !== \"default\") {\n                        return this._renderFrameLock(config.target, sub.subview, {\n                            url: path,\n                            params: config.params,\n                        });\n                    }\n                }\n                else {\n                    if (path) {\n                        return this.app.show(\"/\" + path, config);\n                    }\n                }\n            }\n            return this._show(this._segment, { url: path, params: config.params }, this);\n        };\n        JetView.prototype._show = function (segment, path, view) {\n            var _this = this;\n            return segment.show(path, view, true).then(function () {\n                _this._init_url_data();\n                return _this._urlChange();\n            }).then(function () {\n                if (segment.route.linkRouter) {\n                    _this.app.getRouter().set(segment.route.path, { silent: true });\n                    _this.app.callEvent(\"app:route\", [segment.route.path]);\n                }\n            });\n        };\n        JetView.prototype.init = function (_$view, _$) {\n        };\n        JetView.prototype.ready = function (_$view, _$url) {\n        };\n        JetView.prototype.config = function () {\n            this.app.webix.message(\"View:Config is not implemented\");\n        };\n        JetView.prototype.urlChange = function (_$view, _$url) {\n        };\n        JetView.prototype.destroy = function () {\n        };\n        JetView.prototype.destructor = function () {\n            this.destroy();\n            this._destroyKids();\n            if (this._root) {\n                this._root.destructor();\n                _super.prototype.destructor.call(this);\n            }\n        };\n        JetView.prototype.use = function (plugin, config) {\n            plugin(this.app, this, config);\n        };\n        JetView.prototype.refresh = function () {\n            var url = this.getUrl();\n            this.destroy();\n            this._destroyKids();\n            this._destroySubs();\n            this._detachEvents();\n            if (this._container.tagName) {\n                this._root.destructor();\n            }\n            this._segment.refresh();\n            return this._render(this._segment);\n        };\n        JetView.prototype.render = function (root, url, parent) {\n            var _this = this;\n            if (typeof url === \"string\") {\n                url = new Route(url, 0);\n            }\n            this._segment = url;\n            this._parent = parent;\n            this._init_url_data();\n            root = root || document.body;\n            var _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\n            if (this._container !== _container) {\n                this._container = _container;\n                return this._render(url);\n            }\n            else {\n                return this._urlChange().then(function () { return _this.getRoot(); });\n            }\n        };\n        JetView.prototype._render = function (url) {\n            var _this = this;\n            var config = this.config();\n            if (config.then) {\n                return config.then(function (cfg) { return _this._render_final(cfg, url); });\n            }\n            else {\n                return this._render_final(config, url);\n            }\n        };\n        JetView.prototype._render_final = function (config, url) {\n            var _this = this;\n            var slot = null;\n            var container = null;\n            var show = false;\n            if (!this._container.tagName) {\n                slot = this._container;\n                if (slot.popup) {\n                    container = document.body;\n                    show = true;\n                }\n                else {\n                    container = this.webix.$$(slot.id);\n                }\n            }\n            else {\n                container = this._container;\n            }\n            if (!this.app || !container) {\n                return Promise.reject(null);\n            }\n            var response;\n            var current = this._segment.current();\n            var result = { ui: {} };\n            this.app.copyConfig(config, result.ui, this._subs);\n            this.app.callEvent(\"app:render\", [this, url, result]);\n            result.ui.$scope = this;\n            if (!slot && current.isNew && current.view) {\n                current.view.destructor();\n            }\n            try {\n                if (slot && !show) {\n                    var oldui = container;\n                    var parent_2 = oldui.getParentView();\n                    if (parent_2 && parent_2.name === \"multiview\" && !result.ui.id) {\n                        result.ui.id = oldui.config.id;\n                    }\n                }\n                this._root = this.app.webix.ui(result.ui, container);\n                var asWin = this._root;\n                if (show && asWin.setPosition && !asWin.isVisible()) {\n                    asWin.show();\n                }\n                if (slot) {\n                    if (slot.view && slot.view !== this && slot.view !== this.app) {\n                        slot.view.destructor();\n                    }\n                    slot.id = this._root.config.id;\n                    if (this.getParentView() || !this.app.app)\n                        slot.view = this;\n                    else {\n                        slot.view = this.app;\n                    }\n                }\n                if (current.isNew) {\n                    current.view = this;\n                    current.isNew = false;\n                }\n                response = Promise.resolve(this._init(this._root, url)).then(function () {\n                    return _this._urlChange().then(function () {\n                        _this._initUrl = null;\n                        return _this.ready(_this._root, url.suburl());\n                    });\n                });\n            }\n            catch (e) {\n                response = Promise.reject(e);\n            }\n            return response.catch(function (err) { return _this._initError(_this, err); });\n        };\n        JetView.prototype._init = function (view, url) {\n            return this.init(view, url.suburl());\n        };\n        JetView.prototype._urlChange = function () {\n            var _this = this;\n            this.app.callEvent(\"app:urlchange\", [this, this._segment]);\n            var waits = [];\n            for (var key in this._subs) {\n                var frame = this._subs[key];\n                var wait = this._renderFrameLock(key, frame, null);\n                if (wait) {\n                    waits.push(wait);\n                }\n            }\n            return Promise.all(waits).then(function () {\n                return _this.urlChange(_this._root, _this._segment.suburl());\n            });\n        };\n        JetView.prototype._renderFrameLock = function (key, frame, path) {\n            if (!frame.lock) {\n                var lock = this._renderFrame(key, frame, path);\n                if (lock) {\n                    frame.lock = lock.then(function () { return frame.lock = null; }, function () { return frame.lock = null; });\n                }\n            }\n            return frame.lock;\n        };\n        JetView.prototype._renderFrame = function (key, frame, path) {\n            var _this = this;\n            if (key === \"default\") {\n                if (this._segment.next()) {\n                    var params = path ? path.params : null;\n                    if (frame.params) {\n                        params = this.webix.extend(params || {}, frame.params);\n                    }\n                    return this._createSubView(frame, this._segment.shift(params));\n                }\n                else if (frame.view && frame.popup) {\n                    frame.view.destructor();\n                    frame.view = null;\n                }\n            }\n            if (path !== null) {\n                frame.url = path.url;\n                if (frame.params) {\n                    path.params = this.webix.extend(path.params || {}, frame.params);\n                }\n            }\n            if (frame.route) {\n                if (path !== null) {\n                    return frame.route.show(path, frame.view).then(function () {\n                        return _this._createSubView(frame, frame.route);\n                    });\n                }\n                if (frame.branch) {\n                    return;\n                }\n            }\n            var view = frame.view;\n            if (!view && frame.url) {\n                if (typeof frame.url === \"string\") {\n                    frame.route = new Route(frame.url, 0);\n                    if (path)\n                        frame.route.setParams(frame.route.route.url, path.params, 0);\n                    if (frame.params)\n                        frame.route.setParams(frame.route.route.url, frame.params, 0);\n                    return this._createSubView(frame, frame.route);\n                }\n                else {\n                    if (typeof frame.url === \"function\" && !(view instanceof frame.url)) {\n                        view = new (this.app._override(frame.url))(this.app, \"\");\n                    }\n                    if (!view) {\n                        view = frame.url;\n                    }\n                }\n            }\n            if (view) {\n                return view.render(frame, (frame.route || this._segment), this);\n            }\n        };\n        JetView.prototype._initError = function (view, err) {\n            if (this.app) {\n                this.app.error(\"app:error:initview\", [err, view]);\n            }\n            return true;\n        };\n        JetView.prototype._createSubView = function (sub, suburl) {\n            var _this = this;\n            return this.app.createFromURL(suburl.current()).then(function (view) {\n                return view.render(sub, suburl, _this);\n            });\n        };\n        JetView.prototype._destroyKids = function () {\n            var uis = this._children;\n            for (var i = uis.length - 1; i >= 0; i--) {\n                if (uis[i] && uis[i].destructor) {\n                    uis[i].destructor();\n                }\n            }\n            this._children = [];\n        };\n        return JetView;\n    }(JetBase));\n    var JetViewRaw = (function (_super) {\n        __extends(JetViewRaw, _super);\n        function JetViewRaw(app, config) {\n            var _this = _super.call(this, app, config) || this;\n            _this._ui = config.ui;\n            return _this;\n        }\n        JetViewRaw.prototype.config = function () {\n            return this._ui;\n        };\n        return JetViewRaw;\n    }(JetView));\n    var SubRouter = (function () {\n        function SubRouter(cb, config, app) {\n            this.path = \"\";\n            this.app = app;\n        }\n        SubRouter.prototype.set = function (path, config) {\n            this.path = path;\n            var a = this.app;\n            a.app.getRouter().set(a._segment.append(this.path), { silent: true });\n        };\n        SubRouter.prototype.get = function () {\n            return this.path;\n        };\n        return SubRouter;\n    }());\n    var _once = true;\n    var JetAppBase = (function (_super) {\n        __extends(JetAppBase, _super);\n        function JetAppBase(config) {\n            var _this = this;\n            var webix = (config || {}).webix || window.webix;\n            config = webix.extend({\n                name: \"App\",\n                version: \"1.0\",\n                start: \"/home\"\n            }, config, true);\n            _this = _super.call(this, webix, config) || this;\n            _this.config = config;\n            _this.app = _this.config.app;\n            _this.ready = Promise.resolve();\n            _this._services = {};\n            _this.webix.extend(_this, _this.webix.EventSystem);\n            return _this;\n        }\n        JetAppBase.prototype.getUrl = function () {\n            return this._subSegment.suburl();\n        };\n        JetAppBase.prototype.getUrlString = function () {\n            return this._subSegment.toString();\n        };\n        JetAppBase.prototype.getService = function (name) {\n            var obj = this._services[name];\n            if (typeof obj === \"function\") {\n                obj = this._services[name] = obj(this);\n            }\n            return obj;\n        };\n        JetAppBase.prototype.setService = function (name, handler) {\n            this._services[name] = handler;\n        };\n        JetAppBase.prototype.destructor = function () {\n            this.getSubView().destructor();\n            _super.prototype.destructor.call(this);\n        };\n        JetAppBase.prototype.copyConfig = function (obj, target, config) {\n            if (obj instanceof JetBase ||\n                (typeof obj === \"function\" && obj.prototype instanceof JetBase)) {\n                obj = { $subview: obj };\n            }\n            if (typeof obj.$subview != \"undefined\") {\n                return this.addSubView(obj, target, config);\n            }\n            var isArray = obj instanceof Array;\n            target = target || (isArray ? [] : {});\n            for (var method in obj) {\n                var point = obj[method];\n                if (typeof point === \"function\" && point.prototype instanceof JetBase) {\n                    point = { $subview: point };\n                }\n                if (point && typeof point === \"object\" &&\n                    !(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\n                    if (point instanceof Date) {\n                        target[method] = new Date(point);\n                    }\n                    else {\n                        var copy = this.copyConfig(point, (point instanceof Array ? [] : {}), config);\n                        if (copy !== null) {\n                            if (isArray)\n                                target.push(copy);\n                            else\n                                target[method] = copy;\n                        }\n                    }\n                }\n                else {\n                    target[method] = point;\n                }\n            }\n            return target;\n        };\n        JetAppBase.prototype.getRouter = function () {\n            return this.$router;\n        };\n        JetAppBase.prototype.clickHandler = function (e, target) {\n            if (e) {\n                target = target || (e.target || e.srcElement);\n                if (target && target.getAttribute) {\n                    var trigger_1 = target.getAttribute(\"trigger\");\n                    if (trigger_1) {\n                        this._forView(target, function (view) { return view.app.trigger(trigger_1); });\n                        e.cancelBubble = true;\n                        return e.preventDefault();\n                    }\n                    var route_1 = target.getAttribute(\"route\");\n                    if (route_1) {\n                        this._forView(target, function (view) { return view.show(route_1); });\n                        e.cancelBubble = true;\n                        return e.preventDefault();\n                    }\n                }\n            }\n            var parent = target.parentNode;\n            if (parent) {\n                this.clickHandler(e, parent);\n            }\n        };\n        JetAppBase.prototype.getRoot = function () {\n            return this.getSubView().getRoot();\n        };\n        JetAppBase.prototype.refresh = function () {\n            var _this = this;\n            if (!this._subSegment) {\n                return Promise.resolve(null);\n            }\n            return this.getSubView().refresh().then(function (view) {\n                _this.callEvent(\"app:route\", [_this.getUrl()]);\n                return view;\n            });\n        };\n        JetAppBase.prototype.loadView = function (url) {\n            var _this = this;\n            var views = this.config.views;\n            var result = null;\n            if (url === \"\") {\n                return Promise.resolve(this._loadError(\"\", new Error(\"Webix Jet: Empty url segment\")));\n            }\n            try {\n                if (views) {\n                    if (typeof views === \"function\") {\n                        result = views(url);\n                    }\n                    else {\n                        result = views[url];\n                    }\n                    if (typeof result === \"string\") {\n                        url = result;\n                        result = null;\n                    }\n                }\n                if (!result) {\n                    if (url === \"_hidden\") {\n                        result = { hidden: true };\n                    }\n                    else if (url === \"_blank\") {\n                        result = {};\n                    }\n                    else {\n                        url = url.replace(/\\./g, \"/\");\n                        result = this.require(\"jet-views\", url);\n                    }\n                }\n            }\n            catch (e) {\n                result = this._loadError(url, e);\n            }\n            if (!result.then) {\n                result = Promise.resolve(result);\n            }\n            result = result\n                .then(function (module) { return module.__esModule ? module.default : module; })\n                .catch(function (err) { return _this._loadError(url, err); });\n            return result;\n        };\n        JetAppBase.prototype._forView = function (target, handler) {\n            var view = this.webix.$$(target);\n            if (view) {\n                handler(view.$scope);\n            }\n        };\n        JetAppBase.prototype._loadViewDynamic = function (url) {\n            return null;\n        };\n        JetAppBase.prototype.createFromURL = function (chunk) {\n            var _this = this;\n            var view;\n            if (chunk.isNew || !chunk.view) {\n                view = this.loadView(chunk.page)\n                    .then(function (ui) { return _this.createView(ui, name, chunk.params); });\n            }\n            else {\n                view = Promise.resolve(chunk.view);\n            }\n            return view;\n        };\n        JetAppBase.prototype._override = function (ui) {\n            var over = this.config.override;\n            if (over) {\n                var dv = void 0;\n                while (ui) {\n                    dv = ui;\n                    ui = over.get(ui);\n                }\n                return dv;\n            }\n            return ui;\n        };\n        JetAppBase.prototype.createView = function (ui, name, params) {\n            ui = this._override(ui);\n            var obj;\n            if (typeof ui === \"function\") {\n                if (ui.prototype instanceof JetAppBase) {\n                    return new ui({ app: this, name: name, params: params, router: SubRouter });\n                }\n                else if (ui.prototype instanceof JetBase) {\n                    return new ui(this, { name: name, params: params });\n                }\n                else {\n                    ui = ui(this);\n                }\n            }\n            if (ui instanceof JetBase) {\n                obj = ui;\n            }\n            else {\n                obj = new JetViewRaw(this, { name: name, ui: ui });\n            }\n            return obj;\n        };\n        JetAppBase.prototype.show = function (url, config) {\n            if (url && this.app && url.indexOf(\"//\") == 0)\n                return this.app.show(url.substr(1), config);\n            return this.render(this._container, url || this.config.start, config);\n        };\n        JetAppBase.prototype.trigger = function (name) {\n            var rest = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                rest[_i - 1] = arguments[_i];\n            }\n            this.apply(name, rest);\n        };\n        JetAppBase.prototype.apply = function (name, data) {\n            this.callEvent(name, data);\n        };\n        JetAppBase.prototype.action = function (name) {\n            return this.webix.bind(function () {\n                var rest = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    rest[_i] = arguments[_i];\n                }\n                this.apply(name, rest);\n            }, this);\n        };\n        JetAppBase.prototype.on = function (name, handler) {\n            this.attachEvent(name, handler);\n        };\n        JetAppBase.prototype.use = function (plugin, config) {\n            plugin(this, null, config);\n        };\n        JetAppBase.prototype.error = function (name, er) {\n            this.callEvent(name, er);\n            this.callEvent(\"app:error\", er);\n            if (this.config.debug) {\n                for (var i = 0; i < er.length; i++) {\n                    console.error(er[i]);\n                    if (er[i] instanceof Error) {\n                        var text = er[i].message;\n                        if (text.indexOf(\"Module build failed\") === 0) {\n                            text = text.replace(/\\x1b\\[[0-9;]*m/g, \"\");\n                            document.body.innerHTML = \"<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>\" + text + \"</pre>\";\n                        }\n                        else {\n                            text += \"<br><br>Check console for more details\";\n                            this.webix.message({ type: \"error\", text: text, expire: -1 });\n                        }\n                    }\n                }\n                debugger;\n            }\n        };\n        JetAppBase.prototype.render = function (root, url, config) {\n            var _this = this;\n            this._container = (typeof root === \"string\") ?\n                this.webix.toNode(root) :\n                (root || document.body);\n            var firstInit = !this.$router;\n            var path = null;\n            if (firstInit) {\n                if (_once && \"tagName\" in this._container) {\n                    this.webix.event(document.body, \"click\", function (e) { return _this.clickHandler(e); });\n                    _once = false;\n                }\n                if (typeof url === \"string\") {\n                    url = new Route(url, 0);\n                }\n                this._subSegment = this._first_start(url);\n                this._subSegment.route.linkRouter = true;\n            }\n            else {\n                if (typeof url === \"string\") {\n                    path = url;\n                }\n                else {\n                    if (this.app) {\n                        path = url.split().route.path || this.config.start;\n                    }\n                    else {\n                        path = url.toString();\n                    }\n                }\n            }\n            var params = config ? config.params : this.config.params || null;\n            var top = this.getSubView();\n            var segment = this._subSegment;\n            var ready = segment\n                .show({ url: path, params: params }, top)\n                .then(function () { return _this.createFromURL(segment.current()); })\n                .then(function (view) { return view.render(root, segment); })\n                .then(function (base) {\n                _this.$router.set(segment.route.path, { silent: true });\n                _this.callEvent(\"app:route\", [_this.getUrl()]);\n                return base;\n            });\n            this.ready = this.ready.then(function () { return ready; });\n            return ready;\n        };\n        JetAppBase.prototype.getSubView = function () {\n            if (this._subSegment) {\n                var view = this._subSegment.current().view;\n                if (view)\n                    return view;\n            }\n            return new JetView(this, {});\n        };\n        JetAppBase.prototype.require = function (type, url) { return null; };\n        JetAppBase.prototype._first_start = function (route) {\n            var _this = this;\n            this._segment = route;\n            var cb = function (a) { return setTimeout(function () {\n                _this.show(a).catch(function (e) {\n                    if (!(e instanceof NavigationBlocked))\n                        throw e;\n                });\n            }, 1); };\n            this.$router = new (this.config.router)(cb, this.config, this);\n            if (this._container === document.body && this.config.animation !== false) {\n                var node_1 = this._container;\n                this.webix.html.addCss(node_1, \"webixappstart\");\n                setTimeout(function () {\n                    _this.webix.html.removeCss(node_1, \"webixappstart\");\n                    _this.webix.html.addCss(node_1, \"webixapp\");\n                }, 10);\n            }\n            if (!route) {\n                var urlString = this.$router.get();\n                if (!urlString) {\n                    urlString = this.config.start;\n                    this.$router.set(urlString, { silent: true });\n                }\n                route = new Route(urlString, 0);\n            }\n            else if (this.app) {\n                var now = route.current().view;\n                route.current().view = this;\n                if (route.next()) {\n                    route.refresh();\n                    route = route.split();\n                }\n                else {\n                    route = new Route(this.config.start, 0);\n                }\n                route.current().view = now;\n            }\n            return route;\n        };\n        JetAppBase.prototype._loadError = function (url, err) {\n            this.error(\"app:error:resolve\", [err, url]);\n            return { template: \" \" };\n        };\n        JetAppBase.prototype.addSubView = function (obj, target, config) {\n            var url = obj.$subview !== true ? obj.$subview : null;\n            var name = obj.name || (url ? this.webix.uid() : \"default\");\n            target.id = obj.id || \"s\" + this.webix.uid();\n            var view = config[name] = {\n                id: target.id,\n                url: url,\n                branch: obj.branch,\n                popup: obj.popup,\n                params: obj.params\n            };\n            return view.popup ? null : target;\n        };\n        return JetAppBase;\n    }(JetBase));\n    var HashRouter = (function () {\n        function HashRouter(cb, config) {\n            var _this = this;\n            this.config = config || {};\n            this._detectPrefix();\n            this.cb = cb;\n            window.onpopstate = function () { return _this.cb(_this.get()); };\n        }\n        HashRouter.prototype.set = function (path, config) {\n            var _this = this;\n            if (this.config.routes) {\n                var compare = path.split(\"?\", 2);\n                for (var key in this.config.routes) {\n                    if (this.config.routes[key] === compare[0]) {\n                        path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\n                        break;\n                    }\n                }\n            }\n            if (this.get() !== path) {\n                window.history.pushState(null, null, this.prefix + this.sufix + path);\n            }\n            if (!config || !config.silent) {\n                setTimeout(function () { return _this.cb(path); }, 1);\n            }\n        };\n        HashRouter.prototype.get = function () {\n            var path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\n            path = (path !== \"/\" && path !== \"#\") ? path : \"\";\n            if (this.config.routes) {\n                var compare = path.split(\"?\", 2);\n                var key = this.config.routes[compare[0]];\n                if (key) {\n                    path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\n                }\n            }\n            return path;\n        };\n        HashRouter.prototype._detectPrefix = function () {\n            var sufix = this.config.routerPrefix;\n            this.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\n            this.prefix = document.location.href.split(\"#\", 2)[0];\n        };\n        HashRouter.prototype._getRaw = function () {\n            return document.location.href;\n        };\n        return HashRouter;\n    }());\n    var isPatched = false;\n    function patch(w) {\n        if (isPatched || !w) {\n            return;\n        }\n        isPatched = true;\n        var win = window;\n        if (!win.Promise) {\n            win.Promise = w.promise;\n        }\n        var version = w.version.split(\".\");\n        if (version[0] * 10 + version[1] * 1 < 53) {\n            w.ui.freeze = function (handler) {\n                var res = handler();\n                if (res && res.then) {\n                    res.then(function (some) {\n                        w.ui.$freeze = false;\n                        w.ui.resize();\n                        return some;\n                    });\n                }\n                else {\n                    w.ui.$freeze = false;\n                    w.ui.resize();\n                }\n                return res;\n            };\n        }\n        var baseAdd = w.ui.baselayout.prototype.addView;\n        var baseRemove = w.ui.baselayout.prototype.removeView;\n        var config = {\n            addView: function (view, index) {\n                if (this.$scope && this.$scope.webixJet && !view.queryView) {\n                    var jview_1 = this.$scope;\n                    var subs_1 = {};\n                    view = jview_1.app.copyConfig(view, {}, subs_1);\n                    baseAdd.apply(this, [view, index]);\n                    var _loop_1 = function (key) {\n                        jview_1._renderFrame(key, subs_1[key], null).then(function () {\n                            jview_1._subs[key] = subs_1[key];\n                        });\n                    };\n                    for (var key in subs_1) {\n                        _loop_1(key);\n                    }\n                    return view.id;\n                }\n                else {\n                    return baseAdd.apply(this, arguments);\n                }\n            },\n            removeView: function () {\n                baseRemove.apply(this, arguments);\n                if (this.$scope && this.$scope.webixJet) {\n                    var subs = this.$scope._subs;\n                    for (var key in subs) {\n                        var test = subs[key];\n                        if (!w.$$(test.id)) {\n                            test.view.destructor();\n                            delete subs[key];\n                        }\n                    }\n                }\n            }\n        };\n        w.extend(w.ui.layout.prototype, config, true);\n        w.extend(w.ui.baselayout.prototype, config, true);\n        w.protoUI({\n            name: \"jetapp\",\n            $init: function (cfg) {\n                this.$app = new this.app(cfg);\n                var id = w.uid().toString();\n                cfg.body = { id: id };\n                this.$ready.push(function () {\n                    this.callEvent(\"onInit\", [this.$app]);\n                    this.$app.render({ id: id });\n                });\n            }\n        }, w.ui.proxy, w.EventSystem);\n    }\n    var JetApp = (function (_super) {\n        __extends(JetApp, _super);\n        function JetApp(config) {\n            var _this = this;\n            config.router = config.router || HashRouter;\n            _this = _super.call(this, config) || this;\n            patch(_this.webix);\n            return _this;\n        }\n        JetApp.prototype.require = function (type, url) {\n            return require(type + \"/\" + url);\n        };\n        return JetApp;\n    }(JetAppBase));\n    var UrlRouter = (function (_super) {\n        __extends(UrlRouter, _super);\n        function UrlRouter() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        UrlRouter.prototype._detectPrefix = function () {\n            this.prefix = \"\";\n            this.sufix = this.config.routerPrefix || \"\";\n        };\n        UrlRouter.prototype._getRaw = function () {\n            return document.location.pathname + (document.location.search || \"\");\n        };\n        return UrlRouter;\n    }(HashRouter));\n    var EmptyRouter = (function () {\n        function EmptyRouter(cb, _$config) {\n            this.path = \"\";\n            this.cb = cb;\n        }\n        EmptyRouter.prototype.set = function (path, config) {\n            var _this = this;\n            this.path = path;\n            if (!config || !config.silent) {\n                setTimeout(function () { return _this.cb(path); }, 1);\n            }\n        };\n        EmptyRouter.prototype.get = function () {\n            return this.path;\n        };\n        return EmptyRouter;\n    }());\n    function UnloadGuard(app, view, config) {\n        view.on(app, \"app:guard\", function (_$url, point, promise) {\n            if (point === view || point.contains(view)) {\n                var res_1 = config();\n                if (res_1 === false) {\n                    promise.confirm = Promise.reject(new NavigationBlocked());\n                }\n                else {\n                    promise.confirm = promise.confirm.then(function () { return res_1; });\n                }\n            }\n        });\n    }\n    function has(store, key) {\n        return Object.prototype.hasOwnProperty.call(store, key);\n    }\n    function forEach(obj, handler, context) {\n        for (var key in obj) {\n            if (has(obj, key)) {\n                handler.call((context || obj), obj[key], key, obj);\n            }\n        }\n    }\n    function trim(str) {\n        return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n    }\n    function warn(message) {\n        message = 'Warning: ' + message;\n        if (typeof console !== 'undefined') {\n            console.error(message);\n        }\n        try {\n            throw new Error(message);\n        }\n        catch (x) { }\n    }\n    var replace = String.prototype.replace;\n    var split = String.prototype.split;\n    var delimiter = '||||';\n    var russianPluralGroups = function (n) {\n        var end = n % 10;\n        if (n !== 11 && end === 1) {\n            return 0;\n        }\n        if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n            return 1;\n        }\n        return 2;\n    };\n    var pluralTypes = {\n        arabic: function (n) {\n            if (n < 3) {\n                return n;\n            }\n            var lastTwo = n % 100;\n            if (lastTwo >= 3 && lastTwo <= 10)\n                return 3;\n            return lastTwo >= 11 ? 4 : 5;\n        },\n        bosnian_serbian: russianPluralGroups,\n        chinese: function () { return 0; },\n        croatian: russianPluralGroups,\n        french: function (n) { return n > 1 ? 1 : 0; },\n        german: function (n) { return n !== 1 ? 1 : 0; },\n        russian: russianPluralGroups,\n        lithuanian: function (n) {\n            if (n % 10 === 1 && n % 100 !== 11) {\n                return 0;\n            }\n            return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n        },\n        czech: function (n) {\n            if (n === 1) {\n                return 0;\n            }\n            return (n >= 2 && n <= 4) ? 1 : 2;\n        },\n        polish: function (n) {\n            if (n === 1) {\n                return 0;\n            }\n            var end = n % 10;\n            return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n        },\n        icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n        slovenian: function (n) {\n            var lastTwo = n % 100;\n            if (lastTwo === 1) {\n                return 0;\n            }\n            if (lastTwo === 2) {\n                return 1;\n            }\n            if (lastTwo === 3 || lastTwo === 4) {\n                return 2;\n            }\n            return 3;\n        }\n    };\n    var pluralTypeToLanguages = {\n        arabic: ['ar'],\n        bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n        chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n        croatian: ['hr', 'hr-HR'],\n        german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n        french: ['fr', 'tl', 'pt-br'],\n        russian: ['ru', 'ru-RU'],\n        lithuanian: ['lt'],\n        czech: ['cs', 'cs-CZ', 'sk'],\n        polish: ['pl'],\n        icelandic: ['is'],\n        slovenian: ['sl-SL']\n    };\n    function langToTypeMap(mapping) {\n        var ret = {};\n        forEach(mapping, function (langs, type) {\n            forEach(langs, function (lang) {\n                ret[lang] = type;\n            });\n        });\n        return ret;\n    }\n    function pluralTypeName(locale) {\n        var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n        return langToPluralType[locale]\n            || langToPluralType[split.call(locale, /-/, 1)[0]]\n            || langToPluralType.en;\n    }\n    function pluralTypeIndex(locale, count) {\n        return pluralTypes[pluralTypeName(locale)](count);\n    }\n    function escape(token) {\n        return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    }\n    function constructTokenRegex(opts) {\n        var prefix = (opts && opts.prefix) || '%{';\n        var suffix = (opts && opts.suffix) || '}';\n        if (prefix === delimiter || suffix === delimiter) {\n            throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n        }\n        return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n    }\n    var dollarRegex = /\\$/g;\n    var dollarBillsYall = '$$';\n    var defaultTokenRegex = /%\\{(.*?)\\}/g;\n    function transformPhrase(phrase, substitutions, locale, tokenRegex) {\n        if (typeof phrase !== 'string') {\n            throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n        }\n        if (substitutions == null) {\n            return phrase;\n        }\n        var result = phrase;\n        var interpolationRegex = tokenRegex || defaultTokenRegex;\n        var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n        if (options.smart_count != null && result) {\n            var texts = split.call(result, delimiter);\n            result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n        }\n        result = replace.call(result, interpolationRegex, function (expression, argument) {\n            if (!has(options, argument) || options[argument] == null) {\n                return expression;\n            }\n            return replace.call(options[argument], dollarRegex, dollarBillsYall);\n        });\n        return result;\n    }\n    function Polyglot(options) {\n        var opts = options || {};\n        this.phrases = {};\n        this.extend(opts.phrases || {});\n        this.currentLocale = opts.locale || 'en';\n        var allowMissing = opts.allowMissing ? transformPhrase : null;\n        this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n        this.warn = opts.warn || warn;\n        this.tokenRegex = constructTokenRegex(opts.interpolation);\n    }\n    Polyglot.prototype.locale = function (newLocale) {\n        if (newLocale)\n            this.currentLocale = newLocale;\n        return this.currentLocale;\n    };\n    Polyglot.prototype.extend = function (morePhrases, prefix) {\n        forEach(morePhrases, function (phrase, key) {\n            var prefixedKey = prefix ? prefix + '.' + key : key;\n            if (typeof phrase === 'object') {\n                this.extend(phrase, prefixedKey);\n            }\n            else {\n                this.phrases[prefixedKey] = phrase;\n            }\n        }, this);\n    };\n    Polyglot.prototype.unset = function (morePhrases, prefix) {\n        if (typeof morePhrases === 'string') {\n            delete this.phrases[morePhrases];\n        }\n        else {\n            forEach(morePhrases, function (phrase, key) {\n                var prefixedKey = prefix ? prefix + '.' + key : key;\n                if (typeof phrase === 'object') {\n                    this.unset(phrase, prefixedKey);\n                }\n                else {\n                    delete this.phrases[prefixedKey];\n                }\n            }, this);\n        }\n    };\n    Polyglot.prototype.clear = function () {\n        this.phrases = {};\n    };\n    Polyglot.prototype.replace = function (newPhrases) {\n        this.clear();\n        this.extend(newPhrases);\n    };\n    Polyglot.prototype.t = function (key, options) {\n        var phrase, result;\n        var opts = options == null ? {} : options;\n        if (typeof this.phrases[key] === 'string') {\n            phrase = this.phrases[key];\n        }\n        else if (typeof opts._ === 'string') {\n            phrase = opts._;\n        }\n        else if (this.onMissingKey) {\n            var onMissingKey = this.onMissingKey;\n            result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n        }\n        else {\n            this.warn('Missing translation for key: \"' + key + '\"');\n            result = key;\n        }\n        if (typeof phrase === 'string') {\n            result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n        }\n        return result;\n    };\n    Polyglot.prototype.has = function (key) {\n        return has(this.phrases, key);\n    };\n    Polyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n        return transformPhrase(phrase, substitutions, locale);\n    };\n    var webixPolyglot = Polyglot;\n    function Locale(app, _view, config) {\n        config = config || {};\n        var storage = config.storage;\n        var lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\n        function setLangData(name, data, silent) {\n            if (data.__esModule) {\n                data = data.default;\n            }\n            var pconfig = { phrases: data };\n            if (config.polyglot) {\n                app.webix.extend(pconfig, config.polyglot);\n            }\n            var poly = service.polyglot = new webixPolyglot(pconfig);\n            poly.locale(name);\n            service._ = app.webix.bind(poly.t, poly);\n            lang = name;\n            if (storage) {\n                storage.put(\"lang\", lang);\n            }\n            if (config.webix) {\n                var locName = config.webix[name];\n                if (locName) {\n                    app.webix.i18n.setLocale(locName);\n                }\n            }\n            if (!silent) {\n                return app.refresh();\n            }\n            return Promise.resolve();\n        }\n        function getLang() { return lang; }\n        function setLang(name, silent) {\n            if (config.path === false) {\n                return;\n            }\n            var path = (config.path ? config.path + \"/\" : \"\") + name;\n            var data = app.require(\"jet-locales\", path);\n            setLangData(name, data, silent);\n        }\n        var service = {\n            getLang: getLang, setLang: setLang, setLangData: setLangData, _: null, polyglot: null\n        };\n        app.setService(\"locale\", service);\n        setLang(lang, true);\n    }\n    function show(view, config, value) {\n        var _a;\n        if (config.urls) {\n            value = config.urls[value] || value;\n        }\n        else if (config.param) {\n            value = (_a = {}, _a[config.param] = value, _a);\n        }\n        view.show(value);\n    }\n    function Menu(app, view, config) {\n        var frame = view.getSubViewInfo().parent;\n        var ui = view.$$(config.id || config);\n        var silent = false;\n        ui.attachEvent(\"onchange\", function () {\n            if (!silent) {\n                show(frame, config, this.getValue());\n            }\n        });\n        ui.attachEvent(\"onafterselect\", function () {\n            if (!silent) {\n                var id = null;\n                if (ui.setValue) {\n                    id = this.getValue();\n                }\n                else if (ui.getSelectedId) {\n                    id = ui.getSelectedId();\n                }\n                show(frame, config, id);\n            }\n        });\n        view.on(app, \"app:route\", function () {\n            var name = \"\";\n            if (config.param) {\n                name = view.getParam(config.param, true);\n            }\n            else {\n                var segment = frame.getUrl()[1];\n                if (segment) {\n                    name = segment.page;\n                }\n            }\n            if (name) {\n                silent = true;\n                if (ui.setValue && ui.getValue() !== name) {\n                    ui.setValue(name);\n                }\n                else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name) {\n                    ui.select(name);\n                }\n                silent = false;\n            }\n        });\n    }\n    var baseicons = {\n        good: \"check\",\n        error: \"warning\",\n        saving: \"refresh fa-spin\"\n    };\n    var basetext = {\n        good: \"Ok\",\n        error: \"Error\",\n        saving: \"Connecting...\"\n    };\n    function Status(app, view, config) {\n        var status = \"good\";\n        var count = 0;\n        var iserror = false;\n        var expireDelay = config.expire;\n        if (!expireDelay && expireDelay !== false) {\n            expireDelay = 2000;\n        }\n        var texts = config.texts || basetext;\n        var icons = config.icons || baseicons;\n        if (typeof config === \"string\") {\n            config = { target: config };\n        }\n        function refresh(content) {\n            var area = view.$$(config.target);\n            if (area) {\n                if (!content) {\n                    content = \"<div class='status_\" +\n                        status +\n                        \"'><span class='webix_icon fa-\" +\n                        icons[status] + \"'></span> \" + texts[status] + \"</div>\";\n                }\n                area.setHTML(content);\n            }\n        }\n        function success() {\n            count--;\n            setStatus(\"good\");\n        }\n        function fail(err) {\n            count--;\n            setStatus(\"error\", err);\n        }\n        function start(promise) {\n            count++;\n            setStatus(\"saving\");\n            if (promise && promise.then) {\n                promise.then(success, fail);\n            }\n        }\n        function getStatus() {\n            return status;\n        }\n        function hideStatus() {\n            if (count === 0) {\n                refresh(\" \");\n            }\n        }\n        function setStatus(mode, err) {\n            if (count < 0) {\n                count = 0;\n            }\n            if (mode === \"saving\") {\n                status = \"saving\";\n                refresh();\n            }\n            else {\n                iserror = (mode === \"error\");\n                if (count === 0) {\n                    status = iserror ? \"error\" : \"good\";\n                    if (iserror) {\n                        app.error(\"app:error:server\", [err.responseText || err]);\n                    }\n                    else {\n                        if (expireDelay) {\n                            setTimeout(hideStatus, expireDelay);\n                        }\n                    }\n                    refresh();\n                }\n            }\n        }\n        function track(data) {\n            var dp = app.webix.dp(data);\n            if (dp) {\n                view.on(dp, \"onAfterDataSend\", start);\n                view.on(dp, \"onAfterSaveError\", function (_id, _obj, response) { return fail(response); });\n                view.on(dp, \"onAfterSave\", success);\n            }\n        }\n        app.setService(\"status\", {\n            getStatus: getStatus,\n            setStatus: setStatus,\n            track: track\n        });\n        if (config.remote) {\n            view.on(app.webix, \"onRemoteCall\", start);\n        }\n        if (config.ajax) {\n            view.on(app.webix, \"onBeforeAjax\", function (_mode, _url, _data, _request, _headers, _files, promise) {\n                start(promise);\n            });\n        }\n        if (config.data) {\n            track(config.data);\n        }\n    }\n    function Theme(app, _view, config) {\n        config = config || {};\n        var storage = config.storage;\n        var theme = storage ?\n            (storage.get(\"theme\") || \"flat-default\")\n            :\n                (config.theme || \"flat-default\");\n        var service = {\n            getTheme: function () { return theme; },\n            setTheme: function (name, silent) {\n                var parts = name.split(\"-\");\n                var links = document.getElementsByTagName(\"link\");\n                for (var i = 0; i < links.length; i++) {\n                    var lname = links[i].getAttribute(\"title\");\n                    if (lname) {\n                        if (lname === name || lname === parts[0]) {\n                            links[i].disabled = false;\n                        }\n                        else {\n                            links[i].disabled = true;\n                        }\n                    }\n                }\n                app.webix.skin.set(parts[0]);\n                app.webix.html.removeCss(document.body, \"theme-\" + theme);\n                app.webix.html.addCss(document.body, \"theme-\" + name);\n                theme = name;\n                if (storage) {\n                    storage.put(\"theme\", name);\n                }\n                if (!silent) {\n                    app.refresh();\n                }\n            }\n        };\n        app.setService(\"theme\", service);\n        service.setTheme(theme, true);\n    }\n    function copyParams(data, url, route) {\n        for (var i = 0; i < route.length; i++) {\n            data[route[i]] = url[i + 1] ? url[i + 1].page : \"\";\n        }\n    }\n    function UrlParam(app, view, config) {\n        var route = config.route || config;\n        var data = {};\n        view.on(app, \"app:urlchange\", function (subview, segment) {\n            if (view === subview) {\n                copyParams(data, segment.suburl(), route);\n                segment.size(route.length + 1);\n            }\n        });\n        var os = view.setParam;\n        var og = view.getParam;\n        view.setParam = function (name, value, show) {\n            var index = route.indexOf(name);\n            if (index >= 0) {\n                data[name] = value;\n                this._segment.update(\"\", value, index + 1);\n                if (show) {\n                    return view.show(null);\n                }\n            }\n            else {\n                return os.call(this, name, value, show);\n            }\n        };\n        view.getParam = function (key, mode) {\n            var val = data[key];\n            if (typeof val !== \"undefined\") {\n                return val;\n            }\n            return og.call(this, key, mode);\n        };\n        copyParams(data, view.getUrl(), route);\n    }\n    function User(app, _view, config) {\n        config = config || {};\n        var login = config.login || \"/login\";\n        var logout = config.logout || \"/logout\";\n        var afterLogin = config.afterLogin || app.config.start;\n        var afterLogout = config.afterLogout || \"/login\";\n        var ping = config.ping || 5 * 60 * 1000;\n        var model = config.model;\n        var user = config.user;\n        var service = {\n            getUser: function () {\n                return user;\n            },\n            getStatus: function (server) {\n                if (!server) {\n                    return user !== null;\n                }\n                return model.status().catch(function () { return null; }).then(function (data) {\n                    user = data;\n                });\n            },\n            login: function (name, pass) {\n                return model.login(name, pass).then(function (data) {\n                    user = data;\n                    if (!data) {\n                        throw new Error(\"Access denied\");\n                    }\n                    app.callEvent(\"app:user:login\", [user]);\n                    app.show(afterLogin);\n                });\n            },\n            logout: function () {\n                user = null;\n                return model.logout().then(function (res) {\n                    app.callEvent(\"app:user:logout\", []);\n                    return res;\n                });\n            }\n        };\n        function canNavigate(url, obj) {\n            if (url === logout) {\n                service.logout();\n                obj.redirect = afterLogout;\n            }\n            else if (url !== login && !service.getStatus()) {\n                obj.redirect = login;\n            }\n        }\n        app.setService(\"user\", service);\n        app.attachEvent(\"app:guard\", function (url, _$root, obj) {\n            if (config.public && config.public(url)) {\n                return true;\n            }\n            if (typeof user === \"undefined\") {\n                obj.confirm = service.getStatus(true).then(function () { return canNavigate(url, obj); });\n            }\n            return canNavigate(url, obj);\n        });\n        if (ping) {\n            setInterval(function () { return service.getStatus(true); }, ping);\n        }\n    }\n    var webix$1 = window.webix;\n    if (webix$1) {\n        patch(webix$1);\n    }\n    var plugins = {\n        UnloadGuard: UnloadGuard, Locale: Locale, Menu: Menu, Theme: Theme, User: User, Status: Status, UrlParam: UrlParam\n    };\n    var w = window;\n    if (!w.Promise) {\n        w.Promise = w.webix.promise;\n    }\n\n    var index = 1;\n    function uid() {\n        return index++;\n    }\n    var empty = undefined;\n    function ignoreInitial(code) {\n        var init = false;\n        return function () {\n            if (init)\n                return code.apply(this, arguments);\n            else\n                init = true;\n        };\n    }\n    var context = null;\n    function link(source, target, key) {\n        Object.defineProperty(target, key, {\n            get: function () { return source[key]; },\n            set: function (value) { return (source[key] = value); },\n        });\n    }\n    function createState(data, config) {\n        config = config || {};\n        var handlers = {};\n        var out = {};\n        var observe = function (mask, handler) {\n            var key = uid();\n            handlers[key] = { mask: mask, handler: handler };\n            if (mask === \"*\")\n                handler(out, empty, mask);\n            else\n                handler(out[mask], empty, mask);\n            return key;\n        };\n        var observeEnd = function (id) {\n            delete handlers[id];\n        };\n        var queue = [];\n        var waitInQueue = false;\n        var batch = function (code) {\n            if (typeof code !== \"function\") {\n                var values_1 = code;\n                code = function () {\n                    for (var key in values_1)\n                        out[key] = values_1[key];\n                };\n            }\n            waitInQueue = true;\n            code(out);\n            waitInQueue = false;\n            while (queue.length) {\n                var obj = queue.shift();\n                notify.apply(this, obj);\n            }\n        };\n        var notify = function (key, old, value, meta) {\n            if (waitInQueue) {\n                queue.push([key, old, value, meta]);\n                return;\n            }\n            var list = Object.keys(handlers);\n            for (var i = 0; i < list.length; i++) {\n                var obj = handlers[list[i]];\n                if (!obj)\n                    continue;\n                if (obj.mask === \"*\" || obj.mask === key) {\n                    obj.handler(value, old, key, meta);\n                }\n            }\n        };\n        for (var key2 in data) {\n            if (data.hasOwnProperty(key2)) {\n                var test = data[key2];\n                if (config.nested && typeof test === \"object\" && test) {\n                    out[key2] = createState(test, config);\n                }\n                else {\n                    reactive(out, test, key2, notify);\n                }\n            }\n        }\n        Object.defineProperty(out, \"$changes\", {\n            value: {\n                attachEvent: observe,\n                detachEvent: observeEnd,\n            },\n            enumerable: false,\n            configurable: false,\n        });\n        Object.defineProperty(out, \"$observe\", {\n            value: observe,\n            enumerable: false,\n            configurable: false,\n        });\n        Object.defineProperty(out, \"$batch\", {\n            value: batch,\n            enumerable: false,\n            configurable: false,\n        });\n        return out;\n    }\n    function reactive(obj, val, key, notify) {\n        Object.defineProperty(obj, key, {\n            get: function () {\n                return val;\n            },\n            set: function (value) {\n                var changed = false;\n                if (val === null || value === null) {\n                    changed = val !== value;\n                }\n                else {\n                    changed = val.valueOf() != value.valueOf();\n                }\n                if (changed) {\n                    var old = val;\n                    val = value;\n                    notify(key, old, value, context);\n                }\n            },\n            enumerable: true,\n            configurable: false,\n        });\n    }\n\n    var ActionsPopupView = (function (_super) {\n        __extends(ActionsPopupView, _super);\n        function ActionsPopupView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        ActionsPopupView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            return {\n                view: \"popup\",\n                point: false,\n                body: {\n                    view: \"list\",\n                    yCount: 4,\n                    width: 120,\n                    borderless: true,\n                    data: [\n                        { id: \"edit\", value: _(\"Edit\") },\n                        { id: \"add-filter\", value: _(\"Add Filter\") },\n                        { id: \"add-group\", value: _(\"Add Group\") },\n                        { id: \"delete\", value: _(\"Delete\") },\n                    ],\n                    click: function (id) {\n                        _this.app.callEvent(\"action\", [id, _this.Item]);\n                        _this.Hide();\n                    },\n                },\n            };\n        };\n        ActionsPopupView.prototype.Hide = function () {\n            this.getRoot().hide();\n        };\n        ActionsPopupView.prototype.Show = function (node, item) {\n            this.Item = item;\n            var pos = webix.html.offset(node);\n            this.getRoot().show({\n                x: pos.x + pos.width + webix.skin.$active.dataPadding,\n                y: pos.y - 10,\n            });\n        };\n        return ActionsPopupView;\n    }(JetView));\n\n    var menuRight = \"<span style='float:right' class='webix_icon action-menu wxi-dots'></span>\";\n    var menuClose = \"<span style='float:right' class='webix_icon action-close wxi-close'></span>\";\n\n    var BaseView = (function (_super) {\n        __extends(BaseView, _super);\n        function BaseView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        BaseView.prototype.GetButton = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var button = {\n                view: \"button\",\n                value: _(\"Add filter\"),\n                localId: \"button\",\n                css: \"webix_primary\",\n                click: function () { return _this.Add(null, null); },\n            };\n            return button;\n        };\n        BaseView.prototype.GetList = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var simple = this.getParam(\"simple\");\n            var icon = simple ? menuClose : menuRight;\n            var AND = _(\"and\");\n            var OR = _(\"or\");\n            var GLUE = function (obj) { return (obj.glue == \"and\" ? AND : OR); };\n            var list = {\n                view: \"tree\",\n                borderless: true,\n                localId: \"list\",\n                glue: \"and\",\n                css: \"wbq-query_list\",\n                scheme: {\n                    $serialize: function (obj) {\n                        if (obj.group) {\n                            return { group: obj.group, glue: obj.glue };\n                        }\n                        var out = {\n                            glue: obj.glue,\n                            field: obj.field,\n                            condition: obj.condition,\n                        };\n                        if (obj.includes && obj.includes.length)\n                            out.includes = obj.includes;\n                        return out;\n                    },\n                    $init: function (obj) {\n                        if (obj.group) {\n                            obj.$css = \"group\";\n                            obj.open = true;\n                        }\n                    },\n                },\n                type: {\n                    template: function (obj) {\n                        if (obj.group) {\n                            var editCss = _this.DisableSwitch\n                                ? \"wbq-filter_join_disabled\"\n                                : \"\";\n                            return \"<div class='wbq-filter_join wbq-filter_join_\" + obj.glue + \" \" + editCss + \"'>\" + GLUE(obj) + \"</div>\";\n                        }\n                        return (_this.Template(obj, _this.app.config.fields, icon, _) +\n                            (\"<div class='wbq-filter_join wbq-filter_join_\" + obj.glue + \"'>\" + GLUE(obj) + \"</div>\"));\n                    },\n                },\n                onClick: {\n                    \"action-menu\": function (e, id) {\n                        this.$scope.Actions.Show(e.target, id);\n                    },\n                    \"action-close\": function (e, id) {\n                        _this.Delete(id);\n                    },\n                    \"wbq-filter_join\": function (e, id) {\n                        _this.SwitchGlue(id);\n                    },\n                },\n                on: {\n                    onItemDblClick: function (id) {\n                        _this.EditStart(id);\n                    },\n                },\n            };\n            return list;\n        };\n        BaseView.prototype.init = function () {\n            var _this = this;\n            this.Actions = this.ui(ActionsPopupView);\n            this.on(this.app, \"applyFilter\", function (v) { return _this.EditStop(v); });\n            this.on(this.app, \"action\", function (type, id) {\n                if (type === \"delete\") {\n                    _this.Delete(id);\n                }\n                else if (type === \"add-filter\") {\n                    _this.Add(null, id);\n                }\n                else if (type === \"add-group\") {\n                    _this.AddGroup(null, id);\n                }\n                else if (type === \"edit\") {\n                    webix.delay(function () { return _this.EditStart(id); });\n                }\n            });\n            this.State = this.getParam(\"state\");\n            this.on(this.State.$changes, \"value\", function (v) {\n                _this.LastValue = JSON.stringify(v);\n                _this.EditStop();\n                _this.$$(\"list\").clearAll();\n                if (v) {\n                    _this.$$(\"list\").parse(_this.ConvertTo(v));\n                }\n            });\n        };\n        BaseView.prototype.ConvertTo = function (v, glue) {\n            var _this = this;\n            if (v.rules) {\n                var data = v.rules.map(function (a) { return _this.ConvertTo(a, v.glue); });\n                if (!glue)\n                    return data;\n                return { group: true, glue: glue, data: data };\n            }\n            var out = __assign(__assign({}, v), { glue: glue });\n            return out;\n        };\n        BaseView.prototype.ConvertFrom = function (id, source) {\n            var _this = this;\n            var glue = \"and\";\n            var branch = source.getBranch(id);\n            var rules = branch.map(function (_a) {\n                var id = _a.id, field = _a.field, type = _a.type, condition = _a.condition, includes = _a.includes;\n                if (field)\n                    return { field: field, type: type, condition: condition, includes: includes };\n                return _this.ConvertFrom(id, source);\n            });\n            if (!rules.length)\n                return null;\n            glue = branch[0].glue;\n            return { glue: glue, rules: rules };\n        };\n        BaseView.prototype.Add = function (obj, after) {\n            this.EditStop();\n            obj = obj || { field: \"\" };\n            var list = this.$$(\"list\");\n            var parent = after ? list.getParentId(after) : 0;\n            var index = after ? list.getBranchIndex(after) + 1 : -1;\n            if (!after && list.count())\n                after = list.getFirstId();\n            var glue = after ? list.getItem(after).glue : list.config.glue;\n            obj.glue = glue;\n            var id = list.add(obj, index, parent);\n            this.EditStart(id);\n            this.CreateMode = true;\n        };\n        BaseView.prototype.SwitchGlue = function (id) {\n            this.EditStop();\n            var list = this.$$(\"list\");\n            var branch = list.data.getBranch(list.getParentId(id));\n            for (var i = 0; i < branch.length; i++) {\n                list.updateItem(branch[i].id, {\n                    glue: branch[i].glue == \"and\" ? \"or\" : \"and\",\n                });\n            }\n            this.Save();\n        };\n        BaseView.prototype.AddGroup = function (obj, after) {\n            this.EditStop();\n            obj = obj || {};\n            var list = this.$$(\"list\");\n            var parent = after ? list.getParentId(after) : 0;\n            var index = after ? list.getBranchIndex(after) + 1 : -1;\n            var node = { id: webix.uid(), group: true };\n            var glue = after ? list.getItem(after).glue : list.config.glue;\n            node.glue = glue;\n            obj.glue = node.glue == \"and\" ? \"or\" : \"and\";\n            this.DisableSwitch = true;\n            list.add(node, index, parent);\n            var id = list.add(obj, null, node.id);\n            this.EditStart(id);\n            this.DisableSwitch = false;\n            this.CreateMode = true;\n        };\n        BaseView.prototype.Delete = function (id) {\n            this.EditStop();\n            this.DeleteSilent(id);\n            this.Save();\n        };\n        BaseView.prototype.DeleteSilent = function (id) {\n            var list = this.$$(\"list\");\n            if (!list.exists(id))\n                return null;\n            var parent = list.getParentId(id);\n            list.remove(id);\n            var branch = list.data.branch[parent];\n            if (parent && !branch) {\n                this.DeleteSilent(parent);\n            }\n            else if (branch.length == 1 && list.getItem(branch[0]).group) {\n                var sub = branch[0];\n                if (parent) {\n                    var grand = list.getParentId(parent);\n                    var pIndex = list.getBranchIndex(parent, grand);\n                    list.move(sub, pIndex, list, { parent: grand });\n                    this.DeleteSilent(parent);\n                }\n                else {\n                    var pIndex = list.getBranchIndex(sub, 0);\n                    var kids = [].concat(list.data.branch[sub]);\n                    list.move(kids, pIndex, list, { parent: 0 });\n                    this.DeleteSilent(sub);\n                }\n            }\n        };\n        BaseView.prototype.EditStop = function (v) {\n            if (!this.Active)\n                return;\n            var list = this.$$(\"list\");\n            if (!v) {\n                if (this.CreateMode)\n                    this.DeleteSilent(this.ActiveId);\n                else\n                    list.refresh(this.ActiveId);\n            }\n            else {\n                v = v || this.Active.GetValue();\n                v.includes = v.includes || [];\n                list.updateItem(this.ActiveId, __assign({}, v));\n            }\n            var t = this.Active;\n            this.Active = null;\n            this.ActiveId = null;\n            t.destructor();\n            this.Save();\n        };\n        BaseView.prototype.Save = function () {\n            var v = this.ConvertFrom(0, this.$$(\"list\").data);\n            var asString = JSON.stringify(v);\n            if (this.LastValue !== asString) {\n                this.State.value = v;\n            }\n        };\n        BaseView.prototype.Template = function (obj, fields, icon, _) {\n            var op = \"&nbsp;\";\n            var field = fields.find(function (a) { return a.id === obj.field; }) || { value: \"\" };\n            if (obj.includes && obj.includes.length) {\n                op = _(\"in\") + \" \";\n                for (var i = 0; i < obj.includes.length; i++) {\n                    op +=\n                        (i > 0 ? \", \" : \"\") +\n                            (\"<span class='wbq-field-value'>\" + obj.includes[i] + \"</span>\");\n                }\n            }\n            else {\n                if (obj.condition && obj.condition.type) {\n                    op = _(obj.condition.type) + \" <span class='wbq-field-value'>\" + this.Format(obj.condition.filter, field.format, field.type) + \"</span>\";\n                }\n            }\n            return \"<span class='wbq-field-box'><span class='wbq-field-name'>\" + field.value + \"</span> \" + op + \" </span>\" + icon;\n        };\n        BaseView.prototype.Format = function (value, format, type) {\n            if (!value)\n                return \"\";\n            if (value.start)\n                value =\n                    this.Format(value.start, format, type) +\n                        (value.end ? \" - \" + this.Format(value.end, format, type) : \"\");\n            else {\n                var parser = format || (type == \"date\" ? webix.i18n.dateFormatStr : null);\n                if (parser)\n                    value = parser(value);\n            }\n            return value;\n        };\n        return BaseView;\n    }(JetView));\n\n    var FilterView = (function (_super) {\n        __extends(FilterView, _super);\n        function FilterView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        FilterView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var fieldselect = {\n                view: \"richselect\",\n                options: [],\n                localId: \"field\",\n                on: {\n                    onChange: function () { return _this.AdjustToField(); },\n                },\n            };\n            var filter = { localId: \"filter\" };\n            var bottombar = {\n                type: \"clean\",\n                cols: [\n                    {\n                        view: \"button\",\n                        value: _(\"Cancel\"),\n                        width: 100,\n                        click: function () { return _this.Hide(); },\n                    },\n                    {},\n                    {\n                        view: \"button\",\n                        value: _(\"Apply\"),\n                        width: 100,\n                        css: \"webix_primary\",\n                        click: function () { return _this.ApplyFilter(); },\n                    },\n                ],\n            };\n            return {\n                padding: 10,\n                margin: 6,\n                css: \"webix_shadow_small\",\n                rows: [fieldselect, filter, bottombar],\n            };\n        };\n        FilterView.prototype.GetField = function () {\n            var fselect = this.$$(\"field\");\n            return fselect.getList().getItem(fselect.getValue());\n        };\n        FilterView.prototype.AdjustToField = function () {\n            var field = this.GetField();\n            this.CreateFilter(field.id, field.type, field.format, field.conditions, this.$$(\"filter\"));\n        };\n        FilterView.prototype.CreateFilter = function (field, type, format, conditions, place) {\n            var ui = {\n                view: \"filter\",\n                localId: \"filter\",\n                conditions: conditions,\n                field: field,\n                mode: type,\n                template: function (o) {\n                    var str = o[field];\n                    var parser = format || (type == \"date\" ? webix.i18n.dateFormatStr : null);\n                    if (parser)\n                        str = parser(str);\n                    return str;\n                },\n                margin: 6,\n            };\n            var filter = webix.ui(ui, place);\n            var data = this.app.getService(\"backend\").data(field);\n            filter.parse(data);\n            return filter;\n        };\n        FilterView.prototype.ApplyFilter = function () {\n            this.app.callEvent(\"applyFilter\", [this.GetValue()]);\n        };\n        FilterView.prototype.GetValue = function () {\n            var field = this.GetField();\n            var rule = __assign(__assign({}, this.$$(\"filter\").getValue()), { field: field.id, type: field.type });\n            if (rule.condition.filter == \"\" &&\n                (!rule.includes || !rule.includes.length))\n                rule = null;\n            return rule;\n        };\n        FilterView.prototype.Hide = function () {\n            this.app.callEvent(\"applyFilter\", [null]);\n        };\n        FilterView.prototype.Show = function (value, fields) {\n            var fselect = this.$$(\"field\");\n            fselect.getList().parse(fields);\n            if (value.field) {\n                fselect.setValue(value.field);\n            }\n            else {\n                fselect.setValue(fields[0].id);\n            }\n            this.$$(\"filter\").setValue(webix.copy(value));\n        };\n        return FilterView;\n    }(JetView));\n\n    var FilterPopup = (function (_super) {\n        __extends(FilterPopup, _super);\n        function FilterPopup() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        FilterPopup.prototype.config = function () {\n            return {\n                view: \"popup\",\n                point: false,\n                body: { $subview: FilterView, name: \"body\" },\n            };\n        };\n        FilterPopup.prototype.Show = function (value, fields, at) {\n            var _this = this;\n            setTimeout(function () {\n                _this.getRoot().show(at);\n                _this.getSubView(\"body\").Show(value, fields);\n            }, 100);\n        };\n        return FilterPopup;\n    }(JetView));\n\n    var TopBarView = (function (_super) {\n        __extends(TopBarView, _super);\n        function TopBarView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TopBarView.prototype.config = function () {\n            var button = this.GetButton();\n            button.width = 100;\n            var list = this.GetList();\n            list.scroll = this.app.config.scroll !== false ? \"x\" : \"\";\n            list.borderless = true;\n            list.css = \"wbq-query_bar\";\n            var small = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n            var padding = 8, height = 58;\n            if (small) {\n                padding = 4;\n                height = 50;\n            }\n            if (list.scroll)\n                height += webix.env.scrollSize;\n            return {\n                view: \"toolbar\",\n                paddingX: padding * 2,\n                paddingY: padding,\n                height: height,\n                borderless: true,\n                cols: [list, button],\n            };\n        };\n        TopBarView.prototype.EditStart = function (id) {\n            var _this = this;\n            this.EditStop();\n            var list = this.$$(\"list\");\n            this.ActiveId = id;\n            this.Active = this.ui(FilterPopup);\n            this.Active.getRoot().attachEvent(\"onHide\", function () {\n                if (_this.Active)\n                    _this.EditStop();\n            });\n            var at = webix.html.offset(list.getItemNode(id));\n            this.Active.Show(list.getItem(id), this.app.config.fields, at);\n            this.CreateMode = false;\n        };\n        return TopBarView;\n    }(BaseView));\n\n    var TopListView = (function (_super) {\n        __extends(TopListView, _super);\n        function TopListView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TopListView.prototype.config = function () {\n            return {\n                paddingX: 16,\n                paddingY: 8,\n                margin: 0,\n                rows: [this.GetButton(), this.GetList()],\n            };\n        };\n        TopListView.prototype.EditStart = function (id) {\n            var _this = this;\n            if (this.ActiveId && this.ActiveId == id)\n                return;\n            this.EditStop();\n            var list = this.$$(\"list\");\n            var container = list.getItemNode(id);\n            container.classList.add(\"active-editor\");\n            container.innerHTML = \"\";\n            this.ActiveId = id;\n            this.Active = this.ui(FilterView, { container: container });\n            this.$$(\"list\").attachEvent(\"onAfterRender\", function () { return _this.EditStop(); });\n            this.Active.Show(list.getItem(id), this.app.config.fields);\n            this.CreateMode = false;\n        };\n        return TopListView;\n    }(BaseView));\n\n    var views = { JetView: JetView };\n    views[\"actions\"] = ActionsPopupView;\n    views[\"bar\"] = TopBarView;\n    views[\"base\"] = BaseView;\n    views[\"filter\"] = FilterView;\n    views[\"list\"] = TopListView;\n    views[\"popup\"] = FilterPopup;\n\n    var en = {\n        \"Add filter\": \"Add filter\",\n        in: \"=\",\n        equal: \"=\",\n        notEqual: \"<>\",\n        less: \"<\",\n        greater: \">\",\n        greaterOrEqual: \">=\",\n        lessOrEqual: \"<=\",\n        contains: \"contains\",\n        notContains: \"not contains\",\n        beginsWith: \"begins\",\n        notBeginsWith: \"not begings\",\n        endsWith: \"ends\",\n        notEndsWith: \"not ends\",\n        between: \"between\",\n        notBetween: \"not between\",\n        and: \"and\",\n        or: \"or\",\n        Edit: \"Edit\",\n        \"Add Filter\": \"Add Filter\",\n        \"Add Group\": \"Add Group\",\n        Delete: \"Delete\",\n        Apply: \"Apply\",\n        Cancel: \"Cancel\",\n    };\n\n    var Backend = (function () {\n        function Backend(app) {\n            this._app = app;\n        }\n        Backend.prototype.data = function (field) {\n            var data = this._app.config.data;\n            if (typeof data == \"function\")\n                return Promise.resolve(data(field)).then(function (a) {\n                    return a.map(function (b) {\n                        var _a;\n                        return (_a = {}, _a[field] = b, _a);\n                    });\n                });\n            return Promise.resolve(data);\n        };\n        Backend.prototype.save = function (v) {\n            console.log(v);\n        };\n        return Backend;\n    }());\n\n    function query(query, fields) {\n        var ops = webix.filters;\n        var types = {};\n        fields.forEach(function (a) {\n            if (a.conditions)\n                a.conditions.forEach(function (op) {\n                    if (typeof op === \"object\") {\n                        ops[op.id] = op.handler;\n                    }\n                });\n            if (a.type)\n                types[a.id] = a.type;\n        });\n        return queryToFilter(query, ops, types);\n    }\n    function queryToFilter(query, ops, types) {\n        if (!query || !query.rules.length)\n            return function () { return true; };\n        var filters = query.rules.map(function (a) { return singleFilter(a, ops, types); });\n        return (query.glue === \"or\" ? glueOr : glueAnd)(filters);\n    }\n    function glueAnd(f) {\n        return function (v) {\n            for (var i = 0; i < f.length; i++) {\n                if (!f[i](v))\n                    return false;\n            }\n            return true;\n        };\n    }\n    function glueOr(f) {\n        return function (v) {\n            for (var i = 0; i < f.length; i++) {\n                if (f[i](v))\n                    return true;\n            }\n            return false;\n        };\n    }\n    function singleFilter(rule, ops, types) {\n        if (rule.rules) {\n            return queryToFilter(rule, ops, types);\n        }\n        return function (v) {\n            var test = v[rule.field];\n            if (rule.includes && rule.includes.length) {\n                return rule.includes.findIndex(function (a) { return a === test; }) !== -1;\n            }\n            if (!webix.isUndefined(test)) {\n                var con = rule.condition.type;\n                var filter = ops[con] || ops[types[rule.field]][con];\n                return filter(test, rule.condition.filter);\n            }\n            return false;\n        };\n    }\n\n    var App = (function (_super) {\n        __extends(App, _super);\n        function App(config) {\n            var _this = this;\n            var state = createState({\n                value: config.value || null,\n            });\n            var defaults = {\n                router: EmptyRouter,\n                version: \"10.0.9\",\n                debug: true,\n            };\n            _this = _super.call(this, __assign(__assign({}, defaults), config)) || this;\n            _this.config.start = config.type === \"bar\" ? \"/bar\" : \"/list\";\n            _this.config.params = { state: state, simple: config.simple === true };\n            _this.setService(\"backend\", new (_this.dynamic(Backend))(_this));\n            _this.use(plugins.Locale, _this.config.locale || {\n                lang: \"en\",\n                webix: {\n                    en: \"en-US\",\n                },\n            });\n            return _this;\n        }\n        App.prototype.dynamic = function (obj) {\n            return this.config.override ? this.config.override.get(obj) || obj : obj;\n        };\n        App.prototype.require = function (type, name) {\n            if (type === \"jet-views\")\n                return views[name];\n            else if (type === \"jet-locales\")\n                return locales[name];\n            return null;\n        };\n        App.prototype.getState = function () {\n            return this.config.params.state;\n        };\n        App.prototype.GetFilter = function () {\n            return query(this.config.params.state.value, this.config.fields);\n        };\n        return App;\n    }(JetApp));\n    webix.protoUI({\n        name: \"query\",\n        app: App,\n        getState: function () {\n            return this.$app.getState();\n        },\n        getService: function (name) {\n            return this.$app.getService(name);\n        },\n        $init: function () {\n            var _this = this;\n            var state = this.getState();\n            for (var key in state) {\n                link(state, this.config, key);\n            }\n            state.$changes.attachEvent(\"value\", ignoreInitial(function (v, o) { return _this.callEvent(\"onChange\", v, o); }));\n        },\n        getFilterFunction: function () {\n            return this.$app.GetFilter();\n        },\n    }, webix.ui.jetapp);\n    var services = { Backend: Backend };\n    var locales = { en: en };\n\n    exports.App = App;\n    exports.locales = locales;\n    exports.services = services;\n    exports.views = views;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\nimport \"../../helpers/inputlist\";\nimport { removeRight } from \"../../helpers/icons\";\n\nexport default class CommonView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\n\t\tlet form = {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 130,\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Report name\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\t\tlocalId: \"name\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Description\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\t\tlabelPosition: \"top\",\n\t\t\t\t\t\t\theight: 150,\n\t\t\t\t\t\t\tname: \"desc\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Data source\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"combo\",\n\t\t\t\t\t\t\tname: \"data\",\n\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"input-list\",\n\t\t\t\t\tname: \"joins\",\n\t\t\t\t\ttemplate: this.JoinListTemplate.bind(this),\n\t\t\t\t\tdata: [],\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tonClick: {\n\t\t\t\t\t\twebix_rpt_action_remove: (ev, id) => this.RemoveJoin(id),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlocalId: \"add\",\n\t\t\t\t\tlabel: _(\"Join data\"),\n\t\t\t\t\tclick: () => this.ShowJoins(),\n\t\t\t\t},\n\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlabel: _(\"Delete report\"),\n\t\t\t\t\tlocalId: \"delete\",\n\t\t\t\t\tinputWidth: 170,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tcss: \"webix_rpt_delete\",\n\t\t\t\t\tclick: () => this.app.callEvent(\"onMenuAction\", [null, \"delete\"]),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn form;\n\t}\n\n\tinit() {\n\t\tconst els = this.getRoot().elements;\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.AppState = this.app.getParam(\"state\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Models = this.Local.getModels(true);\n\n\t\tconst keys = Object.keys(this.Models);\n\t\tconst combo = els.data;\n\t\tcombo.getList().parse(\n\t\t\tkeys.map(a => {\n\t\t\t\tconst m = this.Models[a];\n\t\t\t\treturn { id: m.id, value: m.name };\n\t\t\t})\n\t\t);\n\n\t\tbind(this.State, \"*\", this.getRoot(), this);\n\t\tthis.on(this.State.$changes, \"id\", v => this.ShowDeleteButton(v));\n\n\t\tthis.on(this.AppState.$changes, \"toolbar\", v => this.ShowDeleteButton(v));\n\n\t\tthis.SourcesList = this.ui({\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tautoheight: true,\n\t\t\t\ttype: {\n\t\t\t\t\ttemplate: this.JoinTemplate.bind(this),\n\t\t\t\t},\n\t\t\t\tclick: id => {\n\t\t\t\t\tconst item = this.SourcesList.getBody().getItem(id);\n\t\t\t\t\tthis.AddJoin(item);\n\t\t\t\t\tthis.SourcesList.hide();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\tAddJoin(item) {\n\t\tconst batch = this.Local.addJoin(item.tid, this.State);\n\t\tbatch.joins = [...this.State.joins, item];\n\t\tthis.State.$batch(batch);\n\t}\n\n\tRemoveJoin(id) {\n\t\tconst next = this.Local.cleanLinkedModels(id, this.State);\n\n\t\tif (!next.block) this.State.$batch(next);\n\t\telse {\n\t\t\tif (next.block.filter)\n\t\t\t\twebix.alert({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: this._(\"Please delete the related query filter first\"),\n\t\t\t\t});\n\t\t\tif (next.block.group)\n\t\t\t\twebix.alert({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: this._(\"Please delete the related group rule first\"),\n\t\t\t\t});\n\t\t}\n\t}\n\n\tJoinTemplate(obj) {\n\t\tconst s = this.Models[obj.sid];\n\t\tconst t = this.Models[obj.tid];\n\t\tconst f = obj.sf || obj.tf;\n\t\tconst n = (obj.sf ? s : t).data.find(a => a.id === f).name;\n\t\treturn `${t.name} <span class='webix_rpt_sources_path'>${s.name}${\n\t\t\tobj.sf ? ` (${n})` : \"\"\n\t\t} -> ${t.name}${obj.tf ? ` (${n})` : \"\"}</span>`;\n\t}\n\n\tJoinListTemplate(obj) {\n\t\treturn removeRight + this.JoinTemplate(obj);\n\t}\n\n\tShowJoins() {\n\t\tconst data = this.Local.getLinkedModels(\n\t\t\t[this.State.data].concat(this.State.joins.map(a => a.tid)),\n\t\t\ttrue\n\t\t);\n\t\tif (!data.length) return;\n\n\t\tconst list = this.SourcesList.getBody();\n\n\t\tlist.clearAll();\n\t\tlist.parse(data);\n\n\t\tthis.SourcesList.show(this.$$(\"add\").$view);\n\t}\n\n\tShowDeleteButton() {\n\t\tif (this.State.id && this.AppState.toolbar) this.$$(\"delete\").show();\n\t\telse this.$$(\"delete\").hide();\n\t}\n}\n","export function prompt(config, app) {\n\tconst result = new webix.promise.defer();\n\n\twebix\n\t\t.ui(\n\t\t\tapp.getService(\"jet-win\").updateConfig({\n\t\t\t\tview: \"window\",\n\t\t\t\thead: {\n\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\tpadding: { left: 12, right: 4 },\n\t\t\t\t\tborderless: true,\n\t\t\t\t\telements: [\n\t\t\t\t\t\t{ view: \"label\", label: config.text },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\tresult.reject(\"prompt cancelled\");\n\t\t\t\t\t\t\t\tthis.getTopParentView().close();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tbody: {\n\t\t\t\t\tview: \"form\",\n\t\t\t\t\tpadding: { top: 5, left: 20, right: 20, bottom: 20 },\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 10,\n\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\t\t\t\tvalue: config.value,\n\t\t\t\t\t\t\t\t\twidth: 230,\n\t\t\t\t\t\t\t\t\tcss: \"fm-prompt-input\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\t\tvalue: config.button,\n\t\t\t\t\t\t\t\t\twidth: 100,\n\t\t\t\t\t\t\t\t\thotkey: \"enter\",\n\t\t\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\t\t\tconst popup = this.getTopParentView();\n\t\t\t\t\t\t\t\t\t\tconst newname = popup.getBody().getValues().name;\n\t\t\t\t\t\t\t\t\t\tresult.resolve(newname);\n\t\t\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tonShow() {\n\t\t\t\t\t\tconst input = this.getBody().elements.name.getInputNode();\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tif (config.selectMask) config.selectMask(input);\n\t\t\t\t\t\telse input.select();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t})\n\t\t)\n\t\t.show();\n\n\treturn result;\n}\n","webix.protoUI(\n\t{\n\t\tname: \"query-select\",\n\t\t$cssName: \"richselect\",\n\n\t\t$init() {\n\t\t\twebix.extend(this.on_click, {\n\t\t\t\twebix_rpt_qselect_icon: function() {\n\t\t\t\t\tthis.callEvent(\"onClearClick\", []);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t},\n\twebix.ui.richselect\n);\n","import { JetView } from \"webix-jet\";\n\nimport \"@xbs/query/codebase/query\";\n\nexport default class QueryView extends JetView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tconst local = this.app.getService(\"local\");\n\n\t\treturn {\n\t\t\tview: \"query\",\n\t\t\tlocalId: \"query\",\n\t\t\tcss: \"webix_rpt_query\",\n\t\t\tlocale: { lang: this.app.getService(\"locale\").getLang() },\n\t\t\tdata: field => {\n\t\t\t\tconst column = this.State.fields.find(a => a.id === field);\n\t\t\t\tif (column.type === \"boolean\") return [0, 1];\n\t\t\t\treturn local.getFieldData(field, column.type);\n\t\t\t},\n\t\t\tfields: this.State.fields\n\t\t\t\t.filter(a => a.type !== \"reference\" && a.type !== \"picklist\")\n\t\t\t\t.map(a => {\n\t\t\t\t\tconst obj = {\n\t\t\t\t\t\tid: a.id,\n\t\t\t\t\t\tvalue:\n\t\t\t\t\t\t\ta.name +\n\t\t\t\t\t\t\t\" \" +\n\t\t\t\t\t\t\t(a.model\n\t\t\t\t\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + a.model + \"</span>\"\n\t\t\t\t\t\t\t\t: \"\"),\n\t\t\t\t\t\ttype: a.type,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (obj.type === \"boolean\") {\n\t\t\t\t\t\tobj.conditions = [\"equal\"];\n\t\t\t\t\t\tobj.type = \"number\";\n\t\t\t\t\t}\n\n\t\t\t\t\treturn obj;\n\t\t\t\t}),\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst query = this.getRoot();\n\n\t\tthis.on(this.State.$changes, \"query\", value => {\n\t\t\tquery.$app.callEvent(\"applyFilter\", [null]);\n\t\t\tquery.config.value = value ? fixDates(JSON.parse(value)) : null;\n\t\t});\n\t\tquery.getState().$observe(\"value\", v => {\n\t\t\tthis.State.query = v ? JSON.stringify(v) : \"\";\n\t\t});\n\t}\n}\n\nfunction fixDates(value) {\n\tif (value.rules) value.rules.forEach(fixDates);\n\telse {\n\t\tif (value.type === \"date\") {\n\t\t\tvar c = value.condition;\n\t\t\tif (c.filter && typeof value.condition.filter === \"string\")\n\t\t\t\tc.filter = new Date(c.filter);\n\t\t\tif (c.filter.start && typeof c.filter.start === \"string\")\n\t\t\t\tc.filter.start = new Date(c.filter.start);\n\t\t\tif (c.filter.end && typeof c.filter.end === \"string\")\n\t\t\t\tc.filter.end = new Date(c.filter.end);\n\t\t}\n\t}\n\n\treturn value;\n}\n","import { JetView } from \"webix-jet\";\nimport { createState } from \"jet-restate\";\nimport { bind } from \"jet-restate-bind\";\nimport { prompt } from \"../../helpers/prompt\";\nimport \"../../helpers/queryselect\";\n\nimport Query from \"./query\";\n\nexport default class QueryBuilderView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst querySelect = {\n\t\t\tlocalId: \"qblock\",\n\t\t\ttype: \"clean\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\ttype: \"form\",\n\t\t\t\t\tmargin: 5,\n\t\t\t\t\tpadding: { bottom: 5 },\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlocalId: \"queryBar\",\n\t\t\t\t\t\t\tvisibleBatch: \"def\",\n\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t{ view: \"label\", label: _(\"Filtering query\"), width: 120 },\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"delete\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-delete\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Delete\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.DeleteQuery(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"copy\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-content-copy\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Create copy\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.CopyQuery(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"rename\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-pencil\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Rename\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.RenameQuery(),\n\t\t\t\t\t\t\t\t},\n\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\t\t\t\t\tlocalId: \"save\",\n\t\t\t\t\t\t\t\t\tlabel: _(\"Save\"),\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Save query\"),\n\t\t\t\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\t\t\t\tclick: () => this.SaveQuery(null),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"query-select\",\n\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\tname: \"id\",\n\t\t\t\t\t\t\tcss: \"webix_rpt_qselect\",\n\t\t\t\t\t\t\tlocalId: \"qselect\",\n\t\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\t\tcss: \"webix_rpt_qselect_suggest\",\n\t\t\t\t\t\t\t\ttemplate: item => this.QSelectTemplate(item),\n\t\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\t\tminHeight: 25,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonShow: function() {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t!this.getBody().$view.firstChild.getAttribute(\n\t\t\t\t\t\t\t\t\t\t\t\t\"placeholder\"\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\tthis.getBody().$view.firstChild.setAttribute(\n\t\t\t\t\t\t\t\t\t\t\t\t\"placeholder\",\n\t\t\t\t\t\t\t\t\t\t\t\t_(\"No saved queries\")\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonClearClick: () => this.NewQuery(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\ttemplate: _(\"Save filter to use it in other reports\"),\n\t\t\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tQuery,\n\t\t\t],\n\t\t};\n\n\t\treturn querySelect;\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Operations = this.app.getService(\"operations\");\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\t\tconst qData = (this.Queries = this.Local.getQueries());\n\n\t\tthis.LocalState = createState({ id: \"\", saved: true });\n\n\t\tqData.waitData.then(() => {\n\t\t\tconst now = this.State.query;\n\t\t\tconst ctrl = this.$$(\"qselect\");\n\t\t\tconst list = ctrl.getList();\n\n\t\t\tconst tables = { [this.State.data]: 1 };\n\t\t\tthis.State.joins.forEach(a => (tables[a.tid] = 1));\n\n\t\t\tqData.filter(a => {\n\t\t\t\tlet res = true;\n\t\t\t\ta.models.forEach(m => {\n\t\t\t\t\tif (!tables[m]) res = false;\n\t\t\t\t});\n\t\t\t\treturn res;\n\t\t\t});\n\t\t\tlist.sync(qData);\n\n\t\t\tqData.data.each(v => {\n\t\t\t\tif (v.text == now) ctrl.setValue(v.id);\n\t\t\t});\n\n\t\t\tthis.on(state.$changes, \"query\", v => {\n\t\t\t\tconst id = this.LocalState.id;\n\t\t\t\tconst changed = (!id && v) || (id && qData.getItem(id).text != v);\n\t\t\t\tthis.LocalState.saved = !changed;\n\t\t\t});\n\t\t});\n\n\t\tbind(this.LocalState, \"id\", this.$$(\"qselect\"), this);\n\n\t\tconst saveBtn = this.$$(\"save\");\n\t\tthis.on(this.LocalState.$changes, \"saved\", v => {\n\t\t\tif (v) saveBtn.disable();\n\t\t\telse saveBtn.enable();\n\t\t});\n\n\t\tthis.on(this.LocalState.$changes, \"id\", v => {\n\t\t\tif (v) {\n\t\t\t\tconst item = qData.getItem(v);\n\t\t\t\tthis.State.query = item.text;\n\t\t\t\tthis.$$(\"queryBar\").showBatch(\"query\");\n\t\t\t} else {\n\t\t\t\tthis.$$(\"queryBar\").showBatch(\"def\");\n\t\t\t}\n\t\t});\n\t}\n\n\tNewQuery() {\n\t\tthis.LocalState.id = null;\n\t\tthis.LocalState.saved = true;\n\t\tthis.State.query = null;\n\t}\n\n\tSaveQuery(name) {\n\t\tconst id = this.LocalState.id;\n\t\tconst text = this.State.query;\n\n\t\tif (id) {\n\t\t\tif (name === null) name = this.Queries.getItem(id).name;\n\t\t\tthis.Operations.updateQuery(id, { name, text }).then(() => {\n\t\t\t\tthis.$$(\"qselect\").setValue(id);\n\t\t\t\tthis.LocalState.saved = true;\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tprompt(\n\t\t\t{\n\t\t\t\ttext: this._(\"Enter query name\"),\n\t\t\t\tbutton: this._(\"Save\"),\n\t\t\t\tvalue: \"\",\n\t\t\t},\n\t\t\tthis.app\n\t\t).then(name => {\n\t\t\tif (name) {\n\t\t\t\tthis.Operations.addQuery({ name, text }).then(id => {\n\t\t\t\t\tthis.LocalState.saved = true;\n\t\t\t\t\tthis.LocalState.id = id;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tRenameQuery() {\n\t\tconst id = this.LocalState.id;\n\t\tconst { name } = this.Queries.getItem(id);\n\n\t\tprompt(\n\t\t\t{\n\t\t\t\ttext: this._(\"Enter query name\"),\n\t\t\t\tvalue: name,\n\t\t\t\tbutton: this._(\"Save\"),\n\t\t\t},\n\t\t\tthis.app\n\t\t).then(name => {\n\t\t\tif (!name) return;\n\n\t\t\tthis.SaveQuery(name);\n\t\t});\n\t}\n\n\tCopyQuery() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tlet { name, text } = this.Queries.getItem(this.LocalState.id);\n\t\tname = _(\"Copy of\") + \" \" + name;\n\t\tthis.Operations.addQuery({ name, text }).then(id => {\n\t\t\tthis.LocalState.id = id;\n\t\t});\n\t}\n\n\tDeleteQuery() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\twebix\n\t\t\t.confirm({\n\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\ttitle: _(\"Delete\"),\n\t\t\t\tok: _(\"Delete\"),\n\t\t\t\tcancel: _(\"Cancel\"),\n\t\t\t\ttext: _(\"Are you sure to delete this query?\"),\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tconst id = this.LocalState.id;\n\t\t\t\tthis.Operations.deleteQuery(id).then(() => {\n\t\t\t\t\tthis.LocalState.$batch({ saved: true, id: null });\n\t\t\t\t\tthis.State.query = null;\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tGetMenuOptions() {\n\t\treturn [\n\t\t\t{ id: \"copy\", value: \"Copy\", icon: \"rpi-content-copy\" },\n\t\t\t{ id: \"rename\", value: \"Rename\", icon: \"rpi-pencil\" },\n\t\t\t{ id: \"delete\", value: \"Delete\", icon: \"rpi-delete\" },\n\t\t];\n\t}\n\n\tGetMenuTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span>${obj.value}`;\n\t}\n\n\tApplyQueryAction(id) {\n\t\tthis.QueryMenu.hide();\n\t\tswitch (id) {\n\t\t\tcase \"rename\":\n\t\t\t\tthis.RenameQuery();\n\t\t\t\tbreak;\n\t\t\tcase \"copy\":\n\t\t\t\tthis.CopyQuery();\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\t\tthis.DeleteQuery();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tQSelectTemplate(obj) {\n\t\treturn `${obj.value} <span class='webix_icon wxi-close webix_rpt_qselect_icon'></span>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { withContext, createState, debounce } from \"jet-restate\";\n\nexport default class TopView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst tabbar = {\n\t\t\toptionWidth: 102,\n\t\t\ttabMinWidth: 102,\n\t\t\tview: \"tabbar\",\n\t\t\tlocalId: \"tabbar\",\n\t\t\tcss: \"webix_rpt_editor_tabbar\",\n\t\t\tborderless: true,\n\t\t\toptions: [\n\t\t\t\t{ id: \"common\", value: _(\"Common\") },\n\t\t\t\t{ id: \"data\", value: _(\"Query\") },\n\t\t\t\t{ id: \"other\", value: _(\"Data\") },\n\t\t\t\t{ id: \"structure\", value: _(\"View\") },\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: v => this.ShowView(v),\n\t\t\t},\n\t\t};\n\n\t\tconst skin = webix.skin.$name;\n\t\tif (skin == \"flat\" || skin == \"compact\" || skin == \"contrast\")\n\t\t\ttabbar.type = \"bottom\";\n\n\t\tconst toolbar = {\n\t\t\tview: \"toolbar\",\n\t\t\tpadding: { left: 13, top: 0, bottom: 0 },\n\t\t\t//padding: { left: 13, top: webix.skin.$active.layoutPadding.toolbar, bottom: webix.skin.$active.layoutPadding.toolbar },\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\tscroll: false,\n\t\t\tcols: [\n\t\t\t\ttabbar,\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\twidth: 40,\n\t\t\t\t\tlocalId: \"closeBtn\",\n\t\t\t\t\ticon: \"rpi-close\",\n\t\t\t\t\tclick: () => this.Hide(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst ui = {\n\t\t\twidth: 490,\n\t\t\thidden: false,\n\t\t\tlocalId: \"settings\",\n\t\t\trows: [toolbar, { $subview: true }],\n\t\t};\n\n\t\tthis.Operations = this.app.getService(\"operations\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\treturn this.Local.ready(ui);\n\t}\n\n\tinit() {\n\t\tthis.AppState = this.app.getParam(\"state\");\n\n\t\tconst initial = this.Local.newModule();\n\t\tinitial.id = -1; // mark as temporary\n\n\t\tconst state = (this.State = createState(initial));\n\t\tthis.setParam(\"state\", this.State);\n\n\t\tthis.on(this.AppState.$changes, \"moduleId\", v => this.ChangeModule(v));\n\t\tthis.on(this.State.$changes, \"data\", (id, o, k, ctx) => {\n\t\t\tif (id && (!ctx || !ctx.load)) this.ChangeModel(id);\n\t\t});\n\n\t\tthis.on(this.AppState.$changes, \"toolbar\", v => this.ShowHideButton(v));\n\n\t\tthis.on(\n\t\t\tthis.State.$changes,\n\t\t\t\"*\",\n\t\t\tdebounce(() => {\n\t\t\t\tif (this.State.id === -1) return;\n\n\t\t\t\tthis.TrackChanges();\n\t\t\t\tthis.AppState.module = Object.assign({}, this.State);\n\t\t\t})\n\t\t);\n\n\t\tthis.on(state.$changes, \"group\", (v, old, _key, ctx) => {\n\t\t\tif (!v && old) {\n\t\t\t\t// revert back\n\t\t\t\tconst columns =\n\t\t\t\t\tstate.oldColumns ||\n\t\t\t\t\tthis.Local.getFields(state.data, state.joins, true);\n\t\t\t\tconst numColumns = webix\n\t\t\t\t\t.copy(columns)\n\t\t\t\t\t.filter(a => a.type == \"number\" && !a.key);\n\t\t\t\tconst meta = this.UpdateMeta(numColumns, columns);\n\t\t\t\tstate.$batch({\n\t\t\t\t\tpublicFields: null,\n\t\t\t\t\tcolumns,\n\t\t\t\t\tmeta,\n\t\t\t\t});\n\t\t\t} else if (v) {\n\t\t\t\tlet prev = [];\n\t\t\t\tif (!ctx || !ctx.load) {\n\t\t\t\t\tif (!old) state.oldColumns = state.columns;\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (JSON.stringify(v) == JSON.stringify(old)) return;\n\t\t\t\t\t\tprev = [...this.State.columns];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tprev = [...this.State.columns];\n\t\t\t\t}\n\n\t\t\t\t// group mode changed, add new columns\n\t\t\t\tlet columns = v.columns.map(a => ({\n\t\t\t\t\tid: `${a.op}.${a.id}`,\n\t\t\t\t\tname: a.name,\n\t\t\t\t\ttype: \"number\",\n\t\t\t\t\tmeta: {},\n\t\t\t\t\tmodel: \"\",\n\t\t\t\t}));\n\t\t\t\tconst groupColumns = webix.copy(columns);\n\t\t\t\tif (v.by)\n\t\t\t\t\tcolumns = columns.concat(\n\t\t\t\t\t\tv.by.map(a => {\n\t\t\t\t\t\t\tconst base = this.State.fields.find(b => b.id == a.id);\n\t\t\t\t\t\t\tconst id = a.mod ? `${a.mod}.${a.id}` : a.id;\n\t\t\t\t\t\t\tconst obj = { ...base, id };\n\t\t\t\t\t\t\tif (a.mod) obj.type = \"text\";\n\n\t\t\t\t\t\t\treturn obj;\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t// apply modifications\n\t\t\t\tconst was = {};\n\t\t\t\t(state.publicFields || state.columns).forEach(a => (was[a.id] = 1));\n\t\t\t\tconst now = {};\n\t\t\t\t// add new / rename\n\t\t\t\tcolumns.forEach(a => {\n\t\t\t\t\tnow[a.id] = 1;\n\t\t\t\t\tif (!was[a.id]) prev.push(a);\n\t\t\t\t\telse {\n\t\t\t\t\t\t// rename a column if needed\n\t\t\t\t\t\tlet column = prev.find(b => b.id == a.id);\n\t\t\t\t\t\tif (column && column.name != a.name) column.name = a.name;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t//remove old\n\t\t\t\tprev = prev.filter(a => now[a.id]);\n\n\t\t\t\tconst meta = this.UpdateMeta(groupColumns, columns);\n\t\t\t\tif (meta.freeze && meta.freeze >= prev.length) delete meta.freeze;\n\t\t\t\tstate.$batch({ publicFields: columns, columns: prev, meta });\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.app, \"saveModule\", () => this.Save());\n\n\t\tthis.on(this.app, \"resetModule\", () => this.Reset());\n\n\t\tthis.on(this.app, \"onColumnResize\", (id, width) => {\n\t\t\tvar next = [...this.State.columns];\n\t\t\tnext.find(a => a.id == id).width = width;\n\t\t\tthis.State.columns = next;\n\t\t});\n\n\t\tthis.on(this.AppState.$changes, \"readonly\", mod => {\n\t\t\tif (mod) this.Reset();\n\t\t});\n\n\t\tthis.show(\"./editor.common\");\n\t}\n\n\tSave() {\n\t\tconst save = this.Operations.getModuleSaveData(this.State);\n\t\tconst data = {\n\t\t\tname: this.State.name,\n\t\t\ttext: JSON.stringify(save),\n\t\t};\n\n\t\tif (this.AppState.moduleId)\n\t\t\tthis.Operations.updateModule(this.AppState.moduleId, data).then(id =>\n\t\t\t\tthis.SaveCallback(id)\n\t\t\t);\n\t\telse this.Operations.addModule(data).then(id => this.SaveCallback(id));\n\t}\n\tSaveCallback(id) {\n\t\tthis.AppState.$batch({\n\t\t\tmoduleId: id,\n\t\t\tmode: \"view\",\n\t\t\tmodule: Object.assign({}, this.AppState.module),\n\t\t\tsaved: true,\n\t\t});\n\t}\n\n\tShowView(v) {\n\t\tthis.$$(\"tabbar\").setValue(v);\n\t\tthis.show(\"editor.\" + v);\n\t}\n\n\tHide() {\n\t\tthis.Reset();\n\t}\n\n\tReset() {\n\t\tconst id = this.AppState.moduleId;\n\t\tif (!id) {\n\t\t\tthis.AppState.$batch({ mode: \"list\", module: null, saved: true });\n\t\t} else\n\t\t\tthis.Local.getModule(id).then(mod => {\n\t\t\t\tthis.AppState.$batch({\n\t\t\t\t\tmode: \"view\",\n\t\t\t\t\tmodule: Object.assign({}, JSON.parse(mod.text)),\n\t\t\t\t\tsaved: true,\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tChangeModel(id) {\n\t\tif (id) this.State.$batch(this.Local.setDataSource(id));\n\t}\n\n\tChangeModule(id) {\n\t\tthis.InitStateValue = \"\";\n\t\tif (id) {\n\t\t\tthis.Local.getModule(id).then(item => {\n\t\t\t\tconst obj = JSON.parse(item.text);\n\n\t\t\t\tthis.InitStateValue = item.text;\n\t\t\t\tthis.InitName = obj.name = item.name;\n\n\t\t\t\tobj.id = item.id;\n\t\t\t\tobj.saved = true;\n\t\t\t\tobj.fields = this.Local.getFields(obj.data, obj.joins);\n\n\t\t\t\twithContext({ load: true }, () => this.State.$batch(obj));\n\t\t\t\tthis.AppState.saved = true;\n\t\t\t});\n\t\t} else {\n\t\t\tthis.InitStateValue = null; // we need to have an always active Save button\n\t\t\tthis.State.$batch(this.Local.newModule());\n\t\t\tthis.State.fields = this.Local.getFields(\n\t\t\t\tthis.State.data,\n\t\t\t\tthis.State.joins\n\t\t\t);\n\t\t\tthis.AppState.saved = false;\n\t\t}\n\t}\n\tTrackChanges() {\n\t\tthis.AppState.saved =\n\t\t\tJSON.stringify(this.Operations.getModuleSaveData(this.State)) ==\n\t\t\t\tthis.InitStateValue && this.State.name == this.InitName;\n\t}\n\n\tShowHideButton(v) {\n\t\tif (v) this.$$(\"closeBtn\").show();\n\t\telse this.$$(\"closeBtn\").hide();\n\t}\n\n\tUpdateMeta(numColumns, columns) {\n\t\tlet meta = this.State.meta;\n\t\tconst state = this.State;\n\t\tif (numColumns.length) {\n\t\t\tif (state.type == \"chart\") {\n\t\t\t\tnumColumns = numColumns.map(a => {\n\t\t\t\t\tconst c = { ...a, value: a.name };\n\t\t\t\t\tdelete c.name;\n\t\t\t\t\treturn c;\n\t\t\t\t});\n\t\t\t\tmeta.chart.series = this.app\n\t\t\t\t\t.getService(\"charts\")\n\t\t\t\t\t.getSeries(numColumns, state.chartType);\n\t\t\t} else if (state.type == \"heatmap\") {\n\t\t\t\tmeta.value = numColumns[0].id;\n\t\t\t\tmeta.label = state.publicFields\n\t\t\t\t\t? columns[columns.length - 1].id\n\t\t\t\t\t: columns[0].id;\n\t\t\t\tif (meta.color && !numColumns.find(a => a.id == meta.color))\n\t\t\t\t\tmeta.color = numColumns[0].id;\n\t\t\t}\n\t\t}\n\t\treturn meta;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class SummaryPopupView extends JetView {\n\tconstructor(app, masterName) {\n\t\tsuper(app);\n\t\tthis.Name = masterName;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\tclick: id => {\n\t\t\t\t\tthis.ClickHandler(id);\n\t\t\t\t\tthis.getRoot().close();\n\t\t\t\t},\n\t\t\t\tdata: this.GetOptions(),\n\t\t\t},\n\t\t};\n\t}\n\n\tClickHandler(id) {\n\t\tthis.getParentView().ApplyAction(id);\n\t}\n\tShow(node, data, index) {\n\t\tthis.SetActionStates(data, index);\n\t\tthis.getRoot().show(node);\n\t}\n\tGetOptions() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [{ id: \"delete\", value: _(\"Delete\"), icon: \"rpi-delete\" }];\n\t}\n\tSetActionStates(data) {\n\t\tconst popup = this.getRoot();\n\t\tconst list = popup.getBody();\n\t\tlist.data.each(action => {\n\t\t\tif (data.length == 1) list.disableItem(action.id);\n\t\t\telse list.enableItem(action.id);\n\t\t});\n\t}\n\tGetTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span> ${obj.value}`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Popup from \"./summarypopup\";\n\nexport default class BucketView extends JetView {\n\tconstructor(app, state, pstate) {\n\t\tsuper(app);\n\t\tthis.State = state;\n\t\tthis.ParentState = pstate;\n\t}\n\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.ValueSeparator = \",\";\n\t\tconst inputs = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tpadding: { top: 0, bottom: 0, left: 0, right: 0 },\n\t\t\tlocalId: \"forms\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\telements: [],\n\t\t};\n\t\tconst other = {\n\t\t\tlocalId: \"other\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tname: \"name\",\n\t\t\t\t\twidth: 150,\n\t\t\t\t\tplaceholder: _(\"Bucket name\"),\n\t\t\t\t\tvalue: _(\"Other\"),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.Changed(\"other\", \"name\", v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\tlabel: _(\"Other values\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\trules: {\n\t\t\t\tname: webix.rules.isNotEmpty,\n\t\t\t},\n\t\t};\n\t\tconst padding = webix.skin.$active.layoutPadding.form;\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\t\t\tpadding: { top: padding, bottom: padding, left: 0, right: 0 },\n\t\t\tcss: \"webix_rpt_subview\",\n\t\t\trows: [\n\t\t\t\tinputs,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\tother,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\tlabel: _(\"Add bucket\"),\n\t\t\t\t\tinputWidth: 210,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tclick: () => this.AddNewBucket(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Forms = this.$$(\"forms\");\n\t\tthis.GetRowKeys(this.State.id).then(data => {\n\t\t\tthis.Data = data.sort((a, b) => this.Sort(a, b));\n\t\t\tthis.CreateForm();\n\t\t});\n\t\tthis.on(this.app, \"onAction\", (name, action, id) => {\n\t\t\tif (name == \"bucket\" && action == \"focus\" && id == this.State.id)\n\t\t\t\tthis.Focus(0);\n\t\t});\n\t}\n\t/*\n\t * Gets row keys (requires data loading)\n\t * params:\n\t * - the field / column id where keys need to be found\n\t * Returns a promise\n\t * */\n\tGetRowKeys(base) {\n\t\tif (base && this.ParentState.columns.length) {\n\t\t\tlet keys = [];\n\t\t\treturn this.GetColumnData(base).then(([data, baseOptions]) => {\n\t\t\t\tdata.forEach(row => {\n\t\t\t\t\tconst key = row[base];\n\t\t\t\t\tif (keys.indexOf(key) == -1) keys.push(key);\n\t\t\t\t});\n\n\t\t\t\tif (baseOptions)\n\t\t\t\t\treturn keys.map(key => {\n\t\t\t\t\t\tconst keyOption =\n\t\t\t\t\t\t\tbaseOptions.data.find(option => option.id == key) || null;\n\t\t\t\t\t\treturn { id: key, value: keyOption ? keyOption.value : key };\n\t\t\t\t\t});\n\t\t\t\treturn keys.map(key => ({ id: key, value: key }));\n\t\t\t});\n\t\t} else return Promise.resolve([]);\n\t}\n\tGetColumnData(baseColumn) {\n\t\tconst appState = this.app.getParam(\"state\");\n\t\tlet moduleConfig = this.Local.getDataConfig(appState.module);\n\t\tmoduleConfig.columns = [baseColumn];\n\t\tdelete moduleConfig.buckets;\n\t\tdelete moduleConfig.group;\n\t\tlet waitData = [\n\t\t\tthis.Local.getData(moduleConfig),\n\t\t\tthis.Local.getOptionsList(baseColumn),\n\t\t];\n\t\treturn Promise.all(waitData);\n\t}\n\n\tCreateForm() {\n\t\tconst options = this.State.options;\n\t\tif (options && options.length) this.LoadBuckets(options);\n\t\telse this.AddNewBucket();\n\t\twebix.delay(() => {\n\t\t\tthis.app.callEvent(\"onAction\", [\"bucket\", \"resize\", this.State.id]);\n\t\t\tthis.Focus(0);\n\t\t});\n\t}\n\n\tAddNewBucket() {\n\t\tthis.AddBucket();\n\t\tthis.Changed();\n\t\tthis.Focus();\n\t}\n\n\tLoadBuckets(data) {\n\t\tdata.forEach(bucket => {\n\t\t\tif (!bucket.values) this.LoadOther(bucket);\n\t\t\telse this.AddBucket(bucket);\n\t\t});\n\t\tthis.Changed();\n\t}\n\tLoadOther(b) {\n\t\tconst other = this.$$(\"other\");\n\t\tother.setValues({ name: b.id });\n\t}\n\tAddBucket(bucket) {\n\t\tbucket = bucket || {};\n\t\tthis.Forms.addView(this.GetRowForm(webix.uid(), bucket));\n\t}\n\n\tGetRowForm(id, data) {\n\t\tlet cols = [\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\tvalue: data.id || null,\n\t\t\t\t\t\tplaceholder: this._(\"Bucket name\"),\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: v => this.Changed(id, \"name\", v),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"multicombo\",\n\t\t\t\tname: \"values\",\n\t\t\t\tplaceholder: this._(\"Bucket values\"),\n\t\t\t\tcss: \"webix_multilist webix_rpt_multicombo\",\n\t\t\t\tseparator: this.ValueSeparator,\n\t\t\t\tsuggest: {\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcss: \"webix_multilist webix_rpt_bucket_values\",\n\t\t\t\t\t\tdata: this.Data,\n\t\t\t\t\t\ttemplate: obj => this.OptionTemplate(id, obj),\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonBeforeShow: function() {\n\t\t\t\t\t\t\tthis.getList().refresh();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tvalue: data.values || null,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"values\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\ticon: \"wxi-dots\",\n\t\t\t\t\t\tclick: (id, ev) => this.ShowPopup(id, ev),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: id,\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\trules: {\n\t\t\t\tname: webix.rules.isNotEmpty,\n\t\t\t\tvalues: webix.rules.isNotEmpty,\n\t\t\t},\n\t\t\tcols: cols,\n\t\t};\n\t}\n\tShowPopup(id, ev) {\n\t\tif (!this.Popup || !this.Popup.$view)\n\t\t\tthis.Popup = this.ui(new Popup(this.app, \"bucket\"));\n\t\tconst form = webix\n\t\t\t.$$(id)\n\t\t\t.getParentView()\n\t\t\t.getParentView();\n\t\tthis.ActiveForm = form;\n\t\tthis.Popup.Show(\n\t\t\tev.target,\n\t\t\tthis.GetValues(),\n\t\t\tform.getParentView().index(form)\n\t\t);\n\t}\n\tGetValidBuckets() {\n\t\tconst otherForm = this.$$(\"other\");\n\t\tconst otherName = otherForm.elements.name.getValue();\n\t\totherForm.validate();\n\t\tconst names = {};\n\t\tif (otherName) names[otherName] = [otherForm];\n\t\tconst options = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tform.validate();\n\t\t\tlet values = form.getValues();\n\t\t\tlet n = values.name;\n\t\t\tif (n) {\n\t\t\t\tif (names[n]) {\n\t\t\t\t\tthis.$$(names[n]).forEach(f => f.markInvalid(\"name\", true));\n\t\t\t\t\tform.markInvalid(\"name\", true);\n\t\t\t\t} else if (values.values.length)\n\t\t\t\t\toptions.push({ id: n, values: values.values.split(\",\") });\n\t\t\t\tif (!names[n]) names[n] = [];\n\t\t\t\tnames[n].push(form);\n\t\t\t}\n\t\t});\n\t\tif (options.length && otherName) options.push({ id: otherName });\n\t\treturn options;\n\t}\n\tChanged(id, name, value) {\n\t\tif (name == \"values\") this.CorrectValues(id, value);\n\t\tconst options = this.GetValidBuckets();\n\t\tthis.State.options = options;\n\t}\n\n\tOptionTemplate(id, obj) {\n\t\tlet selected =\n\t\t\t!obj.$checked &&\n\t\t\tthis.GetValues().find(\n\t\t\t\tbucket => bucket.id != id && bucket.values.indexOf(obj.value) > -1\n\t\t\t);\n\t\tconst css =\n\t\t\t\"webix_rpt_bucket_value\" +\n\t\t\t(selected ? \" webix_rpt_bucket_value_selected\" : \"\");\n\t\treturn (\n\t\t\t\"<div class='\" +\n\t\t\tcss +\n\t\t\t\"'>\" +\n\t\t\tobj.value +\n\t\t\t\"</div>\" +\n\t\t\t(selected\n\t\t\t\t? \"<span class='webix_rpt_bucket_icon webix_icon rpi-pail-outline'></span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\tGetValues() {\n\t\tlet data = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tconst v = form.getValues();\n\t\t\tv.id = form.config.localId;\n\t\t\tdata.push(v);\n\t\t});\n\t\treturn data;\n\t}\n\tForEachFormRow(handler) {\n\t\tthis.Forms.getChildViews().forEach(form => {\n\t\t\tif (form && form.elements) {\n\t\t\t\thandler(form);\n\t\t\t}\n\t\t});\n\t}\n\tCorrectValues(id, v) {\n\t\tthis.ForEachFormRow(form => {\n\t\t\tif (form.config.localId != id) {\n\t\t\t\tlet values = form.getValues().values.split(\",\");\n\t\t\t\tvalues = values.filter(a => v.indexOf(a) == -1);\n\t\t\t\tform.elements.values.setValue(values);\n\t\t\t}\n\t\t});\n\t}\n\tApplyAction(id) {\n\t\tif (id == \"delete\") this.DeleteBucket(this.ActiveForm);\n\t}\n\n\tDeleteBucket(form) {\n\t\tthis.Forms.removeView(form);\n\t\tthis.Changed();\n\t}\n\tSort(a, b) {\n\t\tconst type = this.ParentState.fields.find(c => c.id == this.State.id).type;\n\t\ta = a.value;\n\t\tb = b.value;\n\t\tif (type == \"number\") {\n\t\t\ta = a * 1;\n\t\t\tb = b * 1;\n\t\t\tif (isNaN(b)) return 1;\n\t\t\tif (isNaN(a)) return -1;\n\t\t} else {\n\t\t\tif (!b) return 1;\n\t\t\tif (!a) return -1;\n\t\t\ta = a.toString().toLowerCase();\n\t\t\tb = b.toString().toLowerCase();\n\t\t}\n\t\treturn a > b ? 1 : a < b ? -1 : 0;\n\t}\n\tFocus(index) {\n\t\twebix.delay(\n\t\t\t() => {\n\t\t\t\tconst forms = this.Forms.getChildViews();\n\t\t\t\tif (typeof index == \"undefined\") index = forms.length - 1;\n\t\t\t\tconst form = forms[index];\n\t\t\t\tif (form) form.elements.name.focus();\n\t\t\t},\n\t\t\tnull,\n\t\t\tnull,\n\t\t\t100\n\t\t);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class SummaryPopupView extends JetView {\n\tconstructor(app, master) {\n\t\tsuper(app);\n\t\tthis.Master = master;\n\t}\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tautoheight: true,\n\t\t\tfitMaster: true,\n\t\t\tbody: {\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tpadding: { top: 5, bottom: 5, left: 10, right: 10 },\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\t\t\t\tplaceholder: _(\"Search\"),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"list\",\n\t\t\t\t\t\tscroll: true,\n\t\t\t\t\t\tyCount: 5,\n\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\ttype: {\n\t\t\t\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\t\t\tconst item = this.List.getItem(id);\n\t\t\t\t\t\t\t\tthis.AddColumn(item);\n\t\t\t\t\t\t\t\tthis.View.hide();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonEnter: () => {\n\t\t\t\t\t\t\t\tconst item = this.List.getSelectedItem();\n\t\t\t\t\t\t\t\tif (item) {\n\t\t\t\t\t\t\t\t\tthis.AddColumn(item);\n\t\t\t\t\t\t\t\t\twebix.delay(() => this.View.hide());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.View = this.getRoot();\n\t\tconst views = this.View.getBody().getChildViews();\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.BucketState = this.getParam(\"buckets\", true);\n\t\tthis.Text = views[0].getChildViews()[0];\n\t\tthis.List = views[1];\n\t\tthis.Text.attachEvent(\"onTimedKeyPress\", () => {\n\t\t\tthis.Find(this.Text.getValue());\n\t\t});\n\t}\n\tAddColumn(column) {\n\t\tconst t = [...this.BucketState.buckets];\n\t\tt.push({ column: column.id, options: [] });\n\t\tthis.BucketState.buckets = t;\n\t}\n\tShow(node) {\n\t\tnode = node.firstChild.firstChild;\n\t\tthis.View.config.width = node.offsetWidth - 2;\n\t\tthis.View.adjust();\n\t\tthis.View.show(node);\n\t\tthis.Text.focus();\n\t\tthis.List.clearAll();\n\t\tthis.List.parse(this.GetColumns());\n\t}\n\tGetColumns() {\n\t\tlet columns = this.State.fields;\n\t\tif (this.State.publicFields)\n\t\t\tcolumns = columns.filter(a =>\n\t\t\t\tthis.State.publicFields.find(b => b.id == a.id)\n\t\t\t);\n\t\treturn columns.map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t\tdisabled:\n\t\t\t\tthis.BucketState.buckets &&\n\t\t\t\tthis.BucketState.buckets.find(b => b.column == a.id),\n\t\t}));\n\t}\n\n\tGetTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tFind(value) {\n\t\tvalue = value.toLowerCase();\n\t\tif (value)\n\t\t\tthis.List.filter(item => item.value.toLowerCase().indexOf(value) > -1);\n\t\telse this.List.filter(\"\");\n\t}\n}\n","webix.protoUI(\n\t{\n\t\tname: \"groupselect\",\n\t\t$cssName: \"text webix_rpt_groupselect\",\n\t\tdefaults: {\n\t\t\tselectIcon: true,\n\t\t\tmodifiers: {},\n\t\t},\n\t\trenderModifier(id) {\n\t\t\tconst mid = this._modifiers[id];\n\t\t\tif (mid) {\n\t\t\t\tconst option = this.config.modifiers.find(a => a.id === mid);\n\t\t\t\treturn (\n\t\t\t\t\t\"<div class='webix_rpt_date_selector'>\" +\n\t\t\t\t\t(option ? option.value : \"\") +\n\t\t\t\t\t(this.config.selectIcon\n\t\t\t\t\t\t? \"<span class='webix_icon wxi-angle-down'></span>\"\n\t\t\t\t\t\t: \"\") +\n\t\t\t\t\t\"</div> <span class='webix_rpt_groupselect_sep'> | </span> \"\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\t$renderTag(text, width, height, value) {\n\t\t\tlet content = this.renderModifier(value);\n\t\t\tcontent +=\n\t\t\t\t\"<span>\" +\n\t\t\t\ttext +\n\t\t\t\t\"</span><span class='webix_multicombo_delete webix_rpt_groupselect_delete' role='button' aria-label='\" +\n\t\t\t\twebix.i18n.aria.removeItem +\n\t\t\t\t\"'></span>\";\n\t\t\treturn (\n\t\t\t\t\"<li class='webix_multicombo_value' style='line-height:\" +\n\t\t\t\theight +\n\t\t\t\t\"px;' optvalue='\" +\n\t\t\t\twebix.template.escape(value) +\n\t\t\t\t\"'>\" +\n\t\t\t\tcontent +\n\t\t\t\t\"</li>\"\n\t\t\t);\n\t\t},\n\t\t$init() {\n\t\t\tthis._modifiers = {};\n\t\t\twebix.extend(this.on_click, {\n\t\t\t\twebix_rpt_date_selector: function(e, id, node) {\n\t\t\t\t\tlet value = webix.html.locate(e, \"optvalue\");\n\t\t\t\t\tthis.callEvent(\"onModifierClick\", [value, e, node]);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tsetValue(value) {\n\t\t\tif (value) {\n\t\t\t\tif (typeof value !== \"string\" && typeof value[0] !== \"string\") {\n\t\t\t\t\tthis._modifiers = {};\n\t\t\t\t\tvalue = value.map(a => {\n\t\t\t\t\t\tthis._modifiers[a.id] = a.mod || null;\n\t\t\t\t\t\treturn a.id;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\twebix.ui.multicombo.prototype.setValue.call(this, value);\n\t\t\t} else {\n\t\t\t\tthis._modifiers = {};\n\t\t\t}\n\n\t\t\treturn webix.ui.multicombo.prototype.setValue.call(this, value);\n\t\t},\n\t\tgetModifier(id) {\n\t\t\treturn this._modifiers[id];\n\t\t},\n\t\tsetModifier(id, value, silent) {\n\t\t\tthis._modifiers[id] = value;\n\t\t\tif (!silent) this.callEvent(\"onChange\", []);\n\t\t\tthis.refresh();\n\t\t},\n\t\t// [FIXME] bug in multicombo repainting during view replacing\n\t\t$setSize: function(x, y) {\n\t\t\tvar config = this.config;\n\n\t\t\tconst [px, py] = this._custom_last_size || [0, 0];\n\t\t\tif (x == px && y == py) return;\n\t\t\tthis._custom_last_size = [x, y];\n\n\t\t\tif (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n\t\t\t\tif (!x || !y) return;\n\t\t\t\tif (config.labelPosition == \"top\") {\n\t\t\t\t\tconfig.labelWidth = 0;\n\t\t\t\t}\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t},\n\t},\n\twebix.ui.multicombo\n);\n","import { JetView } from \"webix-jet\";\nimport { createState, ignoreInitial } from \"jet-restate\";\nimport \"../../../helpers/groupselect\";\nimport BucketView from \"./bucket\";\nimport BucketPopup from \"./bucketpopup\";\n\nexport default class BucketSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Views = {};\n\t\tconst columns = {\n\t\t\tmargin: 5,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttemplate: _(\"Specify columns and their data buckets\"),\n\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\tlocalId: \"addColumn\",\n\n\t\t\t\t\tlabel: _(\"Add column\"),\n\t\t\t\t\tclick: () => this.ShowColumns(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst buckets = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list webix_rpt_bcols\",\n\t\t\tlocalId: \"table\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tconst buckets = createState({\n\t\t\t\t\tid: obj.id,\n\t\t\t\t\toptions: obj.options,\n\t\t\t\t});\n\t\t\t\tthis.on(\n\t\t\t\t\tbuckets.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.Update(obj.id, buckets);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = (this.Views[obj.id] = new BucketView(\n\t\t\t\t\tthis.app,\n\t\t\t\t\tbuckets,\n\t\t\t\t\tthis.State\n\t\t\t\t));\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonItemClick: id => this.ToggleSub(id),\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_bucket_delete: (e, id) => {\n\t\t\t\t\twebix\n\t\t\t\t\t\t.confirm({\n\t\t\t\t\t\t\ttitle: _(\"Delete\"),\n\t\t\t\t\t\t\tok: _(\"Delete\"),\n\t\t\t\t\t\t\tcancel: _(\"Cancel\"),\n\t\t\t\t\t\t\ttext: _(\"Are you sure to delete?\"),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => this.RemoveColumn(id));\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: 0,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\trows: [columns, buckets],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Table = this.$$(\"table\");\n\t\tconst buckets = this.State.buckets || [];\n\n\t\tthis.BucketState = createState({ buckets, newColumn: null });\n\t\tthis.LoadBuckets();\n\t\tthis.setParam(\"buckets\", this.BucketState);\n\t\tthis.on(\n\t\t\tthis.BucketState.$changes,\n\t\t\t\"*\",\n\t\t\tignoreInitial((v, o) => this.Changed(v, o))\n\t\t);\n\t\tthis.on(this.app, \"onAction\", (name, action, id) => {\n\t\t\tif (this.getRoot() && name == \"bucket\" && action == \"resize\")\n\t\t\t\tthis.Table.refresh(id);\n\t\t});\n\t}\n\tShowColumns() {\n\t\tif (!this.ColumnList || !this.ColumnList.$view)\n\t\t\tthis.ColumnList = this.ui(BucketPopup, this.State);\n\t\tthis.ColumnList.Show(this.$$(\"addColumn\").$view);\n\t}\n\n\tLoadBuckets() {\n\t\tconst tableData = this.BucketState.buckets\n\t\t\t? this.BucketState.buckets.map(a => {\n\t\t\t\t\tconst field = this.State.fields.find(f => f.id == a.column);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: a.column,\n\t\t\t\t\t\tname: field.name,\n\t\t\t\t\t\tmodel: field.model || null,\n\t\t\t\t\t\toptions: a.options,\n\t\t\t\t\t};\n\t\t\t  })\n\t\t\t: [];\n\t\tthis.Table.clearAll();\n\t\tthis.Table.parse(tableData);\n\t\tif (!tableData.length) this.Table.hide();\n\t}\n\tAddColumn(id) {\n\t\tif (this.Table.config.hidden) this.Table.show();\n\t\tconst field = this.State.fields.find(f => f.id == id);\n\t\tthis.Table.add({\n\t\t\tid,\n\t\t\tname: field.name,\n\t\t\tmodel: field.model || null,\n\t\t\toptions: [],\n\t\t});\n\t}\n\tRemoveColumn(id) {\n\t\tthis.Table.remove(id);\n\t\tconst buckets = [...this.BucketState.buckets];\n\t\tconst i = buckets.findIndex(a => a.column == id);\n\t\tbuckets.splice(i, 1);\n\t\tthis.BucketState.buckets = buckets;\n\t\tif (!buckets.length) this.Table.hide();\n\t\tif (this._ActiveEditor && String(id) == String(this._ActiveEditor))\n\t\t\tthis.ResetEditor();\n\t\tthis.Views[id].destructor();\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tChanged(newV, oldV) {\n\t\tif (newV.length > oldV.length) {\n\t\t\tconst id = newV[newV.length - 1].column;\n\t\t\tthis.AddColumn(id);\n\t\t\tthis.Table.openSub(id);\n\t\t}\n\t\tconst buckets = this.BucketState.buckets.filter(b => b.options.length);\n\t\tthis.State.buckets = buckets;\n\t}\n\n\tRowTemplate(item, common) {\n\t\tconst html = `<div class='webix_rpt_config_row'>\n\t\t\t<span class='webix_rpt_buckets_num'>\n\t\t\t\t<span class='webix_rpt_bucket_sublabel'>${this._(\"buckets\")}: </span>\n\t\t\t\t\t${item.options.length}\n\t\t\t\t</span>\n\t\t\t\t<div class='webix_rpt_config_row_name'>\n\t\t\t\t\t<span class='webix_rpt_bucket_sublabel'>${this._(\"column\")}: </span>\n\t\t\t\t\t${item.name}${\n\t\t\titem.model\n\t\t\t\t? `<span class='webix_rpt_sources_path'>${item.model}</span>`\n\t\t\t\t: \"\"\n\t\t}\n\t\t\t\t</div>\n\t\t\t\t<span class='webix_icon rpi-delete webix_rpt_bucket_delete'></span>\n\t\t\t\t${common.subrow(item, common)}\n\t\t\n\t\t</div>`;\n\n\t\treturn html;\n\t}\n\n\tHideAllEditors(id) {\n\t\tconst prevId = this._ActiveEditor;\n\t\tif (prevId && this.Table.getItem(prevId)) this.Table.closeSub(prevId);\n\n\t\tthis._ActiveEditor = id;\n\t\tif (id) this.FocusEditor();\n\t}\n\tFocusEditor() {\n\t\tthis.app.callEvent(\"onAction\", [\"bucket\", \"focus\", this._ActiveEditor]);\n\t}\n\n\tResetEditor() {\n\t\tthis._ActiveEditor = null;\n\t}\n\n\tToggleSub(id) {\n\t\tvar row = this.Table.getItem(id);\n\t\tif (row.$subopen) this.Table.closeSub(id);\n\t\telse this.Table.openSub(id);\n\t}\n\tUpdate(id, data) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst buckets = [...this.BucketState.buckets];\n\t\tconst column = this.BucketState.buckets.find(b => b.column == id);\n\t\tcolumn.options = data.options;\n\t\tthis.BucketState.buckets = buckets;\n\t\tthis.Table.updateItem(id, { options: column.options });\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class DateView extends JetView {\n\tconstructor(app, master) {\n\t\tsuper(app);\n\t\tthis.Master = master;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\tcss: \"webix_rpt_grouppopup\",\n\t\t\t\ttemplate: obj => this.GetPopupTemplate(obj),\n\t\t\t\tdata: this.Master.config.modifiers,\n\t\t\t\tclick: id => {\n\t\t\t\t\tthis.Master.setModifier(this.ActiveGroup, id);\n\t\t\t\t\tthis.getRoot().hide();\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\t$init() {\n\t\tthis.ActiveGroup = null;\n\t}\n\tGetPopupTemplate(obj) {\n\t\tconst isSelected = obj.id == this.Master.getModifier(this.ActiveGroup);\n\t\treturn `${obj.value} <span class='webix_icon wxi-radiobox-${\n\t\t\tisSelected ? \"marked\" : \"blank\"\n\t\t}'></span>`;\n\t}\n\tShow(node, id) {\n\t\tthis.ActiveGroup = id;\n\t\tthis.getRoot().show(node, { x: -10 });\n\t\tthis.getRoot()\n\t\t\t.getBody()\n\t\t\t.refresh();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Popup from \"./summarypopup\";\n\nexport default class Summaries extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst labels = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Function\"),\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Column\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"New column name\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twidth: 38,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst inputs = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tlocalId: \"summaries\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\tcss: \"webix_rpt_summary_form\",\n\t\t\telements: [],\n\t\t};\n\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tcols: [{ view: \"label\", label: _(\"Group summaries\") }],\n\t\t\t\t},\n\t\t\t\tlabels,\n\t\t\t\tinputs,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\tlabel: _(\"Add column\"),\n\t\t\t\t\twidth: 210,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tclick: () => this.AddNewAggregation(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.GroupState = this.getParam(\"group\", true);\n\n\t\tthis.SummaryColumns = this.State.fields\n\t\t\t.filter(column => {\n\t\t\t\treturn (\n\t\t\t\t\t(column.type == \"number\" || column.type == \"date\") && !column.key\n\t\t\t\t);\n\t\t\t})\n\t\t\t.sort((a, b) => (a.type < b.type ? 1 : -1))\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type }));\n\n\t\tthis.CreateForm();\n\t\tthis.on(this.GroupState.$changes, \"by\", () => this.ValidateFormData());\n\t}\n\n\tCreateForm() {\n\t\tconst aggregate = this.GroupState.columns;\n\t\tif (aggregate && aggregate.length) this.LoadAggregations(aggregate);\n\t\telse this.AddNewAggregation();\n\n\t\tif (!this.SummaryColumns.length) {\n\t\t\tthis.ApplyOneRowMode();\n\t\t}\n\t}\n\tApplyOneRowMode() {\n\t\tconst rows = this.getRoot().getChildViews();\n\t\trows[3].hide();\n\t\trows[4].hide();\n\t}\n\n\tAddNewAggregation() {\n\t\tthis.AddAggregation();\n\t\tthis.Changed();\n\t}\n\n\tLoadAggregations(data) {\n\t\tdata.forEach(summary => {\n\t\t\tthis.AddAggregation(summary);\n\t\t});\n\t\tthis.Changed();\n\t}\n\n\tAddAggregation(aggregation) {\n\t\taggregation = aggregation || this.GetDefaultFormData();\n\t\tif (!aggregation) return false;\n\t\tconst formId = aggregation.id || \"form\" + webix.uid();\n\t\tthis.$$(\"summaries\").addView(this.GetRowForm(formId, aggregation));\n\t}\n\n\tGetRowForm(id, data) {\n\t\tlet cols = [\n\t\t\t{\n\t\t\t\twidth: 100,\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"op\",\n\t\t\t\tvalue: data.op || null,\n\t\t\t\toptions: this.GetOperations(),\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"op\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"id\",\n\t\t\t\tdisabled: data.op == \"count\",\n\t\t\t\tvalue: data.id || null,\n\t\t\t\toptions: this.SummaryColumns,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"id\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"text\",\n\t\t\t\tvalue: data.name || null,\n\t\t\t\tname: \"name\",\n\t\t\t\ton: {\n\t\t\t\t\tonTimedKeypress: v => this.Changed(id, \"name\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tcols.push({\n\t\t\tview: \"icon\",\n\t\t\ticon: \"wxi-dots\",\n\t\t\tclick: (id, ev) => this.ShowPopup(id, ev),\n\t\t});\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: id,\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\trules: {\n\t\t\t\tid: value => {\n\t\t\t\t\tconst groupBy = this.GroupState.by;\n\t\t\t\t\treturn !groupBy || groupBy.indexOf(value) < 0;\n\t\t\t\t},\n\t\t\t},\n\t\t\tcols: cols,\n\t\t};\n\t}\n\n\tGetDefaultFormData() {\n\t\tconst data = this.GetData();\n\t\tconst columns = this.SummaryColumns;\n\t\tconst operations = this.GetOperations();\n\t\tif (!columns.length) {\n\t\t\tconst op = !data.length ? operations.find(op => op.id == \"count\") : null;\n\t\t\treturn op\n\t\t\t\t? {\n\t\t\t\t\t\top: \"count\",\n\t\t\t\t\t\tid: \"\",\n\t\t\t\t\t\tname: this.NewColumnTemplate(op),\n\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t  }\n\t\t\t\t: null;\n\t\t} else {\n\t\t\tfor (let i = 0; i < operations.length; i++) {\n\t\t\t\tfor (let j = 0; j < columns.length; j++) {\n\t\t\t\t\tconst op = operations[i];\n\t\t\t\t\tif (\n\t\t\t\t\t\t!data.find(\n\t\t\t\t\t\t\trow =>\n\t\t\t\t\t\t\t\trow.op == op.id && (op.id == \"count\" || row.id == columns[j].id)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\top: op.id,\n\t\t\t\t\t\t\tid: op.id != \"count\" ? columns[j].id : null,\n\t\t\t\t\t\t\tname: this.NewColumnTemplate(op, columns[j]),\n\t\t\t\t\t\t\ttype: columns[j].type,\n\t\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tNewColumnTemplate(operation, column) {\n\t\treturn operation.id == \"count\"\n\t\t\t? operation.value\n\t\t\t: operation.value + \" \" + column.value;\n\t}\n\n\tShowPopup(id, ev) {\n\t\tif (!this.Popup || !this.Popup.$view)\n\t\t\tthis.Popup = this.ui(new Popup(this.app, \"summary\"));\n\t\tconst form = webix.$$(id).getParentView();\n\t\tthis.ActiveForm = form;\n\t\tthis.Popup.Show(\n\t\t\tev.target,\n\t\t\tthis.GetData(),\n\t\t\tform.getParentView().index(form)\n\t\t);\n\t}\n\n\tApplyAction(id) {\n\t\tif (id == \"delete\") this.DeleteAggregation();\n\t}\n\n\tDeleteAggregation(form) {\n\t\tform = form || this.ActiveForm;\n\t\tconst formList = form.getParentView();\n\t\tif (formList.getChildViews().length > 1) formList.removeView(form);\n\t\telse form.setValues({});\n\t\tthis.Changed();\n\t}\n\n\tGetOperations() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ id: \"sum\", value: _(\"Sum\") },\n\t\t\t{ id: \"count\", value: _(\"Count\") },\n\t\t\t{ id: \"avg\", value: _(\"Average\") },\n\t\t\t{ id: \"max\", value: _(\"Max\") },\n\t\t\t{ id: \"min\", value: _(\"Min\") },\n\t\t];\n\t}\n\n\tGetData() {\n\t\tlet data = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tdata.push(form.getValues());\n\t\t});\n\t\treturn data;\n\t}\n\n\tForEachFormRow(handler) {\n\t\tthis.$$(\"summaries\")\n\t\t\t.getChildViews()\n\t\t\t.forEach(form => {\n\t\t\t\tif (form && form.elements) {\n\t\t\t\t\thandler(form);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tValidateFormData() {\n\t\tlet valid = true;\n\t\tthis.ForEachFormRow(form => (valid = form.validate() && valid));\n\t\treturn valid;\n\t}\n\n\tChangeNewColumnName(formId) {\n\t\tconst form = this.$$(formId).elements;\n\t\tconst oId = form.op.getValue();\n\t\tconst cId = form.id.getValue();\n\t\tconst operations = this.GetOperations();\n\n\t\tif (oId) {\n\t\t\tif (oId == \"count\")\n\t\t\t\tform.name.setValue(\n\t\t\t\t\tthis.NewColumnTemplate(operations.find(o => o.id == oId))\n\t\t\t\t);\n\t\t\telse if (cId)\n\t\t\t\tform.name.setValue(\n\t\t\t\t\tthis.NewColumnTemplate(\n\t\t\t\t\t\toperations.find(o => o.id == oId),\n\t\t\t\t\t\tthis.SummaryColumns.find(c => c.id == cId)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t}\n\t}\n\n\tChanged(formId, name, value) {\n\t\tif (name == \"op\" || name == \"id\") this.ChangeNewColumnName(formId);\n\t\tif (name == \"op\" && value == \"count\") {\n\t\t\tthis.$$(formId).elements.id.setValue(null);\n\t\t\tthis.$$(formId).elements.id.disable();\n\t\t} else {\n\t\t\tif (formId && name) this.$$(formId).elements.id.enable();\n\t\t}\n\n\t\tthis.ValidateFormData();\n\t\tconst columns = this.GetData();\n\t\tcolumns.forEach(\n\t\t\ta =>\n\t\t\t\t(a.type = (\n\t\t\t\t\tthis.SummaryColumns.find(b => b.id == a.id) || { type: \"number\" }\n\t\t\t\t).type)\n\t\t);\n\t\tthis.GroupState.columns = columns;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { createState, ignoreInitial } from \"jet-restate\";\nimport Summaries from \"./summary\";\nimport \"../../../helpers/groupselect\";\nimport DatePopupView from \"./datepopup\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst groupBy = {\n\t\t\tmargin: 5,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttemplate: _(\"Specify columns to group by and output(s)\"),\n\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"groupselect\",\n\t\t\t\t\tlocalId: \"groupBy\",\n\t\t\t\t\tmodifiers: this.GetDateOptions(),\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: () => this.ChangeGroupBy(),\n\t\t\t\t\t\tonModifierClick: (id, e, node) =>\n\t\t\t\t\t\t\tthis.ShowModifierPopup(id, e, node),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: 0,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"groupByLayout\",\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\trows: [groupBy, Summaries],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst groupState = this.State.group || {};\n\t\tthis.GroupState = createState({\n\t\t\tby: groupState.by || null,\n\t\t\tcolumns: groupState.columns || null,\n\t\t});\n\n\t\tthis.LoadColumns();\n\n\t\tthis.setParam(\"group\", this.GroupState);\n\t\tthis.on(this.GroupState.$changes, \"*\", ignoreInitial(() => this.Apply()));\n\t}\n\n\tChangeGroupBy() {\n\t\tconst group = this.$$(\"groupBy\");\n\t\tconst list = group.getPopup().getList();\n\t\tlet arr = group.getValue();\n\t\tarr = arr ? (typeof arr === \"string\" ? arr.split(\",\") : arr) : [];\n\n\t\tthis.GroupState.by = arr.map(a => {\n\t\t\tlet mod = group.getModifier(a);\n\t\t\tif (list.getItem(a).type === \"date\" && !mod) {\n\t\t\t\tmod = \"year\";\n\t\t\t\tgroup.setModifier(a, mod, true);\n\t\t\t}\n\n\t\t\tconst obj = { id: a };\n\t\t\tif (mod) obj.mod = mod;\n\n\t\t\treturn obj;\n\t\t});\n\t}\n\n\tFilterGroupByColumns(column) {\n\t\treturn column.id != \"id\";\n\t}\n\n\tLoadColumns() {\n\t\tconst columns = this.State.fields.map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t}));\n\t\tconst groupBy = this.$$(\"groupBy\");\n\t\tconst list = groupBy.getPopup().getList();\n\t\tlist.type.template = obj => this.ListTemplate(obj);\n\t\tlist.parse(columns);\n\n\t\tthis.$$(\"groupBy\").setValue(this.GroupState.by);\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tShowModifierPopup(id, e, node) {\n\t\tif (!this.DatePopup)\n\t\t\tthis.DatePopup = this.ui(new DatePopupView(this.app, this.$$(\"groupBy\")));\n\t\twebix.delay(() => this.DatePopup.Show(node, id));\n\t}\n\n\tGetDateOptions() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ id: \"day\", value: _(\"Day\") },\n\t\t\t{ id: \"month\", value: _(\"Month\") },\n\t\t\t{ id: \"year\", value: _(\"Year\") },\n\t\t\t{ id: \"yearmonth\", value: _(\"Year\") + \"/\" + _(\"Month\") },\n\t\t\t{\n\t\t\t\tid: \"yearmonthday\",\n\t\t\t\tvalue: _(\"Year\") + \"/\" + _(\"Month\") + \"/\" + _(\"Day\"),\n\t\t\t},\n\t\t];\n\t}\n\tApply() {\n\t\tconst s = this.GroupState;\n\t\tthis.State.group = {\n\t\t\tby: s.by || null,\n\t\t\tcolumns: s.columns || [],\n\t\t};\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst groupByMode = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"groupBySwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleGroupBy(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Group\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst buckets = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"bucketsSwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleBuckets(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Data buckets\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst sortByMode = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"sortBySwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleSortBy(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Sort\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"scrollview\",\n\t\t\tbody: {\n\t\t\t\ttype: \"form\",\n\t\t\t\trows: [\n\t\t\t\t\tgroupByMode,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"group\" },\n\t\t\t\t\tbuckets,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"buckets\" },\n\t\t\t\t\tsortByMode,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"sort\" },\n\t\t\t\t\t{ gravity: 0.000001 },\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.$$(\"groupBySwitch\").setValue(!!this.State.group);\n\t\tthis.$$(\"sortBySwitch\").setValue(!!this.State.sort);\n\t\tthis.$$(\"bucketsSwitch\").setValue(!!this.State.buckets);\n\t}\n\n\tToggleGroupBy(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.groups\", { target: \"group\" });\n\t\t} else {\n\t\t\tthis.State.group = null;\n\t\t\tthis.show(\"_hidden\", { target: \"group\" });\n\t\t}\n\t}\n\n\tToggleSortBy(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.sorts\", { target: \"sort\" });\n\t\t} else {\n\t\t\tthis.State.sort = null;\n\t\t\tthis.show(\"_hidden\", { target: \"sort\" });\n\t\t}\n\t}\n\tToggleBuckets(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.buckets\", { target: \"buckets\" });\n\t\t} else {\n\t\t\tthis.State.buckets = null;\n\t\t\tthis.show(\"_hidden\", { target: \"buckets\" });\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { sortAsc, sortDesc } from \"helpers/icons\";\nimport \"../../../helpers/groupselect\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst sortBy = {\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Specify columns to sort by\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"groupselect\",\n\t\t\t\t\tlocalId: \"sortBy\",\n\t\t\t\t\tselectIcon: false,\n\t\t\t\t\tcss: \"webix_rpt_sort_selector\",\n\t\t\t\t\tmodifiers: [\n\t\t\t\t\t\t{ id: \"asc\", value: sortAsc },\n\t\t\t\t\t\t{ id: \"desc\", value: sortDesc },\n\t\t\t\t\t],\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: () => this.ChangeSortBy(),\n\t\t\t\t\t\tonModifierClick: id => this.ChangeDirection(id),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn sortBy;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.on(this.State.$changes, \"publicFields\", v => {\n\t\t\tif (v) this.LoadColumns();\n\t\t});\n\t\tthis.on(this.State.$changes, \"fields\", () => {\n\t\t\tif (!this.State.publicFields) this.LoadColumns();\n\t\t});\n\t}\n\n\tLoadColumns() {\n\t\tconst columns = (this.State.publicFields || this.State.fields).map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t}));\n\n\t\tconst sortBy = this.$$(\"sortBy\");\n\t\tconst list = sortBy.getPopup().getList();\n\t\tlist.type.template = obj => this.ListTemplate(obj);\n\t\tlist.clearAll();\n\t\tlist.parse(columns);\n\n\t\tlet sort = this.State.sort;\n\t\tif (sort) sort = sort.filter(a => !!columns.find(b => b.id == a.id));\n\t\tsortBy.setValue(sort);\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tChangeSortBy() {\n\t\tconst ui = this.$$(\"sortBy\");\n\t\tlet arr = ui.getValue();\n\t\tarr = arr ? (typeof arr === \"string\" ? arr.split(\",\") : arr) : [];\n\n\t\tconst state = arr.map(id => {\n\t\t\tlet mod = ui.getModifier(id);\n\t\t\tif (!mod) {\n\t\t\t\tmod = \"asc\";\n\t\t\t\tui.setModifier(id, mod, true);\n\t\t\t}\n\n\t\t\tconst obj = { id };\n\t\t\tif (mod) obj.mod = mod;\n\n\t\t\treturn obj;\n\t\t});\n\n\t\tthis.State.sort = state.length ? state : null;\n\t}\n\n\tChangeDirection(id) {\n\t\tconst ui = this.$$(\"sortBy\");\n\t\tui.setModifier(id, ui.getModifier(id) === \"asc\" ? \"desc\" : \"asc\");\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class AxisPropertiesView extends JetView {\n\tconstructor(app, data, chartState) {\n\t\tsuper(app);\n\t\tthis.Axis = data;\n\t\tthis.ChartState = chartState;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabel: _(\"Logarithmic scale\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"logarithmic\",\n\t\t\t\thidden: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"title\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\tview: \"colorpicker\",\n\t\t\t\tname: \"color\",\n\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\tsuggest: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabelWidth: 190,\n\t\t\t\t\t\tlabel: _(\"Gridlines\"),\n\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\tname: \"lines\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\t\tname: \"lineColor\",\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\n\t\t\t{\n\t\t\t\tlabel: _(\"Vertical labels\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"verticalLabels\",\n\t\t\t\thidden: true,\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabelWidth: 190,\n\t\t\t},\n\t\t\tvisibleBatch: \"default\",\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.on(this.Axis.$changes, \"id\", id => {\n\t\t\tif (id == \"y\") this.ApplyYAxis();\n\t\t\telse this.ApplyXAxis();\n\t\t});\n\t\tthis.on(this.Axis.$changes, \"lines\", v => {\n\t\t\tconst lineColor = this.getRoot().elements[\"lineColor\"];\n\t\t\tif (v) lineColor.show();\n\t\t\telse lineColor.hide();\n\t\t});\n\t\tbind(this.Axis, \"*\", this.getRoot());\n\t}\n\n\tApplyYAxis() {\n\t\tthis.getRoot().elements[\"logarithmic\"].show();\n\t}\n\tApplyXAxis() {\n\t\tthis.getRoot().elements[\"verticalLabels\"].show();\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BaseStructureView extends JetView {\n\tHideField(id) {\n\t\tthis.$$(\"fields\").updateItem(id, { show: false });\n\t\tthis.SaveOrder();\n\t}\n\n\tShowField(id) {\n\t\tthis.$$(\"fields\").updateItem(id, { show: true });\n\t\tthis.SaveOrder();\n\t}\n\n\tHideAllEditors(id, name) {\n\t\tif (!name) name = \"fields\";\n\t\tif (this._ActiveEditor[name])\n\t\t\tthis.$$(name).closeSub(this._ActiveEditor[name]);\n\n\t\tthis._ActiveEditor[name] = id;\n\t\tif (id) {\n\t\t\twebix.delay(\n\t\t\t\t() => {\n\t\t\t\t\tconst subView = this.$$(name).getSubView(id);\n\t\t\t\t\tif (subView) subView.focus();\n\t\t\t\t},\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\t100\n\t\t\t);\n\t\t}\n\t}\n\n\tResetEditor(name) {\n\t\tthis._ActiveEditor[name || \"fields\"] = null;\n\t}\n\n\tToggleSub(id, name) {\n\t\tconst table = this.$$(name || \"fields\");\n\t\tvar row = table.getItem(id);\n\t\tif (row.$subopen) table.closeSub(id);\n\t\telse table.openSub(id);\n\t}\n\n\tSaveOrder() {}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ColorPopupView extends JetView {\n\tconstructor(app, state) {\n\t\tsuper(app);\n\t\tthis.State = state;\n\t\tthis.Id = null;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"colorselect\",\n\t\t\t\tbutton: true,\n\t\t\t\ton: {\n\t\t\t\t\tonColorSelect: color => {\n\t\t\t\t\t\tlet s = this.GetSeries(this.Id);\n\t\t\t\t\t\tif (s) s.meta.color = color;\n\t\t\t\t\t\tthis.State.updatedSeries = this.Id;\n\t\t\t\t\t\tthis.getRoot().close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tShow(node, id) {\n\t\tconst popup = this.getRoot();\n\t\tthis.Id = id;\n\t\tpopup.show(node);\n\t\tpopup.getBody().setValue(this.GetSeries(id).meta.color);\n\t}\n\n\tGetSeries(id) {\n\t\treturn this.State.series.find(s => s.id == id);\n\t}\n}\n","webix.protoUI(\n\t{\n\t\tname: \"text-search\",\n\t\t$cssName: \"search\",\n\t\tdefaults: {\n\t\t\tcloseIcon: \"wxi-close\",\n\t\t\ttemplate: function(obj, common) {\n\t\t\t\tvar text = common.$renderInput(obj);\n\t\t\t\tif (obj.badge || obj.badge === 0)\n\t\t\t\t\ttext = text.replace(\n\t\t\t\t\t\tnew RegExp(\"</div>$\"),\n\t\t\t\t\t\t\"<span class='webix_badge'>\" + obj.badge + \"</span></div>\"\n\t\t\t\t\t);\n\t\t\t\treturn text;\n\t\t\t},\n\t\t},\n\n\t\ton_click: {\n\t\t\twebix_input_icon: function(e) {\n\t\t\t\tconst css = e.target.className;\n\t\t\t\tthis.getInputNode().focus();\n\n\t\t\t\tif (css.indexOf(this.config.closeIcon) > -1) {\n\t\t\t\t\tthis.setValue(\"\");\n\t\t\t\t\tthis.callEvent(\"onCloseIconClick\", [e]);\n\t\t\t\t\tthis.hideCloseIcon();\n\t\t\t\t} else {\n\t\t\t\t\tthis.callEvent(\"onSearchIconClick\", [e]);\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t$init() {\n\t\t\tthis.attachEvent(\"onTimedKeyPress\", () => this._onSearch());\n\t\t\tthis.attachEvent(\"onChange\", () => this._onSearch());\n\t\t},\n\t\t_onSearch() {\n\t\t\tconst v = this.getValue();\n\t\t\tif (v) this.showCloseIcon();\n\t\t\telse this.hideCloseIcon();\n\n\t\t\tthis.callEvent(\"onSearchChange\", [v]);\n\t\t},\n\t\tsetIcon(icon) {\n\t\t\tconst nodes = this.$view.getElementsByClassName(\"webix_input_icon\");\n\t\t\tif (nodes.length) nodes[0].className = \"webix_input_icon \" + icon;\n\t\t},\n\t\tshowCloseIcon() {\n\t\t\tthis.setIcon(this.config.closeIcon);\n\t\t},\n\t\thideCloseIcon() {\n\t\t\tthis.setIcon(this.config.icon);\n\t\t},\n\t\tsetBadge(value) {\n\t\t\tlet node = this.$view.querySelector(\".webix_badge\");\n\t\t\tif (value || value === 0) {\n\t\t\t\tif (!node) {\n\t\t\t\t\tnode = webix.html.create(\n\t\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t\t{ class: \"webix_badge\" },\n\t\t\t\t\t\t\"\" + value\n\t\t\t\t\t);\n\t\t\t\t\tthis.$view.querySelector(\".webix_el_box\").appendChild(node);\n\t\t\t\t} else node.innerHTML = \"\" + value;\n\t\t\t} else if (node) webix.html.remove(node);\n\t\t\tthis.config.badge = value;\n\t\t},\n\t},\n\twebix.ui.search\n);\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class SeriesPropertiesView extends JetView {\n\tconstructor(app, data, chartState) {\n\t\tsuper(app);\n\t\tthis.Series = data;\n\t\tthis.ChartState = chartState;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"name\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\tview: \"colorpicker\",\n\t\t\t\tname: \"color\",\n\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\tsuggest: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Marker type\"),\n\t\t\t\tview: \"richselect\",\n\t\t\t\tcss: \"webix_rpt_markerselect\",\n\t\t\t\tname: \"markerType\",\n\t\t\t\toptions: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcss: \"webix_rpt_markerselect_list\",\n\t\t\t\t\t\ttemplate: item => this.ItemListTemplate(item),\n\t\t\t\t\t\tdata: this.Charts.getItemTypes(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbatch: \"marker\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Fill marker\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"fillMarker\",\n\t\t\t\tbatch: \"marker\",\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 170,\n\t\t\t},\n\t\t\tvisibleBatch: \"default\",\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tbind(this.Series, \"*\", this.getRoot());\n\t\tif (this.Charts.itemSupport.indexOf(this.ChartState.chartType) > -1)\n\t\t\tthis.getRoot().showBatch(\"marker\");\n\n\t\tthis.on(this.Series.$changes, \"color\", () => {\n\t\t\tconst markerType = this.getRoot().elements[\"markerType\"];\n\t\t\tmarkerType.refresh();\n\t\t\tmarkerType.getList().refresh();\n\t\t});\n\t}\n\n\tItemListTemplate(item) {\n\t\treturn `<div class=\"webix_rpt_config_row\">${item.value} <span class='webix_icon ${item.icon}' style='color:${this.Series.color}'></span></div>`;\n\t}\n}\n","import { createState, ignoreInitial } from \"jet-restate\";\nimport ColorPopup from \"./colorpopup\";\nimport BaseView from \"./baseview\";\nimport \"../../../helpers/rsearch\";\nimport SeriesProperties from \"./chartseries\";\nimport AxisProperties from \"./axis\";\n//import LegendProperties from \"./legend\";\n\nexport default class ChartView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis._ActiveEditor = {};\n\t\tconst type = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: this._(\"Chart type\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"type\",\n\t\t\t\t\toptions: this.Charts.getTypes(),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => (this.ChartState.chartType = v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst labelField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"X axis column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"labelColumn\",\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeLabelField(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst valueFields = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\tlocalId: \"fields\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\teditable: true,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tif (!this.SubState) this.SubState = {};\n\t\t\t\tconst series = (this.SubState[obj.id] = createState({\n\t\t\t\t\tname: obj.meta.name,\n\t\t\t\t\tcolor: obj.meta.color,\n\t\t\t\t\ttype: obj.meta.type || null,\n\t\t\t\t\tmarkerType: obj.meta.markerType || null,\n\t\t\t\t\tfillMarker: obj.meta.fillMarker || null,\n\t\t\t\t}));\n\t\t\t\tthis.on(\n\t\t\t\t\tseries.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.UpdateSeries(obj.id, series);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = new SeriesProperties(this.app, series, this.ChartState);\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\tdrag: \"order\",\n\t\t\ton: {\n\t\t\t\tonItemDblClick: function(id) {\n\t\t\t\t\tthis.openSub(id);\n\t\t\t\t},\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterDrop: () => this.SaveOrder(),\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\t\"data->onClearAll\": () => this.ResetEditor(),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_chart_color: (e, id) => this.ShowColorPopup(e, id),\n\t\t\t\t\"action-visible\": (e, id) => this.HideField(id),\n\t\t\t\t\"action-hidden\": (e, id) => this.ShowField(id),\n\t\t\t\twebix_rpt_config_row_name: (e, id) => this.ToggleSub(id),\n\t\t\t},\n\t\t};\n\t\tconst axisFields = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Axes\") },\n\n\t\t\t\t{\n\t\t\t\t\tview: \"datatable\",\n\t\t\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\t\t\tlocalId: \"axisFields\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\theader: false,\n\t\t\t\t\tselect: false,\n\t\t\t\t\tsubview: (obj, target) => {\n\t\t\t\t\t\tconst axis = createState({ id: obj.id, ...obj.meta });\n\t\t\t\t\t\tthis.on(\n\t\t\t\t\t\t\taxis.$changes,\n\t\t\t\t\t\t\t\"*\",\n\t\t\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\t\t\tthis.UpdateAxis(obj.id, axis);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst sub = new AxisProperties(this.app, axis, this.ChartState);\n\t\t\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\t\t\treturn sub.getRoot();\n\t\t\t\t\t},\n\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfillspace: true,\n\t\t\t\t\t\t\ttemplate: (item, common) => this.AxisRowTemplate(item, common),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonItemClick: id => this.ToggleSub(id, \"axisFields\"),\n\t\t\t\t\t\tonAfterRender: () => {\n\t\t\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tel &&\n\t\t\t\t\t\t\t\t\tdocument.contains(el) &&\n\t\t\t\t\t\t\t\t\tel !== document.activeElement\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id, \"axisFields\"),\n\t\t\t\t\t\tonSubViewClose: () => this.ResetEditor(\"axisFields\"),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst legendFields = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Legend\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"radio\",\n\t\t\t\t\tlocalId: \"legendPosition\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"bottom\", value: _(\"Bottom\") },\n\t\t\t\t\t\t{ id: \"right\", value: _(\"Right\") },\n\t\t\t\t\t\t{ id: \"none\", value: _(\"None\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeLegend(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\tcss: \"webix_rpt_chart_config\",\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [\n\t\t\t\ttype,\n\t\t\t\tlabelField,\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"dataInputs\",\n\t\t\t\t\trows: this.GetDataInputs(),\n\t\t\t\t},\n\t\t\t\tvalueFields,\n\t\t\t\taxisFields,\n\t\t\t\tlegendFields,\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Types = this.Charts.getTypes();\n\n\t\tlet fields = [];\n\t\t(this.State.publicFields || this.State.fields).forEach(a => {\n\t\t\tfields.push({ ...a });\n\t\t});\n\n\t\t// options with all fields\n\t\tthis.Fields = fields\n\t\t\t.filter(field => {\n\t\t\t\treturn !field.key;\n\t\t\t})\n\t\t\t.sort((a, b) => (a.type < b.type ? 1 : -1))\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type }));\n\n\t\t// Options with numeric fields\n\t\tthis.ValueFields = fields\n\t\t\t.filter(field => {\n\t\t\t\treturn field.type == \"number\" && !field.key;\n\t\t\t})\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type, model: a.model }));\n\n\t\tthis.ChartState = createState(this.GetInitState());\n\n\t\tthis.on(this.ChartState.$changes, \"*\", () => {\n\t\t\tthis.UpdateModuleState();\n\t\t});\n\t\tthis.on(this.ChartState.$changes, \"chartType\", (type, prev) => {\n\t\t\tthis.ApplyChartType(type, prev);\n\t\t});\n\t\tthis.on(this.ChartState.$changes, \"seriesFrom\", (value, prev) => {\n\t\t\tthis.ApplySeriesFrom(value, prev);\n\t\t});\n\n\t\tthis.on(\n\t\t\tthis.ChartState.$changes,\n\t\t\t\"baseColumn\",\n\t\t\tignoreInitial(() => {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t})\n\t\t);\n\t\tthis.on(\n\t\t\tthis.ChartState.$changes,\n\t\t\t\"dataColumn\",\n\t\t\tignoreInitial(() => {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t})\n\t\t);\n\n\t\tthis.on(this.ChartState.$changes, \"updatedSeries\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.$$(\"fields\").refresh(v);\n\t\t\t\tif (this.SubState && this.SubState[v])\n\t\t\t\t\tthis.SubState[v].color = this.ChartState.series.find(\n\t\t\t\t\t\ts => s.id == v\n\t\t\t\t\t).meta.color;\n\t\t\t\tthis.ChartState.updatedSeries = null;\n\t\t\t}\n\t\t});\n\n\t\tthis.$$(\"type\").setValue(this.ChartState.chartType);\n\n\t\tthis.$$(\"labelColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.Fields);\n\t\tthis.$$(\"labelColumn\").setValue(this.ChartState.labelColumn);\n\n\t\tthis.$$(\"seriesFrom\").setValue(this.ChartState.seriesFrom);\n\n\t\tthis.$$(\"baseColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.Fields);\n\t\tthis.$$(\"baseColumn\").setValue(this.ChartState.baseColumn);\n\n\t\tthis.$$(\"dataColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.ValueFields);\n\t\tthis.$$(\"dataColumn\").setValue(this.ChartState.dataColumn);\n\n\t\tthis.$$(\"legendPosition\").setValue(this.ChartState.legendPosition);\n\t}\n\n\tChangeLabelField(label) {\n\t\tthis.ChartState.labelColumn = label;\n\t}\n\tChangeLegend(v) {\n\t\tthis.ChartState.legendPosition = v;\n\t}\n\n\tGetInitState() {\n\t\tconst meta = this.State.meta.chart || {};\n\t\treturn {\n\t\t\tchartType: meta.chartType || this.Charts.type,\n\t\t\tlabelColumn: meta.labelColumn || null,\n\t\t\tupdatedSeries: null,\n\t\t\tseriesFrom: meta.seriesFrom || \"columns\",\n\t\t\tbaseColumn: meta.baseColumn || null,\n\t\t\tdataColumn: meta.dataColumn || null,\n\t\t\tseries: meta.series || null,\n\t\t\tlegend: meta.legend || { layout: \"x\" },\n\t\t\taxises: meta.axises || null,\n\t\t\tlegendPosition: meta.legendPosition || \"bottom\",\n\t\t};\n\t}\n\n\t/*\n\t * Called when chart type changed.\n\t * */\n\tApplyChartType(type, prevType) {\n\t\tthis.ShowAxisInputs(type);\n\t\tthis.RenderSeries(prevType);\n\t}\n\n\t/*\n\t * Renders chart series. Loads init state values\n\t * or generates new series depending on selected type\n\t * */\n\tRenderSeries(prevType) {\n\t\tconst series = this.ChartState.series;\n\t\tif (series && typeof prevType == \"undefined\") this.LoadSeries(series);\n\t\telse this.GenerateSeries();\n\t}\n\n\t// Loads axis data\n\tShowAxisInputs(type) {\n\t\tconst isAxises = this.Charts.noAxisSupport.indexOf(type);\n\t\tif (isAxises) {\n\t\t\tif (!this.ChartState.axises) {\n\t\t\t\tthis.ChartState.axises = {\n\t\t\t\t\tx: {\n\t\t\t\t\t\ttitle: \"\",\n\t\t\t\t\t\tcolor: \"#edeff0\",\n\t\t\t\t\t\tlineColor: \"#edeff0\",\n\t\t\t\t\t\tlines: true,\n\t\t\t\t\t\tverticalLabels: true,\n\t\t\t\t\t},\n\t\t\t\t\ty: {\n\t\t\t\t\t\ttitle: \"\",\n\t\t\t\t\t\tcolor: \"#edeff0\",\n\t\t\t\t\t\tlineColor: \"#edeff0\",\n\t\t\t\t\t\tlines: true,\n\t\t\t\t\t\tlogarithmic: false,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (!this.$$(\"axisFields\").data.count())\n\t\t\t\tthis.$$(\"axisFields\").parse([\n\t\t\t\t\t{ id: \"x\", meta: { ...this.ChartState.axises.x } },\n\t\t\t\t\t{ id: \"y\", meta: { ...this.ChartState.axises.y } },\n\t\t\t\t]);\n\t\t} else {\n\t\t\tthis.ChartState.axises = null;\n\t\t\tthis.$$(\"axisFields\").clearAll();\n\t\t}\n\t}\n\tGetDataInputs() {\n\t\treturn [\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{ view: \"label\", label: this._(\"Data series\") },\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Extract series from\"),\n\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\t\t\t\twidth: 200,\n\t\t\t\t\t\t\t\t\t\tlocalId: \"seriesFrom\",\n\t\t\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t\t\t{ id: \"columns\", value: this._(\"columns\") },\n\t\t\t\t\t\t\t\t\t\t\t{ id: \"rows\", value: this._(\"rows\") },\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.seriesFrom = v),\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thidden: true,\n\t\t\t\t\t\t\t\tlocalId: \"baseColumnLayout\",\n\t\t\t\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Keys column\"),\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t\tlocalId: \"baseColumn\",\n\t\t\t\t\t\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\t\t\t\t\t\tlabelPosition: \"top\",\n\t\t\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.baseColumn = v),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Values column\"),\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpdataColumnt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t\tlocalId: \"dataColumn\",\n\t\t\t\t\t\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.dataColumn = v),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\t}\n\n\t/*\n\t * Generates series and loads these data\n\t * params:\n\t * - an array of fields/ keys options\n\t * */\n\tApplySeriesKeys(sourceArray) {\n\t\tconst data = this.Charts.getSeries(sourceArray, this.ChartState.type);\n\t\tthis.ChartState.series = data;\n\t\tthis.LoadSeries(data);\n\t}\n\n\tLoadSeries(data) {\n\t\tif (!data.length) this.$$(\"fields\").hide();\n\t\telse this.$$(\"fields\").show();\n\n\t\tthis.$$(\"fields\").clearAll();\n\t\tthis.$$(\"fields\").parse(data);\n\t}\n\t/*\n\t * Gets row keys (requires data loading)\n\t * params:\n\t * - the field / column id where keys need to be found\n\t * Returns a promise\n\t * */\n\tGetRowKeys(base) {\n\t\tif (base && this.State.columns.length) {\n\t\t\tlet keys = [];\n\t\t\treturn this.GetData(base).then(([data, baseOptions]) => {\n\t\t\t\tdata.forEach(row => {\n\t\t\t\t\tconst key = row[base];\n\t\t\t\t\tif (keys.indexOf(key) == -1) keys.push(key);\n\t\t\t\t});\n\n\t\t\t\tif (baseOptions)\n\t\t\t\t\treturn keys.map(key => {\n\t\t\t\t\t\tconst keyOption =\n\t\t\t\t\t\t\tbaseOptions.data.find(option => option.id == key) || null;\n\t\t\t\t\t\treturn { id: key, value: keyOption ? keyOption.value : key };\n\t\t\t\t\t});\n\t\t\t\treturn keys.map(key => ({ id: key, value: key }));\n\t\t\t});\n\t\t} else return Promise.resolve([]);\n\t}\n\n\tGenerateSeries() {\n\t\tconst from = this.ChartState.seriesFrom;\n\t\tif (from == \"columns\") this.ApplySeriesKeys([...this.ValueFields], null);\n\t\telse {\n\t\t\tthis.ChartState.dataColumn = this.$$(\"dataColumn\").getValue();\n\t\t\tconst base = (this.ChartState.baseColumn = this.$$(\n\t\t\t\t\"baseColumn\"\n\t\t\t).getValue());\n\t\t\tthis.GetRowKeys(base).then(arr => this.ApplySeriesKeys(arr, base));\n\t\t}\n\t}\n\n\tApplySeriesFrom(v, prevValue) {\n\t\tif (this.$$(\"baseColumnLayout\")) {\n\t\t\tif (v == \"columns\") {\n\t\t\t\tthis.$$(\"baseColumnLayout\").hide();\n\t\t\t\tthis.$$(\"baseColumn\").setValue(null);\n\t\t\t} else this.$$(\"baseColumnLayout\").show();\n\t\t\tif (prevValue) {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t}\n\t\t}\n\t}\n\n\tUpdateSeries(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst series = [...this.ChartState.series];\n\t\tconst ind = series.findIndex(a => a.id == id);\n\t\tObject.assign(series[ind].meta, update);\n\t\tthis.ChartState.series = series;\n\t\tthis.$$(\"fields\").refresh(id);\n\t}\n\n\tUpdateAxis(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tlet axises = { ...this.ChartState.axises };\n\t\tObject.assign(axises[id], update);\n\t\tthis.ChartState.axises = axises;\n\t}\n\n\tRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'><div class='webix_icon rpi-drag-vertical'></div>\";\n\t\thtml +=\n\t\t\t\"<span class='webix_icon \" +\n\t\t\t(item.show\n\t\t\t\t? \"action-visible rpi-eye\"\n\t\t\t\t: \"action-hidden rpi-eye-off-outline\") +\n\t\t\t\"'></span>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_chart_color' style='background:\" +\n\t\t\titem.meta.color +\n\t\t\t\"'> </div>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_config_row_name'>\" +\n\t\t\titem.name +\n\t\t\t(item.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + item.model + \"</span>\"\n\t\t\t\t: \"\") +\n\t\t\t\"</div>\";\n\t\thtml += common.subrow(item, common);\n\t\treturn html + \"</div>\";\n\t}\n\n\tGetData(baseColumn) {\n\t\tconst appState = this.app.getParam(\"state\");\n\t\tlet moduleConfig = this.Local.getDataConfig(appState.module);\n\t\tmoduleConfig.columns = this.State.columns.map(c => c.id);\n\t\tlet waitData = [this.Local.getData(moduleConfig)];\n\t\tif (baseColumn) waitData.push(this.Local.getOptionsList(baseColumn));\n\t\treturn Promise.all(waitData);\n\t}\n\n\tShowColorPopup(e, id) {\n\t\tif (!this.ColorPopup || !this.ColorPopup.$view)\n\t\t\tthis.ColorPopup = this.ui(new ColorPopup(this.app, this.ChartState));\n\t\tthis.ActiveSeries = id;\n\t\tthis.ColorPopup.Show(e.target, id);\n\t}\n\n\tSaveOrder() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst columns = [];\n\t\ttable.data.each(a => {\n\t\t\tif (a.show)\n\t\t\t\tcolumns.push(\n\t\t\t\t\t(this.State.publicFields || this.State.fields).find(\n\t\t\t\t\t\tb => b.id === a.id\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t});\n\t\tthis.ChartState.series = table.serialize();\n\t}\n\n\tUpdateModuleState() {\n\t\tconst state = this.ChartState;\n\t\tconst columns = [];\n\n\t\tif (state.labelColumn) this.AddColumn(columns, state.labelColumn);\n\t\tif (state.seriesFrom == \"columns\") {\n\t\t\tif (state.series)\n\t\t\t\tstate.series.forEach(a => {\n\t\t\t\t\tif (a.show) this.AddColumn(columns, a.id);\n\t\t\t\t});\n\t\t} else {\n\t\t\tif (state.baseColumn) this.AddColumn(columns, state.baseColumn);\n\t\t\tif (state.dataColumn) this.AddColumn(columns, state.dataColumn);\n\t\t}\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, chart: this.ChartState },\n\t\t});\n\t}\n\n\tAddColumn(columns, id) {\n\t\tconst col = (this.State.publicFields || this.State.fields).find(\n\t\t\tb => b.id === id\n\t\t);\n\t\tif (col) columns.push(col);\n\t}\n\n\tAxisRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'>\" +\n\t\t\tthis._(item.id == \"x\" ? \"X Axis\" : \"Y Axis\");\n\t\thtml += common.subrow(item, common);\n\t\treturn html + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class ColumnPropertiesView extends JetView {\n\tconstructor(app, data) {\n\t\tsuper(app);\n\t\tthis.Column = data;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"name\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Filter\"),\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"header\",\n\t\t\t\toptions: [\n\t\t\t\t\t{ id: \"none\", value: _(\"No filter\") },\n\t\t\t\t\t{ id: \"text\", value: _(\"Text\") },\n\t\t\t\t\t{ id: \"select\", value: _(\"Select\") },\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 120,\n\t\t\t},\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tbind(this.Column, \"*\", this.getRoot());\n\t}\n}\n","import BaseView from \"./baseview\";\n\nexport default class ChartView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\n\t\tconst labelField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Labels column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"label\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst valueField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Values column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"value\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst colorField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Color column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"color\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: false,\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [valueField, labelField, colorField, {}],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\n\t\tlet fields = (this.Fields = (\n\t\t\tthis.State.publicFields || this.State.fields\n\t\t).map(a => ({\n\t\t\t...a,\n\t\t})));\n\t\tlet valueFields = fields.filter(\n\t\t\tfield => field.type == \"number\" && !field.key\n\t\t);\n\t\tif (!valueFields.length)\n\t\t\tvalueFields = fields.filter(field => field.type == \"number\");\n\t\tconst els = this.getRoot().elements;\n\n\t\tconst lc = els.label;\n\t\tlc.getList().parse(fields);\n\t\tlc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tlc.setValue(this.State.meta.label || fields[0].id);\n\n\t\tconst vc = els.value;\n\t\tvc.getList().parse(valueFields);\n\t\tvc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tvc.setValue(this.State.meta.value || valueFields[0].id);\n\n\t\tconst cc = els.color;\n\t\tcc.getList().parse(valueFields);\n\t\tcc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tcc.setValue(this.State.meta.color || valueFields[0].id);\n\n\t\tthis.getRoot().attachEvent(\"onChange\", () => this.OnChange());\n\t\tif (!this.State.meta.value) this.OnChange();\n\t}\n\n\tOnChange() {\n\t\tthis.Apply({ ...this.State.meta, ...this.getRoot().getValues() });\n\t}\n\n\tApply(meta) {\n\t\tconst check = [meta.value, meta.label, meta.color];\n\t\tconst columns = this.Fields.filter(a => check.indexOf(a.id) !== -1);\n\n\t\tthis.State.$batch({\n\t\t\tmeta,\n\t\t\tcolumns,\n\t\t});\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.name +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { types } from \"../../../helpers/icons\";\n\nexport default class StructureView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst tabbar = {\n\t\t\tview: \"richselect\",\n\t\t\tlocalId: \"select\",\n\t\t\tborderless: true,\n\t\t\talign: \"left\",\n\t\t\tinputWidth: 170,\n\t\t\toptions: [\n\t\t\t\t{\n\t\t\t\t\tid: \"table\",\n\t\t\t\t\tvalue: types.table + \" \" + _(\"Table\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"chart\",\n\t\t\t\t\tvalue: types.chart + \" \" + _(\"Chart\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"heatmap\",\n\t\t\t\t\tvalue: types.heatmap + \" \" + _(\"Heatmap\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: v => this.ChangeReportType(v),\n\t\t\t},\n\t\t};\n\n\t\tconst toolbar = {\n\t\t\tview: \"form\",\n\t\t\tpadding: {\n\t\t\t\tleft: webix.skin.$active.layoutPadding.form,\n\t\t\t\ttop: 5,\n\t\t\t\tbottom: 0,\n\t\t\t},\n\t\t\tscroll: false,\n\t\t\tcols: [tabbar],\n\t\t};\n\n\t\tconst ui = {\n\t\t\twidth: 480,\n\t\t\thidden: false,\n\t\t\tlocalId: \"settings\",\n\t\t\ttype: \"clean\",\n\n\t\t\trows: [toolbar, { $subview: true }],\n\t\t};\n\n\t\tthis.Local = this.app.getService(\"local\");\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"type\", v => {\n\t\t\tthis.show(\"editor.structure.\" + v);\n\t\t});\n\t\tthis.$$(\"select\").setValue(this.State.type);\n\t}\n\n\tChangeReportType(type) {\n\t\tif (this.State.type != type) this.State.$batch({ type, meta: {} });\n\t}\n}\n","import { createState, ignoreInitial } from \"jet-restate\";\n\nimport ColumnProperties from \"./column\";\n\nimport \"../../../helpers/rsearch\";\nimport BaseView from \"./baseview\";\n\nexport default class ColumnsView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis._ActiveEditor = {};\n\t\tconst header = {\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Columns\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonSearchChange: () => this.FilterFields(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst fields = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\tlocalId: \"fields\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tconst column = createState({\n\t\t\t\t\tname: obj.meta.name || obj.name,\n\t\t\t\t\theader: obj.meta.header || \"none\",\n\t\t\t\t});\n\t\t\t\tthis.on(\n\t\t\t\t\tcolumn.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.Update(obj.id, column);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = new ColumnProperties(this.app, column);\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\tdrag: \"order\",\n\t\t\ton: {\n\t\t\t\tonItemDblClick: function(id) {\n\t\t\t\t\tif (id.row !== \"$freeze\") this.openSub(id);\n\t\t\t\t},\n\t\t\t\tonBeforeDrag: ctx => {\n\t\t\t\t\tthis.HideAllEditors();\n\t\t\t\t\tconst list = this.$$(\"fields\");\n\t\t\t\t\twebix.html.addCss(list.$view, \"webix_rpt_drag\");\n\n\t\t\t\t\tif (ctx.start === \"$freeze\") {\n\t\t\t\t\t\tctx.html = `<div class=\"webix_drag_zone\"><div class=\"webix_dd_drag wbx-mark_frozen\" style=\"width:${\n\t\t\t\t\t\t\tlist.$width\n\t\t\t\t\t\t}px;\"><div>${this.FrozenTemplate()}</div></div></div>`;\n\t\t\t\t\t} else if (!list.getItem(ctx.start).show) return false;\n\t\t\t\t},\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterDrop: () => {\n\t\t\t\t\twebix.html.removeCss(this.$$(\"fields\").$view, \"webix_rpt_drag\");\n\t\t\t\t\tthis.SaveOrder();\n\t\t\t\t},\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\t\"action-visible\": (e, id) => this.HideField(id),\n\t\t\t\t\"action-hidden\": (e, id) => this.ShowField(id),\n\t\t\t\twebix_rpt_config_row_name: (e, id) => this.ToggleSub(id),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [header, fields],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst table = this.$$(\"fields\");\n\t\tconst has = {};\n\t\tconst columns = this.State.columns.map(a => {\n\t\t\thas[a.id] = 1;\n\t\t\treturn { ...a, show: true };\n\t\t});\n\n\t\t(this.State.publicFields || this.State.fields).forEach(a => {\n\t\t\tif (!has[a.id]) columns.push({ ...a, show: false });\n\t\t});\n\n\t\tcolumns.splice(this.State.meta.freeze || 0, 0, {\n\t\t\tid: \"$freeze\",\n\t\t\t$css: \"wbx-mark_frozen\",\n\t\t\tname: this.FrozenTemplate(),\n\t\t});\n\t\ttable.parse(columns);\n\t}\n\n\tFilterFields() {\n\t\tconst f = this.$$(\"search\")\n\t\t\t.getValue()\n\t\t\t.toLowerCase();\n\t\tthis.$$(\"fields\").filter(a => a.name.toLowerCase().indexOf(f) !== -1);\n\t}\n\n\tUpdate(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst columns = [...this.State.columns];\n\t\tconst ind = columns.findIndex(a => a.id == id);\n\t\tObject.assign(columns[ind].meta, update);\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, freeze: this.GetFreeze() },\n\t\t});\n\t}\n\n\tGetFreeze() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst order = table.data.order;\n\n\t\tlet freezeColumn = 0;\n\t\tfor (var i = 0; i < order.length; i++) {\n\t\t\tif (order[i] === \"$freeze\") break;\n\t\t\tfreezeColumn += table.getItem(order[i]).show ? 1 : 0;\n\t\t}\n\n\t\treturn freezeColumn;\n\t}\n\n\tSaveOrder() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst columns = [];\n\t\ttable.data.each(a => {\n\t\t\tif (a.show)\n\t\t\t\tcolumns.push(\n\t\t\t\t\t(this.State.publicFields || this.State.fields).find(\n\t\t\t\t\t\tb => b.id === a.id\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t});\n\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, freeze: this.GetFreeze() },\n\t\t});\n\t}\n\n\tFrozenTemplate() {\n\t\treturn (\n\t\t\t\"<span class='webix_rpt_frozen webix_icon rpi-arrow-horizontal-lock'></span><span>\" +\n\t\t\tthis._(\"Frozen columns above\") +\n\t\t\t\"</span>\"\n\t\t);\n\t}\n\n\tRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'><div class='webix_icon rpi-drag-vertical'></div>\";\n\t\thtml +=\n\t\t\titem.id !== \"$freeze\"\n\t\t\t\t? \"<span class='webix_icon \" +\n\t\t\t\t  (item.show\n\t\t\t\t\t\t? \"action-visible rpi-eye\"\n\t\t\t\t\t\t: \"action-hidden rpi-eye-off-outline\") +\n\t\t\t\t  \"'></span>\"\n\t\t\t\t: \"\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_config_row_name'>\" +\n\t\t\titem.name +\n\t\t\t(item.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + item.model + \"</span>\"\n\t\t\t\t: \"\") +\n\t\t\t\"</div>\";\n\t\thtml += item.id !== \"$freeze\" ? common.subrow(item, common) : \"\";\n\t\treturn html + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { empty } from \"../helpers/icons\";\n\nexport default class EmptyView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tcss: \"webix_rpt_empty\",\n\t\t\tview: \"template\",\n\t\t\tborderless: true,\n\t\t\ttemplate: value => this.GetTemplate(value),\n\t\t};\n\t}\n\tinit() {\n\t\tconst mods = this.app.getService(\"local\").getModules();\n\t\tmods.waitData.then(() => {\n\t\t\tconst text = this.GetText(mods.data.count());\n\t\t\tthis.getRoot().setValues({ text });\n\t\t});\n\t}\n\tGetText(count) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn count\n\t\t\t? _(\"Select any report from the list\")\n\t\t\t: _(\"Click 'New' button to add a new report\");\n\t}\n\tGetSVG() {\n\t\tconst skin = webix.skin.$name;\n\t\tconst icon = skin == \"willow\" || skin == \"dark\" ? \"alt\" : \"main\";\n\t\treturn empty[icon];\n\t}\n\tGetTemplate(value) {\n\t\tconst text =\n\t\t\t\"<div class='webix_rpt_empty_placeholder'>\" +\n\t\t\t(value.text || \"\") +\n\t\t\t\"</div>\";\n\t\treturn text + this.GetSVG();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Toolbar from \"./common/toolbar\";\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst page = {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\t\t\tcols: [{}],\n\t\t};\n\n\t\treturn { rows: [Toolbar, page] };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\t}\n\tready() {\n\t\tconst parts = this.getRoot().getChildViews();\n\t\tthis.Bar = parts[0];\n\t\tthis.Host = parts[1];\n\n\t\tthis.on(this.State.$changes, \"module\", mod => this.Show(mod));\n\t\tthis.on(this.app, \"exportModule\", mode => this.Export(mode));\n\t}\n\n\tShow(mod) {\n\t\tconst host = this.Host;\n\t\tif (mod && mod.meta.value && mod.type === \"heatmap\") {\n\t\t\tconst config = this.GetChartConfig(mod);\n\t\t\tif (!config.view) return;\n\t\t\tthis.Bar.show();\n\t\t\tthis.GetChartData(mod).then(([data, options]) => {\n\t\t\t\tconfig.data = this.FormatLabels(webix.copy(data), options);\n\t\t\t\tif (data.length && mod.meta.color)\n\t\t\t\t\tconfig.type.cssClass = this.CssFactory(data, mod.meta.color);\n\n\t\t\t\twebix.ui([config], host);\n\t\t\t\tthis.Chart = host.getChildViews()[0];\n\t\t\t});\n\t\t} else {\n\t\t\twebix.ui([{ template: \" \" }], host);\n\t\t\tthis.Bar.hide();\n\t\t\tthis.Chart = null;\n\t\t}\n\t}\n\n\tGetChartConfig(mod) {\n\t\tconst { meta, columns } = mod;\n\n\t\tconst obj = {\n\t\t\tview: \"treemap\",\n\t\t\tcss: \"webix_rpt\",\n\t\t\tvalue: obj => obj[meta.value],\n\t\t\ttooltip: this.TooltipFactory(meta, columns),\n\t\t\ttype: {},\n\t\t};\n\n\t\tif (meta.label) obj.type.template = obj => obj[meta.label];\n\n\t\treturn obj;\n\t}\n\n\tGetChartData(mod) {\n\t\treturn Promise.all([\n\t\t\tthis.Local.getData(\n\t\t\t\tthis.Local.getDataConfig(mod),\n\t\t\t\tthis.State.mode == \"edit\"\n\t\t\t),\n\t\t\tthis.Local.getOptions(mod.columns),\n\t\t]);\n\t}\n\n\tCssFactory(data, prop) {\n\t\tvar min = Infinity;\n\t\tvar max = -Infinity;\n\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\tconst v = data[i][prop];\n\t\t\tif (v > max) max = v * 1;\n\t\t\tif (v < min) min = v * 1;\n\t\t}\n\n\t\tconst step = (max - min) / 4;\n\t\tconst bases = [max - step, max - step * 2, max - step * 3, min];\n\n\t\treturn function(obj) {\n\t\t\tconst v = obj[prop];\n\t\t\tfor (var i = 0; i < bases.length; i++) if (v >= bases[i]) return \"l\" + i;\n\t\t};\n\t}\n\n\tTooltipFactory(obj, columns) {\n\t\tconst valueColumn = columns.find(a => a.id === obj.value);\n\t\tconst colorColumn = columns.find(a => a.id === obj.color);\n\t\tif (!valueColumn || !colorColumn) return \"\";\n\t\tconst props = [obj.value, valueColumn.name];\n\t\tif (obj.color && obj.color != obj.value)\n\t\t\tprops.push(obj.color, colorColumn.name);\n\n\t\treturn function(obj) {\n\t\t\tlet out = \"\";\n\t\t\tfor (let i = 0; i < props.length; i += 2) {\n\t\t\t\tout += (i ? \", \" : \"\") + props[i + 1] + \": \" + obj[props[i]];\n\t\t\t}\n\n\t\t\treturn out;\n\t\t};\n\t}\n\t/**\n\t * Exports chart to png image or PDF\n\t * @param {String} mode - export mode ( \"png\" or PDF \"table\"/\"image\"/\"all\"),\n\t */\n\tExport(mode) {\n\t\tif (this.Chart) {\n\t\t\tif (mode == \"png\") webix.toPNG(this.Chart);\n\t\t\telse if (mode == \"pdf\") {\n\t\t\t\tlet params = { autowidth: true, display: \"image\" };\n\t\t\t\twebix.toPDF(this.Chart, params);\n\t\t\t}\n\t\t}\n\t}\n\tFormatLabels(data, options) {\n\t\tconst labelColumn = this.State.module.meta.label;\n\t\tconst labelOptions =\n\t\t\tlabelColumn && options.length\n\t\t\t\t? options.find(op => op.field == labelColumn)\n\t\t\t\t: null;\n\n\t\tif (labelOptions)\n\t\t\tdata.forEach(item => {\n\t\t\t\tconst option = labelOptions.data.find(o => o.id == item[labelColumn]);\n\t\t\t\titem[labelColumn] = option ? option.value : item[labelColumn];\n\t\t\t});\n\t\telse {\n\t\t\tconst field = this.State.module.fields.find(\n\t\t\t\tfield => field.id == labelColumn\n\t\t\t);\n\t\t\tif (field && field.type == \"date\") {\n\t\t\t\tdata.forEach(item => {\n\t\t\t\t\titem[labelColumn] = webix.i18n.dateFormatStr(\n\t\t\t\t\t\tnew Date(item[labelColumn])\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class MenuPopup extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tpadding: 0,\n\t\t\tpoint: false,\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tborderless: true,\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\ttemplate: obj =>\n\t\t\t\t\t`<span class='webix_icon ${obj.icon}'></span>${obj.value}`,\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: [\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Edit\"),\n\t\t\t\t\t\tid: \"edit\",\n\t\t\t\t\t\ticon: \"rpi-square-edit-outline\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Create copy\"),\n\t\t\t\t\t\tid: \"copy\",\n\t\t\t\t\t\ticon: \"rpi-content-copy\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Delete\"),\n\t\t\t\t\t\tid: \"delete\",\n\t\t\t\t\t\ticon: \"rpi-delete\",\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\tthis.app.callEvent(\"onMenuAction\", [this.ID, id]);\n\t\t\t\t\t\tthis.getRoot().hide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tinit() {}\n\n\tShow(trg, id) {\n\t\tthis.ID = id;\n\t\twebix.delay(() => {\n\t\t\tif (this.getRoot()) this.getRoot().show(trg);\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport \"../helpers/rsearch\";\nimport MenuPopup from \"./menu\";\nimport { types } from \"../helpers/icons\";\n\nexport default class GridsView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst bar = {\n\t\t\tview: \"form\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\tpadding: { left: 10, right: 10, top: 5, bottom: 5 },\n\t\t\tmargin: 0,\n\t\t\tlocalId: \"bar\",\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: _(\"Reports\") },\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\tlocalId: \"nameSorting\",\n\t\t\t\t\ticon: \"rpi-sort-alphabetical-ascending\",\n\t\t\t\t\tcss: \"webix_rpt_sort_icon webix_rpt_btn_active\",\n\t\t\t\t\ticons: {\n\t\t\t\t\t\tasc: \"rpi-sort-alphabetical-ascending\",\n\t\t\t\t\t\tdesc: \"rpi-sort-alphabetical-descending\",\n\t\t\t\t\t},\n\t\t\t\t\tclick: () => this.Sort(\"name\"),\n\t\t\t\t},\n\t\t\t\t{ width: 4 },\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\tlocalId: \"updatedSorting\",\n\t\t\t\t\tcss: \"webix_rpt_sort_icon\",\n\t\t\t\t\ticon: \"rpi-sort-calendar-descending\",\n\t\t\t\t\ticons: {\n\t\t\t\t\t\tasc: \"rpi-sort-calendar-ascending\",\n\t\t\t\t\t\tdesc: \"rpi-sort-calendar-descending\",\n\t\t\t\t\t},\n\t\t\t\t\tclick: () => this.Sort(\"updated\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst menu = {\n\t\t\tview: \"form\",\n\t\t\tpadding: { left: 10, right: 10, top: 2, bottom: 4 },\n\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\tplaceholder: _(\"Type to search\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst table = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"list\",\n\t\t\tscroll: true,\n\t\t\tselect: true,\n\t\t\tcss: \"webix_rpt_list\",\n\t\t\ttype: {\n\t\t\t\theight: webix.skin.$active.rowHeight + 24,\n\t\t\t\ttemplate: data => this.GetListTemplate(data),\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$change: function(obj) {\n\t\t\t\t\tif (obj.date && typeof obj.date === \"string\")\n\t\t\t\t\t\tobj.date = new Date(obj.date);\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_action_menu: (e, id) => {\n\t\t\t\t\tthis.Menu.Show(e, id);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t},\n\t\t\tonDblClick: {},\n\t\t\ton: {\n\t\t\t\tonAfterSelect: id => this.LoadModule(id, null),\n\t\t\t\tonItemDblClick: id => this.LoadModule(id, \"edit\"),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\twidth: 320,\n\t\t\ttype: \"clean\",\n\t\t\trows: [bar, { type: \"clean\", rows: [menu, table] }],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Menu = this.ui(MenuPopup);\n\n\t\tconst list = this.$$(\"list\");\n\t\tlist.$view.firstChild.setAttribute(\"placeholder\", this._(\"No reports\"));\n\n\t\tconst mods = this.app.getService(\"local\").getModules();\n\t\tlist.sync(mods);\n\t\tmods.waitData.then(() => {\n\t\t\tif (this.State.moduleId) list.select(this.State.moduleId);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.$$(\"list\").refresh());\n\n\t\tthis.$$(\"search\").attachEvent(\"onSearchChange\", v => this.Find(v));\n\n\t\tthis.Sorting = { by: \"name\", dir: \"asc\" };\n\t}\n\n\tLoadModule(id, mode) {\n\t\tthis.app.callEvent(\"loadModule\", [id, mode]);\n\t}\n\n\tHide() {\n\t\tthis.app.callEvent(\"hideModuleList\");\n\t}\n\n\tFind() {\n\t\tlet text = this.$$(\"search\").getValue();\n\t\tconst list = this.$$(\"list\");\n\t\tif (text) {\n\t\t\ttext = text.toLowerCase();\n\t\t\tlist.filter(data => this.SearchCompare(text, data));\n\t\t} else {\n\t\t\tlist.filter();\n\t\t}\n\t}\n\tSearchCompare(value, item) {\n\t\treturn item.name.toLowerCase().indexOf(value) > -1;\n\t}\n\n\tGetListTemplate(item) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tlet html = \"<div class='webix_rpt_list_block'>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_list_report_name'>\" +\n\t\t\ttypes[item.parsed.type] +\n\t\t\t\" \" +\n\t\t\titem.name +\n\t\t\t\"</div>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_list_report_date'>\" +\n\t\t\t_(\"Last modified\") +\n\t\t\t\": \" +\n\t\t\twebix.i18n.longDateFormatStr(item.updated || new Date()) +\n\t\t\t\"</div>\";\n\t\tif (!this.State.readonly)\n\t\t\thtml +=\n\t\t\t\t\"<span class='webix_icon webix_rpt_action_menu rpi-dots-vertical'></span>\";\n\t\treturn html + \"</div>\";\n\t}\n\n\tSort(by) {\n\t\tlet sState = this.Sorting;\n\t\tconst prevState = webix.copy(sState);\n\t\tif (sState.by == by) sState.dir = sState.dir == \"desc\" ? \"asc\" : \"desc\";\n\t\telse {\n\t\t\tsState.by = by;\n\t\t\tsState.dir = \"desc\";\n\t\t}\n\t\tsState.as = by == \"updated\" ? \"date\" : \"string\";\n\t\tthis.ChangeSortButtons(sState, prevState);\n\t\tthis.$$(\"list\").sort(sState);\n\t}\n\n\tChangeSortButtons(state, prevState) {\n\t\tconst btn = this.$$(state.by + \"Sorting\");\n\n\t\tthis.webix.html.addCss(btn.$view, \"webix_rpt_btn_active\");\n\t\tbtn.config.icon = btn.config.icons[state.dir];\n\t\tbtn.refresh();\n\t\tif (state.by != prevState.by) {\n\t\t\tconst prevBtn = this.$$(prevState.by + \"Sorting\");\n\t\t\tthis.webix.html.removeCss(prevBtn.$view, \"webix_rpt_btn_active\");\n\t\t}\n\t}\n}\n","import BaseExportView from \"../common/export\";\n\nexport default class ExportView extends BaseExportView {\n\t/** Returns menu data */\n\tGetData() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ value: _(\"To Excel\"), id: \"excel\" },\n\t\t\t{ value: _(\"To CSV\"), id: \"csv\" },\n\t\t];\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport \"../../helpers/rsearch\";\nimport ExportMenu from \"./export\";\n\nexport default class ToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst bar = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"toolbar\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\thidden: true,\n\t\t\tpadding: { left: 10, right: 10, top: 6, bottom: 6 },\n\t\t\tmargin: 10,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\twidth: 140,\n\t\t\t\t\tlabel: _(\"Export\"),\n\t\t\t\t\ticon: \"rpi-export\",\n\t\t\t\t\tclick: viewId => this.ShowExportPopup(viewId),\n\t\t\t\t},\n\t\t\t\t{},\n\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\tplaceholder: _(\"Type to search\"),\n\t\t\t\t\tmaxWidth: 600,\n\t\t\t\t\tminWidth: 200,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn bar;\n\t}\n\n\tready() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.$$(\"search\").attachEvent(\n\t\t\t\"onSearchChange\",\n\t\t\tv => (this.State.search = v)\n\t\t);\n\t\tthis.on(this.app, \"onRecordsSearch\", (value, result) => {\n\t\t\tif (value) this.$$(\"search\").setBadge(result.length);\n\t\t\telse this.$$(\"search\").setBadge(null);\n\t\t});\n\t}\n\t/**\n\t * Shows menu\n\t * @param {String} viewId - webix view id\n\t */\n\tShowExportPopup(viewId) {\n\t\tif (!this.ExportMenu || !this.ExportMenu.$view)\n\t\t\tthis.ExportMenu = this.ui(ExportMenu);\n\t\tconst node = webix.$$(viewId);\n\t\tthis.ExportMenu.Show(node.$view);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { createState } from \"jet-restate\";\nimport Toolbar from \"./toolbar\";\n\nconst typeToSort = {\n\tnumber: \"int\",\n\tdate: \"date\",\n\ttext: \"string\",\n\tboolean: \"number\",\n\tpicklist: \"text\",\n\treference: \"text\",\n};\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst page = {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\t\t\tcols: [{}],\n\t\t};\n\n\t\treturn { rows: [Toolbar, page] };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.LocalState = createState({ search: \"\" });\n\t\tthis.setParam(\"state\", this.LocalState);\n\n\t\tthis.Local = this.app.getService(\"local\");\n\t}\n\tready() {\n\t\tconst parts = this.getRoot().getChildViews();\n\t\tthis.Bar = parts[0];\n\t\tthis.Host = parts[1];\n\n\t\tthis.on(this.State.$changes, \"module\", mod => this.Show(mod));\n\t\tthis.on(this.app, \"exportModule\", mode => this.Export(mode));\n\t\tthis.on(this.LocalState.$changes, \"search\", v => this.Find(v));\n\t}\n\n\tExport(mode) {\n\t\tconst params = {\n\t\t\tignore: { $selection: true },\n\t\t\tplainOutput: true,\n\t\t\tfilterHTML: true,\n\t\t};\n\t\tif (this.Table) {\n\t\t\tif (mode == \"excel\") webix.toExcel(this.Table, params);\n\t\t\telse if (mode == \"csv\") webix.toCSV(this.Table, params);\n\t\t}\n\t}\n\n\tShow(mod) {\n\t\tconst host = this.Host;\n\t\tif (mod && mod.columns.length && mod.type === \"table\") {\n\t\t\tconst config = this.GetTableConfig(mod);\n\t\t\tif (!config) return;\n\n\t\t\tthis.Bar.show();\n\t\t\twebix.ui([config], host);\n\t\t\tconst table = (this.Table = host.getChildViews()[0]);\n\n\t\t\tthis.GetTableData(mod).then(([data, options]) => {\n\t\t\t\t// table already reconstructed on moment of data loading\n\t\t\t\tif (table.$destructed) return;\n\t\t\t\toptions.forEach(({ field, data }) => {\n\t\t\t\t\tif (!this.IsBucketColumn(field))\n\t\t\t\t\t\ttable.getColumnConfig(field).collection.parse(data);\n\t\t\t\t});\n\t\t\t\ttable.parse(data);\n\t\t\t});\n\t\t} else {\n\t\t\twebix.ui([{}], host);\n\t\t\tthis.Table = null;\n\t\t\tthis.Bar.hide();\n\t\t}\n\t}\n\tIsBucketColumn(field, module) {\n\t\tmodule = module || this.State.module;\n\t\treturn module.buckets && module.buckets.find(b => b.column == field);\n\t}\n\tGetTableConfig(mod) {\n\t\tconst { groups, columns, meta } = mod;\n\t\tif (!columns) return null;\n\t\tlet dateColumns = [];\n\t\tconst gColumns = columns.map(a => {\n\t\t\tif (a.type == \"date\") dateColumns.push(a.id);\n\t\t\treturn this.GetColumnConfig(a);\n\t\t});\n\n\t\tconst edit = this.State.mode === \"edit\";\n\t\tconst grid = {\n\t\t\tview: groups ? \"treetable\" : \"datatable\",\n\t\t\tcolumns: gColumns,\n\t\t\tresizeColumn: edit ? { headerOnly: true } : false,\n\t\t\tleftSplit: meta.freeze ? meta.freeze : 0,\n\t\t\tcss: edit ? \"webix_header_border\" : \"\",\n\t\t\ton: {\n\t\t\t\tonColumnResize: (id, width, old, byUser) =>\n\t\t\t\t\tthis.SetColWidth(id, width, old, byUser),\n\t\t\t},\n\t\t};\n\n\t\tif (dateColumns.length)\n\t\t\tgrid.scheme = {\n\t\t\t\t$change: row =>\n\t\t\t\t\tdateColumns.forEach(cId => (row[cId] = new Date(row[cId]))),\n\t\t\t};\n\n\t\treturn grid;\n\t}\n\n\tGetColumnConfig(a) {\n\t\tlet column = {\n\t\t\tid: a.id,\n\t\t\theader:\n\t\t\t\t!a.meta.header || a.meta.header === \"none\"\n\t\t\t\t\t? a.meta.name || a.name\n\t\t\t\t\t: [\n\t\t\t\t\t\t\ta.meta.name || a.name,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontent:\n\t\t\t\t\t\t\t\t\ta.meta.header === \"text\" ? \"textFilter\" : \"richSelectFilter\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  ],\n\t\t\ttype: a.type,\n\t\t\tsort: typeToSort[a.type],\n\t\t\twidth: a.width || 200,\n\t\t};\n\n\t\tif (a.type === \"date\") column.format = webix.i18n.dateFormatStr;\n\t\tif (a.type === \"boolean\") {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tcolumn.template = obj => (obj[a.id] == 1 ? _(\"True\") : _(\"False\"));\n\t\t}\n\t\tif (\n\t\t\t(a.type === \"reference\" || a.type === \"picklist\") &&\n\t\t\t!this.IsBucketColumn(a.id)\n\t\t)\n\t\t\tcolumn.options = [];\n\n\t\treturn column;\n\t}\n\n\tSetColWidth(id, width, old, byUser) {\n\t\tif (byUser) {\n\t\t\tif (id === \"$selection\" || id === \"$subrow\") {\n\t\t\t\tconst table = this.Tbl;\n\t\t\t\ttable.blockEvent();\n\t\t\t\ttable.setColumnWidth(id, old);\n\t\t\t\ttable.unblockEvent();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.app.callEvent(\"onColumnResize\", [id, width]);\n\t\t}\n\t}\n\n\tGetTableData(mod) {\n\t\treturn Promise.all([\n\t\t\tthis.Local.getData(\n\t\t\t\tthis.Local.getDataConfig(mod),\n\t\t\t\tthis.State.mode == \"edit\"\n\t\t\t),\n\t\t\tthis.Local.getOptions(mod.columns),\n\t\t]);\n\t}\n\n\tFind(value) {\n\t\tconst h = this.app.getService(\"helpers\");\n\t\tconst table = this.Table;\n\t\tlet result = [];\n\t\tif (!table) return;\n\t\ttable.clearCss(\"webix_rpt_found_record\", true);\n\n\t\tif (value) {\n\t\t\tconst ignoreDateNumber = h.hasNonDigits(value);\n\t\t\tconst regexp = new RegExp(h.wildToRegexp(value), \"gi\");\n\t\t\tconst fields = table.config.columns.filter(\n\t\t\t\tc =>\n\t\t\t\t\t!(c.id === \"$selection\" || c.id === \"$subrow\") &&\n\t\t\t\t\t(!ignoreDateNumber || !(c.type === \"number\" || c.type === \"date\"))\n\t\t\t);\n\n\t\t\tconst matchers = [];\n\n\t\t\tfor (let i = 0; i < fields.length; ++i) {\n\t\t\t\tconst type = fields[i].type || \"text\";\n\t\t\t\tconst colId = fields[i].id;\n\t\t\t\tif (type === \"text\" || type === \"number\") {\n\t\t\t\t\tmatchers.push(o => regexp.test(o[colId]));\n\t\t\t\t} else if (type === \"reference\" || type === \"picklist\") {\n\t\t\t\t\tconst collection = table.getColumnConfig(colId).collection;\n\n\t\t\t\t\tconst optionsMatch = h.findOptions(collection, regexp);\n\t\t\t\t\tmatchers.push(h.matchPerColumn(colId, a => optionsMatch[a]));\n\t\t\t\t} else if (type === \"bool\") {\n\t\t\t\t\tswitch (value) {\n\t\t\t\t\t\tcase \"true\":\n\t\t\t\t\t\t\tmatchers.push(o => o[colId]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"false\":\n\t\t\t\t\t\t\tmatchers.push(o => !o[colId]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else if (type === \"date\") {\n\t\t\t\t\tconst dateFormats = table.getColumnConfig(colId).format;\n\t\t\t\t\tmatchers.push(o => regexp.test(dateFormats(o[colId])));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet found = false;\n\t\t\tresult = table.find(obj => {\n\t\t\t\tfor (let i = 0; i < matchers.length; ++i) {\n\t\t\t\t\tif (matchers[i](obj)) {\n\t\t\t\t\t\tif (!found) {\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\ttable.showItem(obj.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttable.addCss(obj.id, \"webix_rpt_found_record\", true);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\ttable.refresh();\n\t\tthis.app.callEvent(\"onRecordsSearch\", [value, result]);\n\t}\n}\n","export default function handler(view) {\n\treturn {\n\t\tattachEvent: (key, handler) => {\n\t\t\twebix.UIManager.addHotKey(key, handler, view);\n\t\t\treturn { key, handler };\n\t\t},\n\t\tdetachEvent: ({ key, handler }) =>\n\t\t\twebix.UIManager.removeHotKey(key, handler, view),\n\t};\n}\n","import { JetView } from \"webix-jet\";\nimport key from \"jet-hotkey\";\n\nexport default class TopBarView extends JetView {\n\tconfig() {\n\t\tconst app = this.app;\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst bar = {\n\t\t\tview: \"toolbar\",\n\t\t\tlocalId: \"bar\",\n\t\t\tpadding: { left: 10, right: 10, top: 6, bottom: 6 },\n\t\t\tmargin: 10,\n\t\t\tvisibleBatch: \"default\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"defaultButtons\",\n\t\t\t\t\tmargin: 10,\n\t\t\t\t\twidth: 300,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"toggle\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\tlabel: _(\"All reports\"),\n\t\t\t\t\t\t\tlocalId: \"list\",\n\t\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\t\toffIcon: \"rpi-menu\",\n\t\t\t\t\t\t\tonIcon: \"rpi-menu-open\",\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\t\t\tapp.callEvent(\"showModules\", [this.getValue()]);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\tlocalId: \"newBtn\",\n\t\t\t\t\t\t\t//css: \"webix_primary\",\n\t\t\t\t\t\t\ticon: \"rpi-plus\",\n\t\t\t\t\t\t\tlabel: _(\"New\"),\n\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\tthis.$$(\"bar\").showBatch(\"edit\");\n\t\t\t\t\t\t\t\tapp.callEvent(\"loadModule\", [null, \"edit\"]);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{ width: 300, batch: \"edit\" },\n\t\t\t\t{ view: \"label\", localId: \"name\", align: \"center\", label: \"\" },\n\t\t\t\t{ width: 330, batch: \"default\" },\n\n\t\t\t\t{\n\t\t\t\t\tbatch: \"report\",\n\t\t\t\t\twidth: 290,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\talign: \"right\",\n\t\t\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\t\t\ticon: \"wxi-pencil\",\n\t\t\t\t\t\t\tlabel: _(\"Edit\"),\n\t\t\t\t\t\t\twidth: 140,\n\t\t\t\t\t\t\tclick: () => app.callEvent(\"onMenuAction\", [null, \"edit\"]),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twidth: 290,\n\t\t\t\t\tbatch: \"edit\",\n\t\t\t\t\tmargin: 10,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\ticon: \"rpi-close\",\n\t\t\t\t\t\t\tlabel: _(\"Cancel\"),\n\t\t\t\t\t\t\tlocalId: \"reset\",\n\t\t\t\t\t\t\t//disabled: true,\n\t\t\t\t\t\t\tclick: () => app.callEvent(\"resetModule\", []),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-check\",\n\t\t\t\t\t\t\tlocalId: \"save\",\n\t\t\t\t\t\t\twidth: 140,\n\t\t\t\t\t\t\tlabel: _(\"Save\"),\n\t\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\t\tclick: () => app.callEvent(\"saveModule\", []),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\n\t\t\t\t{ popup: true, $subview: true, name: \"popup\" },\n\t\t\t],\n\t\t};\n\n\t\treturn bar;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"module\", mod => {\n\t\t\tif (mod) {\n\t\t\t\tif (typeof mod.name != \"undefined\") this.$$(\"name\").setValue(mod.name);\n\t\t\t\telse if (this.State.moduleId)\n\t\t\t\t\tthis.app\n\t\t\t\t\t\t.getService(\"local\")\n\t\t\t\t\t\t.getModule(this.State.moduleId)\n\t\t\t\t\t\t.then(module => {\n\t\t\t\t\t\t\tthis.$$(\"name\").setValue(module.name);\n\t\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.$$(\"name\").setValue(\"\");\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"saved\", v => {\n\t\t\tconst name = this.$$(\"name\").$view;\n\t\t\tif (v) {\n\t\t\t\tthis.$$(\"save\").disable();\n\t\t\t\t//this.$$(\"reset\").disable();\n\t\t\t\tname.classList.remove(\"webix_rpt_not_saved\");\n\t\t\t} else {\n\t\t\t\tthis.$$(\"save\").enable();\n\t\t\t\t//this.$$(\"reset\").enable();\n\t\t\t\tname.classList.add(\"webix_rpt_not_saved\");\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", () => this.SetVisibleButtons());\n\t\tthis.on(this.State.$changes, \"moduleId\", () => this.SetVisibleButtons());\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.SetVisibleButtons());\n\n\t\tthis.on(key(), \"ctrl+e\", () => {\n\t\t\tthis.app.callEvent(\"onMenuAction\", [null, \"edit\"]);\n\t\t\treturn false;\n\t\t});\n\n\t\tthis.on(key(), \"ctrl+s\", () => {\n\t\t\tthis.app.callEvent(\"saveModule\", []);\n\t\t\treturn false;\n\t\t});\n\n\t\tthis.on(key(), \"ctrl+l\", () => {\n\t\t\tthis.app.callEvent(\"showModules\", [true]);\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tSetVisibleButtons() {\n\t\tconst mode = this.State.mode;\n\t\tif (mode == \"list\") {\n\t\t\tthis.$$(\"list\").setValue(true);\n\t\t} else {\n\t\t\tthis.$$(\"list\").setValue(false);\n\t\t}\n\t\tif (mode == \"edit\") {\n\t\t\tthis.$$(\"defaultButtons\").hide();\n\t\t\tthis.$$(\"bar\").showBatch(\"edit\");\n\t\t} else {\n\t\t\tthis.$$(\"defaultButtons\").show();\n\t\t\tif (this.State.moduleId && !this.State.readonly) {\n\t\t\t\tthis.$$(\"bar\").showBatch(\"report\");\n\t\t\t} else {\n\t\t\t\tthis.$$(\"bar\").showBatch(\"default\");\n\t\t\t}\n\t\t}\n\t\tconst newBtn = this.$$(\"newBtn\");\n\t\tif (newBtn) {\n\t\t\tif (this.State.readonly) {\n\t\t\t\tif (newBtn.isVisible()) newBtn.hide();\n\t\t\t} else if (!newBtn.isVisible()) {\n\t\t\t\tnewBtn.show();\n\t\t\t}\n\t\t}\n\t}\n\n\tTitleTemplate(data) {\n\t\treturn `<div class=\"rep_title\">${data.name}</div>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TopView extends JetView {\n\tconfig() {\n\t\tconst page = {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\t$subview: true,\n\t\t\t\t\tname: \"left\",\n\t\t\t\t},\n\t\t\t\t{ $subview: true, name: \"right\", css: \"webix_rpt_right\" },\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\t\t\tcss: \"webix_reports\",\n\t\t\trows: [{ $subview: true, name: \"top\" }, page],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getParam(\"state\");\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tthis.on(this.State.$changes, \"toolbar\", v => {\n\t\t\tthis.show(v ? \"toolbar\" : \"_hidden\", { target: \"top\" });\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", v => {\n\t\t\tif (v === \"edit\") this.show(\"./editor\", { target: \"left\" });\n\t\t\telse if (v === \"list\") this.show(\"./modules\", { target: \"left\" });\n\t\t\telse this.show(\"_hidden\", { target: \"left\" });\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"moduleId\", id => {\n\t\t\tif (id)\n\t\t\t\tthis.app\n\t\t\t\t\t.getService(\"local\")\n\t\t\t\t\t.getModule(id)\n\t\t\t\t\t.then(mod => {\n\t\t\t\t\t\tthis.State.module = JSON.parse(mod.text);\n\t\t\t\t\t});\n\t\t\telse this.State.module = null;\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"module\", mod => {\n\t\t\tlet type = (mod ? mod.type : \"empty\") || \"table\";\n\t\t\tthis.show(\"./\" + type, { target: \"right\" });\n\t\t});\n\n\t\tthis.on(this.app, \"loadModule\", (id, mode) => this.LoadModule(id, mode));\n\n\t\tthis.on(this.app, \"onMenuAction\", (id, action) => {\n\t\t\tif (!id && this.State.moduleId) id = this.State.moduleId;\n\t\t\tif (!id) return;\n\n\t\t\tif (action === \"edit\") {\n\t\t\t\tthis.LoadModule(id, \"edit\");\n\t\t\t} else if (action === \"delete\") {\n\t\t\t\twebix\n\t\t\t\t\t.confirm({\n\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t\ttitle: _(\"Delete report\"),\n\t\t\t\t\t\tok: _(\"Delete\"),\n\t\t\t\t\t\tcancel: _(\"Cancel\"),\n\t\t\t\t\t\ttext: _(\"Are you sure to delete this report?\"),\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.app\n\t\t\t\t\t\t\t.getService(\"operations\")\n\t\t\t\t\t\t\t.deleteModule(id)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tif (id == this.State.moduleId)\n\t\t\t\t\t\t\t\t\tthis.State.$batch({ moduleId: null, mode: \"list\" });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t} else if (action === \"copy\") {\n\t\t\t\tthis.app\n\t\t\t\t\t.getService(\"operations\")\n\t\t\t\t\t.copyModule(id)\n\t\t\t\t\t.then(id => {\n\t\t\t\t\t\tthis.State.$batch({ moduleId: id, mode: \"edit\" });\n\t\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.app, \"showModules\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.State.mode = \"list\";\n\t\t\t} else if (this.State.mode == \"list\") {\n\t\t\t\tthis.State.mode = \"view\";\n\t\t\t}\n\t\t});\n\t}\n\n\tLoadModule(id, mode) {\n\t\tthis.State.moduleId = id;\n\t\tif (mode) this.State.mode = mode;\n\t}\n}\n","import m0 from \"./views/chart\";\nimport m1 from \"./views/common/export\";\nimport m2 from \"./views/common/toolbar\";\nimport m3 from \"./views/editor/common\";\nimport m4 from \"./views/editor/data\";\nimport m5 from \"./views/editor/index.js\";\nimport m6 from \"./views/editor/other/bucket\";\nimport m7 from \"./views/editor/other/bucketpopup\";\nimport m8 from \"./views/editor/other/buckets\";\nimport m9 from \"./views/editor/other/datepopup\";\nimport m10 from \"./views/editor/other/groups\";\nimport m11 from \"./views/editor/other/index.js\";\nimport m12 from \"./views/editor/other/sorts\";\nimport m13 from \"./views/editor/other/summary\";\nimport m14 from \"./views/editor/other/summarypopup\";\nimport m15 from \"./views/editor/query\";\nimport m16 from \"./views/editor/structure/axis\";\nimport m17 from \"./views/editor/structure/baseview\";\nimport m18 from \"./views/editor/structure/chart\";\nimport m19 from \"./views/editor/structure/chartseries\";\nimport m20 from \"./views/editor/structure/colorpopup\";\nimport m21 from \"./views/editor/structure/column\";\nimport m22 from \"./views/editor/structure/heatmap\";\nimport m23 from \"./views/editor/structure/index.js\";\nimport m24 from \"./views/editor/structure/table\";\nimport m25 from \"./views/empty\";\nimport m26 from \"./views/heatmap\";\nimport m27 from \"./views/menu\";\nimport m28 from \"./views/modules\";\nimport m29 from \"./views/table/export\";\nimport m30 from \"./views/table/index.js\";\nimport m31 from \"./views/table/toolbar\";\nimport m32 from \"./views/toolbar\";\nimport m33 from \"./views/top\";\nimport { JetView } from \"webix-jet\";\n\nconst views = { JetView };\nviews[\"chart\"] = m0;\nviews[\"common/export\"] = m1;\nviews[\"common/toolbar\"] = m2;\nviews[\"editor/common\"] = m3;\nviews[\"editor/data\"] = m4;\nviews[\"editor\"] = m5;\nviews[\"editor/other/bucket\"] = m6;\nviews[\"editor/other/bucketpopup\"] = m7;\nviews[\"editor/other/buckets\"] = m8;\nviews[\"editor/other/datepopup\"] = m9;\nviews[\"editor/other/groups\"] = m10;\nviews[\"editor/other\"] = m11;\nviews[\"editor/other/sorts\"] = m12;\nviews[\"editor/other/summary\"] = m13;\nviews[\"editor/other/summarypopup\"] = m14;\nviews[\"editor/query\"] = m15;\nviews[\"editor/structure/axis\"] = m16;\nviews[\"editor/structure/baseview\"] = m17;\nviews[\"editor/structure/chart\"] = m18;\nviews[\"editor/structure/chartseries\"] = m19;\nviews[\"editor/structure/colorpopup\"] = m20;\nviews[\"editor/structure/column\"] = m21;\nviews[\"editor/structure/heatmap\"] = m22;\nviews[\"editor/structure\"] = m23;\nviews[\"editor/structure/table\"] = m24;\nviews[\"empty\"] = m25;\nviews[\"heatmap\"] = m26;\nviews[\"menu\"] = m27;\nviews[\"modules\"] = m28;\nviews[\"table/export\"] = m29;\nviews[\"table\"] = m30;\nviews[\"table/toolbar\"] = m31;\nviews[\"toolbar\"] = m32;\nviews[\"top\"] = m33;\n\nexport default views;\n","export function initJetWin(app) {\n\tlet appId;\n\n\tconst service = {\n\t\tupdateConfig(config){\n\t\t\tconst appView = app.getRoot();\n\t\t\tconst appNode = appView.$view;\n\n\t\t\tif(!appId){\n\t\t\t\tif(appNode.id)\n\t\t\t\t\tappId = appNode.id;\n\t\t\t\telse \n\t\t\t\t\tappNode.id = appId = \"webix_\" + webix.uid();\n\n\t\t\t\twebix.html.addStyle(`.webix_win_inside *:not(.webix_modal_box):not(.webix_modal_cover){ z-index: 0; }`);\n\t\t\t\twebix.html.addStyle(`#${appId}{ position: relative; }`);\n\t\t\t\twebix.html.addStyle(`#${appId} .webix_window{ z-index:2 !important; }`);\n\t\t\t\twebix.html.addStyle(`#${appId} .webix_disabled{ z-index:1 !important; }`);\n\t\t\t}\n\t\t\telse if(appId && !appNode.id) //app refresh\n\t\t\t\tappNode.id = appId;\n\n\t\t\tconfig.container = appId;\n\n\t\t\tif(config.fullscreen){\n\t\t\t\tconfig._fillApp = true;\n\t\t\t\tdelete config.fullscreen;\n\t\t\t}\n\n\t\t\tif(!config.on)\n\t\t\t\tconfig.on = {};\n\n\t\t\tlet firstShow = true;\n\t\t\tconst defaultHandler = config.on.onShow;\n\n\t\t\tconfig.on.onShow = function(){\n\t\t\t\tif(defaultHandler)\n\t\t\t\t\tdefaultHandler.apply(this, arguments);\n\n\t\t\t\tif(firstShow){\n\t\t\t\t\tthis.$setSize = (x, y) => {\n\t\t\t\t\t\tsetSize(this, appView, true);\n\t\t\t\t\t\twebix.ui.window.prototype.$setSize.apply(this, [x, y]);\n\t\t\t\t\t};\n\t\t\t\t\tsetHandlers(this, app);\n\t\t\t\t\tfirstShow = null;\n\t\t\t\t}\n\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\twebix.html.addCss(appNode, \"webix_win_inside\");\n\t\t\t\tappView.disable();\n\n\t\t\t\tsetSize(this, appView);\n\t\t\t}\n\n\t\t\treturn config;\n\t\t}\n\t};\n\n\tapp.setService(\"jet-win\", service);\n}\n\nfunction setSize(win, appView, silent){\n\tconst appWidth = appView.$width;\n\tconst appHeight = appView.$height;\n\n\tif(win.config._fillApp)\n\t\twin.define({\n\t\t\twidth: appWidth,\n\t\t\theight: appHeight,\n\t\t});\n\telse {\n\t\twin.define({\n\t\t\tleft: (appWidth - win.$width) / 2,\n\t\t\ttop: (appHeight - win.$height) / 2,\n\t\t});\n\t}\n\n\tif(!silent)\n\t\twin.resize();\n}\n\nfunction setHandlers(win, app){\n\tconst appView = app.getRoot();\n\n\twin.attachEvent(\"onHide\", ()=> {\n\t\tif(!appView.$destructed){\n\t\t\twebix.html.removeCss(appView.$view, \"webix_win_inside\");\n\t\t\tappView.enable();\n\t\t}\n\t});\n\n\tconst resizeEv = app.attachEvent(\"view:resize\", ()=> {\n\t\tsetSize(win, appView);\n\t});\n\n\twin.attachEvent(\"onDestruct\", ()=> {\n\t\tapp.detachEvent(resizeEv);\n\t});\n}\n","export default class Local {\n\tconstructor(_app) {\n\t\tthis._app = _app;\n\n\t\tthis._fieldData = new Map();\n\t\tthis._optionsData = new Map();\n\t\tthis._data = new Map();\n\t}\n\n\tready(obj) {\n\t\treturn this.getModels().then(() => obj);\n\t}\n\n\t/**\n\t * Gets DataCollection with modules data\n\t * @returns {webix.DataCollection}\n\t */\n\tgetModules() {\n\t\tif (!this._modules) {\n\t\t\tthis._modules = new webix.DataCollection({\n\t\t\t\tscheme: {\n\t\t\t\t\t$change: obj => {\n\t\t\t\t\t\tobj.value = obj.name;\n\t\t\t\t\t\tobj.parsed = JSON.parse(obj.text);\n\t\t\t\t\t\tif (typeof obj.updated === \"string\")\n\t\t\t\t\t\t\tobj.updated = new Date(obj.updated);\n\t\t\t\t\t},\n\t\t\t\t\t$sort: {\n\t\t\t\t\t\tby: \"name\",\n\t\t\t\t\t\tdir: \"asc\",\n\t\t\t\t\t\tas: \"string\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t\tconst modules = this._app\n\t\t\t\t.getService(\"backend\")\n\t\t\t\t.getModules()\n\t\t\t\t.then(data => data.filter(a => a.text));\n\t\t\tthis._modules.parse(modules);\n\t\t}\n\n\t\treturn this._modules;\n\t}\n\t/**\n\t * Gets a module data object\n\t * @param {number} id - a module id\n\t * @returns {Promise} Promise that is resolved with module item\n\t */\n\tgetModule(id) {\n\t\tconst mods = this.getModules();\n\t\treturn mods.waitData.then(() => this._modules.getItem(id));\n\t}\n\n\t/**\n\t * Gets hash of data sources (or promise that is resolved with the hash)\n\t * @param {boolean} now - if true returns the hash directly\n\t * @returns {Promise | Object} a promise that is resolved with a hash of data  sources or the hash directly\n\t */\n\tgetModels(now) {\n\t\tif (now) return this._models || {};\n\n\t\tif (!this._models_async) {\n\t\t\tthis._models_async = this._app\n\t\t\t\t.getService(\"backend\")\n\t\t\t\t.getModels()\n\t\t\t\t.then(models => {\n\t\t\t\t\tconst refs = {};\n\t\t\t\t\tObject.keys(models).forEach(m => {\n\t\t\t\t\t\tconst obj = models[m];\n\t\t\t\t\t\tobj.data.forEach(f => {\n\t\t\t\t\t\t\tif (f.type == \"reference\") {\n\t\t\t\t\t\t\t\tif (!refs[m]) refs[m] = [];\n\t\t\t\t\t\t\t\tif (!refs[f.ref]) refs[f.ref] = [];\n\t\t\t\t\t\t\t\tconst id = `${m}/${f.id}//${f.ref}`;\n\t\t\t\t\t\t\t\trefs[m].push({ sid: m, tid: f.ref, sf: f.id, id });\n\t\t\t\t\t\t\t\trefs[f.ref].push({ sid: f.ref, tid: m, tf: f.id, id });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tthis._refs = refs;\n\t\t\t\t\tthis._models = models;\n\t\t\t\t\treturn models;\n\t\t\t\t});\n\t\t}\n\n\t\treturn this._models_async;\n\t}\n\t/**\n\t * Gets a hash of data references\n\t * @returns {Object} a hash of data references\n\t */\n\tgetRefs() {\n\t\treturn this._refs;\n\t}\n\n\t/**\n\t * Gets a model object\n\t * @param {number} id - a model id\n\t * @returns {Object} a model object\n\t */\n\tgetModel(id) {\n\t\treturn this._models[id];\n\t}\n\n\t/**\n\t *  Gets an array of field values\n\t * @param {number} field - a field id\n\t * @param {string} type - a field type (e.g. \"date\")\n\t * @returns {Promise} a promise that is resolved with an array field values\n\t */\n\tgetFieldData(field, type) {\n\t\tconst id = field;\n\t\tlet list = this._fieldData.get(id);\n\t\tif (list) return list;\n\n\t\tlist = this._app\n\t\t\t.getService(\"backend\")\n\t\t\t.getFieldData(field)\n\t\t\t.then(list => {\n\t\t\t\tif (type === \"date\") list = list.map(a => new Date(a));\n\t\t\t\treturn list;\n\t\t\t});\n\t\tthis._fieldData.set(id, list);\n\t\treturn list;\n\t}\n\n\t/**\n\t * Gets an array of fields\n\t * @param {number} data - the id of a data source (model)\n\t * @param {array} joins - an array of model joins\n\t * @param {boolean} major -  if true, adds all fields from joined data source (model)\n\t * @returns {array} an array of fields\n\t */\n\tgetFields(data, joins, major) {\n\t\tconst m = this._models;\n\t\tconst fields = [];\n\n\t\tm[data].data.forEach(a => fields.push(this.newField(m[data], a)));\n\t\tjoins.forEach(j =>\n\t\t\tm[j.tid].data.forEach(a => {\n\t\t\t\tif (!major || a.show) fields.push(this.newField(m[j.tid], a));\n\t\t\t})\n\t\t);\n\n\t\treturn fields;\n\t}\n\n\t/**\n\t * Applies a data source\n\t * @param {number} id - a data source id\n\t * @returns {Object} object with module properties\n\t */\n\tsetDataSource(id) {\n\t\tconst columns = this.getFields(id, []);\n\n\t\treturn {\n\t\t\tquery: \"\",\n\t\t\tsort: null,\n\t\t\tfields: columns,\n\t\t\tcolumns: [...columns],\n\t\t\toldColumns: null,\n\t\t\tgroup: null,\n\t\t\tjoins: [],\n\t\t\tbuckets: null,\n\t\t};\n\t}\n\n\t/**\n\t * Returns a new field object\n\t * @param {Object} model - a model object\n\t * @param {Object} col - a column object\n\t * @returns {Object}\n\t */\n\tnewField(model, col) {\n\t\tconst obj = {\n\t\t\tid: model.id + \".\" + col.id,\n\t\t\tname: col.name,\n\t\t\ttype: col.type,\n\t\t\tref: col.ref,\n\n\t\t\tmid: model.id,\n\t\t\tmodel: model.name,\n\n\t\t\tmeta: {},\n\t\t};\n\n\t\tif (col.key) obj.key = true;\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Returns a new module object\n\t * @param {string} type - a module type ( \"table\", \"chart\", ... )\n\t * @returns {Object}\n\t */\n\tnewModule(type) {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\t\tconst name = _(\"New report\");\n\t\tconst desc = _(\"Created on\") + \" \" + webix.i18n.dateFormatStr(new Date());\n\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tname,\n\t\t\tdesc,\n\t\t\tjoins: [],\n\t\t\tquery: \"\",\n\t\t\tsort: null,\n\t\t\tcolumns: [],\n\t\t\tfields: [],\n\t\t\tpublicFields: null,\n\t\t\tgroup: null,\n\t\t\tbuckets: null,\n\t\t\tmeta: {},\n\t\t\tdata: Object.keys(this._models)[0],\n\t\t\ttype: type || \"table\",\n\t\t};\n\t}\n\n\t/**\n\t * Adds model join (applies to fields and columns props)\n\t * @param {number} id - the id of a model to join\n\t * @param {Object} config - module config\n\t * @returns {{columns: Array, fields: Array}} updated fields and columns props\n\t */\n\taddJoin(id, config) {\n\t\tconst model = this._models[id];\n\t\tconst { fields, columns, group } = config;\n\t\tmodel.data.forEach(a => {\n\t\t\tfields.push(this.newField(model, a));\n\t\t\tif (a.show && !group) columns.push(this.newField(model, a));\n\t\t});\n\t\treturn { fields, columns };\n\t}\n\n\t/**\n\t * Gets module data\n\t * @param {object} config - a hash of properties for data selection (the result of getDataConfig)\n\t * @param {boolean} limit - adds \"limit\" property to config\n\t * @returns {Promise}\n\t */\n\tgetData(config, limit) {\n\t\tlet id = JSON.stringify(config);\n\t\tlet list = this._data.get(id);\n\t\tif (list) return list;\n\n\t\tif (limit) {\n\t\t\tconfig.limit = 30;\n\t\t\tid = JSON.stringify(config);\n\t\t\tlist = this._data.get(id);\n\t\t\tif (list) return list;\n\t\t}\n\n\t\tlist = this._app.getService(\"backend\").getData(config);\n\t\tthis._data.set(id, list);\n\t\treturn list;\n\t}\n\t/**\n\t * Gets a hash of properties for data loading\n\t * @param {object} module - a hash of module properties\n\t * @returns {object}\n\t */\n\tgetDataConfig(module) {\n\t\treturn {\n\t\t\tdata: module.data,\n\t\t\tquery: module.query,\n\t\t\t// sort is necessary to enforce data caching for request with different column order\n\t\t\tcolumns: module.columns.map(a => a.id).sort(),\n\t\t\tjoins: module.joins,\n\t\t\tsort: module.sort,\n\t\t\tgroup:\n\t\t\t\tmodule.group && module.group.by\n\t\t\t\t\t? module.group.by.map(a => (a.mod ? a.mod + \".\" : \"\") + a.id)\n\t\t\t\t\t: \"\",\n\t\t\tbuckets: module.buckets,\n\t\t};\n\t}\n\n\t/**\n\t * Gets options for columns\n\t * @param {array} columns - an array of columns\n\t * @returns {Promise} a promise that is resolved with an array of options lists\n\t */\n\tgetOptions(columns) {\n\t\tconst options = columns\n\t\t\t.filter(a => a.type === \"picklist\" || a.type === \"reference\")\n\t\t\t.map(a => this.getOptionsList(a.id));\n\n\t\treturn Promise.all(options);\n\t}\n\n\t/**\n\t * Gets an options list for a field\n\t * @param {number} field - a field id\n\t * @returns {Promise} a promise that is resolved with an object {field:<Number>}, data:<Array>}\n\t */\n\tgetOptionsList(field) {\n\t\tlet list = this._optionsData.get(field);\n\t\tif (list) return list.then(data => ({ field, data }));\n\n\t\tlist = this._app.getService(\"backend\").getOptions(field);\n\t\tthis._optionsData.set(field, list);\n\t\treturn list.then(data => ({ field, data }));\n\t}\n\n\t/**\n\t * Gets models that a base model can be linked with\n\t * @param {number} base - the base model\n\t * @param {boolean} onlyNew - if true, include only new models\n\t * @returns {Array} an array of models that the base model can be linked with\n\t */\n\tgetLinkedModels(base, onlyNew) {\n\t\tconst out = [];\n\t\tconst refs = this.getRefs();\n\n\t\tfor (var i = 0; i < base.length; i++) {\n\t\t\tconst sid = base[i];\n\t\t\tif (!refs[sid]) continue;\n\n\t\t\trefs[sid].forEach(ref => {\n\t\t\t\tif (onlyNew && base.indexOf(ref.tid) != -1) return;\n\t\t\t\tout.push({ ...ref });\n\t\t\t});\n\t\t}\n\n\t\treturn out;\n\t}\n\n\t/**\n\t * Cleans models join if it is not blocked\n\t * @param {number} id - model join to delete\n\t * @param {Object} config - a module config\n\t * @returns {Object} an object with updated module properties or with \"blocked\" hash\n\t */\n\tcleanLinkedModels(id, config) {\n\t\tlet { data, joins, fields, columns, query, group, publicFields } = config;\n\t\tconst was = { [data]: 1 };\n\t\tlet next,\n\t\t\torigin = joins,\n\t\t\tlinks = [];\n\n\t\tjoins = next = joins.filter(a => a.id != id);\n\t\tdo {\n\t\t\tjoins = next;\n\t\t\tnext = [];\n\n\t\t\tfor (let i = 0; i < joins.length; i++) {\n\t\t\t\tif (was[joins[i].sid]) was[joins[i].tid] = 1;\n\t\t\t\telse next.push(joins[i]);\n\t\t\t}\n\t\t} while (next.length && next.length !== joins.length);\n\n\t\tlet queryObj = query ? collectTables(JSON.parse(query)) : [];\n\t\tfor (let i = 0; i < origin.length; i++) {\n\t\t\tconst j = origin[i];\n\t\t\tif (was[j.tid]) {\n\t\t\t\tlinks.push(j);\n\t\t\t} else {\n\t\t\t\t// can't remove table if it already used in filters\n\t\t\t\tif (queryObj.indexOf(j.tid) !== -1) return { block: { filter: 1 } };\n\t\t\t\tif (group) {\n\t\t\t\t\tconst check = \".\" + j.tid + \".\";\n\t\t\t\t\t// [FIXME] add model prop for group custom fields\n\t\t\t\t\tif (publicFields.find(a => a.id.indexOf(check) != -1))\n\t\t\t\t\t\treturn { block: { group: 1 } };\n\t\t\t\t}\n\t\t\t\tcolumns = columns.filter(a => a.mid != j.tid);\n\t\t\t\tfields = fields.filter(a => a.mid != j.tid);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tjoins: links,\n\t\t\tcolumns,\n\t\t\tfields,\n\t\t};\n\t}\n\n\t/**\n\t * Gets DataCollection with queries\n\t * @returns {webix.DataCollection}\n\t */\n\tgetQueries() {\n\t\tif (this._queries) return this._queries;\n\n\t\treturn (this._queries = new webix.DataCollection({\n\t\t\tscheme: {\n\t\t\t\t$change: obj => {\n\t\t\t\t\tobj.value = obj.name;\n\t\t\t\t\tobj.models = obj.text ? collectTables(JSON.parse(obj.text)) : [];\n\t\t\t\t},\n\t\t\t},\n\t\t\tdata: this._app.getService(\"backend\").getQueries(),\n\t\t}));\n\t}\n}\n\nfunction collectTables(q, mods) {\n\tmods = mods || [];\n\tif (q.rules)\n\t\tq.rules.forEach(r => {\n\t\t\tif (r.rules) collectTables(r, mods);\n\t\t\telse {\n\t\t\t\tconst parts = r.field.split(\".\");\n\t\t\t\tmods.push(parts[0]);\n\t\t\t}\n\t\t});\n\treturn mods;\n}\n","export default class Backend {\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis._url = app.config.url;\n\t}\n\n\t//\n\t// QUERIES\n\t//\n\n\t/**\n\t * A request to get a json array of queries\n\t * @returns {Promise} a promise that is resolved with json array [{id: <number>,..},...]\n\t */\n\tgetQueries() {\n\t\treturn webix.ajax(`${this._url}api/queries`).then(a => a.json());\n\t}\n\t/**\n\t * A request to add a new query\n\t * @param {object} data - a query data object\n\t * @returns {Promise} a promise that is resolved with json {id: <number>}\n\t */\n\taddQuery(data) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.post(`${this._url}api/queries`, data)\n\t\t\t.then(a => a.json());\n\t}\n\t/**\n\t * A request to update new queryA request to update a query\n\t * @param {number} id - a query id\n\t * @param {object} data - a query data object\n\t * @returns {Promise} a promise that is resolved with json {id: <number>}\n\t */\n\tupdateQuery(id, data) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.put(`${this._url}api/queries/${id}`, data)\n\t\t\t.then(a => a.json());\n\t}\n\n\t/**\n\t * A request to delete a query\n\t * @param {number} id - a query id\n\t * @returns {Promise} a promise that is resolved with json {id: <number>}\n\t */\n\tdeleteQuery(id) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.del(`${this._url}api/queries/${id}`)\n\t\t\t.then(a => a.json());\n\t}\n\n\t//\n\t// MODULES\n\t//\n\n\t/**\n\t * A request to get a json array of modules\n\t * @returns {Promise} a promise that is resolved with json array [{id: <number>,..},...]\n\t */\n\tgetModules() {\n\t\treturn webix.ajax(`${this._url}api/modules`).then(a => a.json());\n\t}\n\t/**\n\t * A request to add a new module\n\t * @param {object} data - a module data object\n\t * @returns {Promise} a promise that is resolved with json {id: <number>}\n\t */\n\taddModule(data) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.post(`${this._url}api/modules`, data)\n\t\t\t.then(a => a.json());\n\t}\n\t/**\n\t * A request to update a module\n\t * @param {number} id - a module id\n\t * @param {object} data - a module data object\n\t * @returns {Promise} a promise that is resolved with json {id: <number>}\n\t */\n\tupdateModule(id, data) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.put(`${this._url}api/modules/${id}`, data)\n\t\t\t.then(a => a.json());\n\t}\n\t/**\n\t * A request to delete a module\n\t * @param {number} id - a module id\n\t * @returns {Promise} a promise that is resolved with json {id: <number>}\n\t */\n\tdeleteModule(id) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.del(`${this._url}api/modules/${id}`)\n\t\t\t.then(a => a.json());\n\t}\n\n\t//\n\t// Meta info\n\t//\n\n\t/**\n\t * A request to get a hash of data sources\n\t * @returns {Promise} a promise that is resolved with json object { data0: {id: data0, ...}, ...}\n\t */\n\tgetModels() {\n\t\treturn webix.ajax(`${this._url}api/objects`).then(a => a.json());\n\t}\n\n\t/**\n\t *  A request to get a json array of report data\n\t * @param {Object} config - an object that contains module properties\n\t * @returns {Promise} a promise that is resolved with json array\n\t */\n\tgetData(config) {\n\t\tconst { query, columns, joins, limit, group, sort, buckets } = config;\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.post(`${this._url}api/objects/${config.data}/data`, {\n\t\t\t\tquery,\n\t\t\t\tcolumns,\n\t\t\t\tjoins,\n\t\t\t\tlimit,\n\t\t\t\tsort,\n\t\t\t\tgroup,\n\t\t\t\tbuckets,\n\t\t\t})\n\t\t\t.then(a => a.json());\n\t}\n\n\t/**\n\t *  A request to get a json array of field options\n\t * @param {string} field - a field id\n\t * @returns {Promise} a promise that is resolved with json array\n\t */\n\tgetOptions(field) {\n\t\treturn webix\n\t\t\t.ajax(`${this._url}api/fields/${field}/options`)\n\t\t\t.then(a => a.json());\n\t}\n\n\t/**\n\t *  A request to get an array of field values\n\t * @param {string} field - a field id\n\t * @returns {Promise} a promise that is resolved with json\n\t */\n\tgetFieldData(field) {\n\t\treturn webix\n\t\t\t.ajax(`${this._url}api/fields/${field}/suggest`)\n\t\t\t.then(a => a.json());\n\t}\n}\n","export default class Local {\n\tconstructor(_app) {\n\t\tthis._app = _app;\n\n\t\tthis._local = _app.getService(\"local\");\n\t\tthis._back = _app.getService(\"backend\");\n\t}\n\n\t/**\n\t * Deletes a module\n\t * @param {number} id - a module id\n\t * @returns {Promise}\n\t */\n\tdeleteModule(id) {\n\t\treturn this._back.deleteModule(id).then(() => {\n\t\t\tthis._local.getModules().remove(id);\n\t\t});\n\t}\n\n\t/**\n\t * Creates a module copy\n\t * @param {number} id - a module id\n\t * @returns {Promise} that is resolved with a new id\n\t */\n\tcopyModule(id) {\n\t\tconst mod = this._local.getModules().getItem(id);\n\t\tconst _ = this._app.getService(\"locale\")._;\n\t\treturn this.addModule({\n\t\t\tname: _(\"Copy of\") + \" \" + mod.name,\n\t\t\ttext: mod.text,\n\t\t});\n\t}\n\t/**\n\t * Adds or updates a module\n\t * @param {Object} data - a new module data\n\t * @returns {Promise} that is resolved with a new id\n\t */\n\taddModule(data) {\n\t\treturn this._back.addModule(data).then(res => {\n\t\t\tthis._local.getModules().add({ id: res.id, ...data });\n\t\t\treturn res.id;\n\t\t});\n\t}\n\t/**\n\t * Updates a module data\n\t * @param {number} id - {Number} a module id\n\t * @param {Object} data - a module data object\n\t * @returns {Promise} that is resolved with an item id\n\t */\n\tupdateModule(id, data) {\n\t\treturn this._back.updateModule(id, data).then(res => {\n\t\t\tthis._local.getModules().updateItem(id, data);\n\t\t\treturn res.id;\n\t\t});\n\t}\n\n\t/**\n\t * Gets a hash of module properties to save\n\t * @param {Object} moduleProps - a hash of module state properties\n\t * @returns {Object}\n\t */\n\tgetModuleSaveData(moduleProps) {\n\t\tconst {\n\t\t\tdesc,\n\t\t\tdata,\n\t\t\tjoins,\n\t\t\tquery,\n\t\t\tcolumns,\n\t\t\tgroup,\n\t\t\tbuckets,\n\t\t\tmeta,\n\t\t\tsort,\n\t\t\ttype,\n\t\t} = moduleProps;\n\t\treturn {\n\t\t\tdesc,\n\t\t\tdata,\n\t\t\tjoins,\n\t\t\tquery,\n\t\t\tcolumns,\n\t\t\tgroup,\n\t\t\tbuckets,\n\t\t\tmeta,\n\t\t\tsort,\n\t\t\ttype,\n\t\t};\n\t}\n\n\t/**\n\t * Adds a query\n\t * @param {Object} data - a query data object\n\t * @returns {Promise} a promise that is resolved with a new id\n\t */\n\taddQuery(data) {\n\t\treturn this._back.addQuery(data).then(res => {\n\t\t\tthis._local.getQueries().add({ id: res.id, ...data });\n\t\t\treturn res.id;\n\t\t});\n\t}\n\t/**\n\t * Updates a query\n\t * @param {number} id - a query id\n\t * @param {Object} data - a query data object\n\t * @returns {Promise} a promise that is resolved with a query id\n\t */\n\tupdateQuery(id, data) {\n\t\treturn this._back.updateQuery(id, data).then(res => {\n\t\t\tthis._local.getQueries().updateItem(id, data);\n\t\t\treturn res.id;\n\t\t});\n\t}\n\t/**\n\t * Deletes query\n\t * @param {number} id - query id\n\t * @returns {Promise}\n\t */\n\tdeleteQuery(id) {\n\t\treturn this._back.deleteQuery(id).then(() => {\n\t\t\tthis._local.getQueries().remove(id);\n\t\t});\n\t}\n}\n","export default class Helpers {\n\tconstructor() {\n\t\tthis.replacements = [\n\t\t\t{ from: /(^ +)/g, to: \"\" },\n\t\t\t//{ from: /(^\\w+)/g, to: \"^($&)\" },\n\t\t\t{ from: /(\\w+)/g, to: \"($&)\" },\n\t\t\t{ from: /^(\\?)/g, to: \"^\\\\S{1}\" },\n\t\t\t{ from: /(\\?)/g, to: \"\\\\S{1}\" },\n\t\t\t{ from: /(\\*)/g, to: \"\\\\S*\" },\n\t\t\t{ from: /( +)$/g, to: \"$\" },\n\t\t];\n\t}\n\n\twildToRegexp(wild) {\n\t\tfor (let i = 0; i < this.replacements.length; ++i) {\n\t\t\twild = wild.replace(this.replacements[i].from, this.replacements[i].to);\n\t\t}\n\t\treturn wild;\n\t}\n\tmatchPerColumn(id, match) {\n\t\treturn a => match(a[id]);\n\t}\n\n\tfindOptions(collection, regexp) {\n\t\tconst res = {};\n\t\tcollection\n\t\t\t.find(obj => regexp.test(obj.value))\n\t\t\t.forEach(a => (res[a.id] = 1));\n\t\treturn res;\n\t}\n\n\thasNonDigits(input) {\n\t\t// exceptions are: ?, *, /, ., space\n\t\treturn /\\D/gi.test(input.replace(/[?*/. ]/g, \"\"));\n\t}\n}\n","export default class Charts {\n\tconstructor(_app) {\n\t\tthis._app = _app;\n\t\tthis.type = \"line\";\n\t\tthis.type = \"line\";\n\t\tthis.colors = [\n\t\t\t\"#FF9700\",\n\t\t\t\"#4CB050\",\n\t\t\t\"#00BCD4\",\n\t\t\t\"#3F51B5\",\n\t\t\t\"#9C28B1\",\n\t\t\t\"#F34336\",\n\t\t\t\"#FFEA3B\",\n\t\t\t\"#009788\",\n\t\t\t\"#2196F3\",\n\t\t\t\"#673BB7\",\n\t\t\t\"#EA1E63\",\n\t\t];\n\t\tthis.itemSupport = [\"line\", \"spline\", \"radar\"];\n\t\tthis.noAxisSupport = [\"pie\", \"donut\"];\n\t\tthis.lineTypes = [\"line\", \"spline\"];\n\t\tthis.multiTypeSupport = [\n\t\t\t\"bar\",\n\t\t\t\"stackedBar\",\n\t\t\t\"area\",\n\t\t\t\"stackedArea\",\n\t\t\t\"splineArea\",\n\t\t];\n\t\tthis.numLimit = 30;\n\t}\n\t/*\n\tGet chart type data.\n\tCreate an array of objects {id, value}\n\tand return this array.\n\t*/\n\tgetTypes() {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\t\tif (!this.types)\n\t\t\tthis.types = [\n\t\t\t\t{ id: \"line\", value: _(\"Line\"), icon: \"rpi-chart-line\" },\n\t\t\t\t{\n\t\t\t\t\tid: \"spline\",\n\t\t\t\t\tvalue: _(\"Spline\"),\n\t\t\t\t\ticon: \"rpi-chart-bell-curve-cumulative\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"area\",\n\t\t\t\t\tvalue: _(\"Area\"),\n\t\t\t\t\ticon: \"rpi-chart-areaspline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"stackedArea\",\n\t\t\t\t\tvalue: _(\"Stacked area\"),\n\t\t\t\t\ticon: \"rpi-chart-line-stacked\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"splineArea\",\n\t\t\t\t\tvalue: _(\"Spline area\"),\n\t\t\t\t\ticon: \"rpi-chart-areaspline-variant\",\n\t\t\t\t},\n\n\t\t\t\t{ id: \"bar\", value: _(\"Bar\"), icon: \"rpi-chart-bar\" },\n\t\t\t\t{\n\t\t\t\t\tid: \"stackedBar\",\n\t\t\t\t\tvalue: _(\"Stacked bar\"),\n\t\t\t\t\ticon: \"rpi-chart-bar-stacked\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"radar\",\n\t\t\t\t\tvalue: _(\"Radar\"),\n\t\t\t\t\ticon: \"rpi-vector-triangle\",\n\t\t\t\t},\n\t\t\t];\n\t\treturn this.types;\n\t}\n\n\tgetItemTypes() {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\t\tif (!this.itemTypes)\n\t\t\tthis.itemTypes = [\n\t\t\t\t{\n\t\t\t\t\tid: \"r\",\n\t\t\t\t\tvalue: _(\"circle\"),\n\t\t\t\t\ticon: \"rpi-circle-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"s\",\n\t\t\t\t\tvalue: _(\"square\"),\n\t\t\t\t\ticon: \"rpi-square-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"t\",\n\t\t\t\t\tvalue: _(\"triangle\"),\n\t\t\t\t\ticon: \"rpi-triangle-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"d\",\n\t\t\t\t\tvalue: _(\"diamond\"),\n\t\t\t\t\ticon: \"rpi-rhombus-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"no\",\n\t\t\t\t\tvalue: _(\"no markers\"),\n\t\t\t\t},\n\t\t\t];\n\t\treturn this.itemTypes;\n\t}\n\n\tgetSeries(fiedls, type) {\n\t\tlet data = [];\n\t\tlet colorIndex = 0;\n\t\tfiedls.forEach(field => {\n\t\t\tlet series = {\n\t\t\t\tid: field.id,\n\t\t\t\tname: field.value,\n\t\t\t\tmodel: field.model || null,\n\t\t\t\tshow: true,\n\t\t\t\tmeta: {\n\t\t\t\t\tname: field.value,\n\t\t\t\t\tcolor: this.colors[colorIndex] || this.colors[0],\n\t\t\t\t},\n\t\t\t};\n\t\t\tcolorIndex++;\n\n\t\t\tif (this.itemSupport.indexOf(type) != -1) {\n\t\t\t\tseries.meta.markerType = \"r\";\n\t\t\t\tseries.meta.fillMarker = false;\n\t\t\t}\n\t\t\tdata.push(series);\n\t\t});\n\t\treturn data;\n\t}\n}\n","import { JetApp, plugins, EmptyRouter } from \"webix-jet\";\nimport { createState, link } from \"jet-restate\";\n\nimport views from \"./export_views\";\nimport en from \"locales/en\";\n\nimport { initJetWin } from \"@xbs/jet-helpers\";\n\n// services\nimport Local from \"./models/Local\";\nimport Backend from \"./models/Backend\";\nimport Operations from \"./models/Operations\";\nimport Helpers from \"./models/Helpers\";\nimport Charts from \"./models/Charts\";\n\nexport class App extends JetApp {\n\tconstructor(config) {\n\t\tconst state = createState({\n\t\t\tmoduleId: config.moduleId || null,\n\t\t\tmodule: null,\n\t\t\tmode: config.mode || \"list\",\n\t\t\ttoolbar: config.toolbar === false ? false : true,\n\t\t\tsaved: true,\n\t\t\treadonly: config.readonly || false,\n\t\t});\n\t\tconst params = { state };\n\n\t\tconst defaults = {\n\t\t\trouter: EmptyRouter,\n\t\t\tdebug: true,\n\t\t\tstart: \"/top/empty\",\n\t\t\tparams,\n\t\t};\n\n\t\tsuper({ ...defaults, ...config });\n\n\t\t// better error reporting\n\t\tif (this.config.debug) {\n\t\t\twebix.Promise = window.Promise;\n\t\t}\n\n\t\tconst dynamic = obj =>\n\t\t\tthis.config.override ? this.config.override.get(obj) || obj : obj;\n\n\t\tthis.setService(\"local\", new (dynamic(Local))(this));\n\t\tthis.setService(\"backend\", new (dynamic(Backend))(this));\n\t\tthis.setService(\"helpers\", new (dynamic(Helpers))(this));\n\t\tthis.setService(\"charts\", new (dynamic(Charts))(this));\n\t\tthis.setService(\"operations\", new (dynamic(Operations))(this));\n\n\t\tinitJetWin(this);\n\n\t\tthis.use(\n\t\t\tplugins.Locale,\n\t\t\tthis.config.locale || {\n\t\t\t\tlang: \"en\",\n\t\t\t\twebix: {\n\t\t\t\t\ten: \"en-US\",\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\trequire(type, name) {\n\t\tif (type === \"jet-views\") return views[name];\n\t\telse if (type === \"jet-locales\") return locales[name];\n\n\t\treturn null;\n\t}\n\n\t// for external users\n\tgetState() {\n\t\treturn this.config.params.state;\n\t}\n}\n\nwebix.protoUI(\n\t{\n\t\tname: \"reports\",\n\t\tapp: App,\n\t\tgetState() {\n\t\t\treturn this.$app.getState();\n\t\t},\n\t\tgetService(name) {\n\t\t\treturn this.$app.getService(name);\n\t\t},\n\t\t$init() {\n\t\t\tconst state = this.$app.getState();\n\t\t\tfor (let key in state) {\n\t\t\t\tlink(state, this.config, key);\n\t\t\t}\n\t\t},\n\t},\n\twebix.ui.jetapp\n);\n\n// re-export for customization\nconst services = {\n\tLocal,\n\tBackend,\n\tHelpers,\n\tCharts,\n};\nconst locales = { en };\nexport { views, locales, services };\n","export default {\n\t\"Add column\": \"Add column\",\n\t\"All reports\": \"All reports\",\n\t\"Are you sure to delete this report?\": \"Are you sure to delete this report?\",\n\t\"Are you sure to delete this query?\": \"Are you sure to delete this query?\",\n\tAverage: \"Average\",\n\tCancel: \"Cancel\",\n\tChart: \"Chart\",\n\tColumn: \"Column\",\n\tColumns: \"Columns\",\n\tcolumn: \"column\",\n\t\"Color column\": \"Color column\",\n\tCommon: \"Common\",\n\t\"Copy of\": \"Copy of\",\n\tCount: \"Count\",\n\t\"Created on\": \"Created on\",\n\tData: \"Data\",\n\t\"Data source\": \"Data source\",\n\tDay: \"Day\",\n\tDelete: \"Delete\",\n\t\"Delete report\": \"Delete report\",\n\tDescription: \"Description\",\n\tQuery: \"Query\",\n\tEdit: \"Edit\",\n\t\"Enter query name\": \"Enter query name\",\n\tExport: \"Export\",\n\t\"To Excel\": \"To Excel\",\n\t\"To CSV\": \"To CSV\",\n\t\"To PNG\": \"To PNG\",\n\t\"To PDF\": \"To PDF\",\n\tFilter: \"Filter\",\n\t\"Filtering query\": \"Filtering query\",\n\t\"Frozen columns above\": \"Frozen columns above\",\n\tFunction: \"Function\",\n\tGroup: \"Group\",\n\t\"Group summaries\": \"Group summaries\",\n\t\"Join data\": \"Join data\",\n\tHeatmap: \"Heatmap\",\n\t\"Labels column\": \"Labels column\",\n\tMax: \"Max\",\n\tMin: \"Min\",\n\tMonth: \"Month\",\n\tNew: \"New\",\n\t\"Click 'New' button to add a new report\":\n\t\t\"Click 'New' button to add a new report\",\n\t\"Select any report from the list\": \"Select any report from the list\",\n\t\"No reports\": \"No reports\",\n\t\"No saved queries\": \"No saved queries\",\n\t\"Last modified\": \"Last modified\",\n\t\"New column name\": \"New column name\",\n\t\"New report\": \"New report\",\n\t\"Please delete the related query filter first\":\n\t\t\"Please delete the related query filter first\",\n\t\"Please delete the related group rule first\":\n\t\t\"Please delete the related group rule first\",\n\tRename: \"Rename\",\n\t\"Report name\": \"Report name\",\n\tReports: \"Reports\",\n\tSave: \"Save\",\n\t\"Save query\": \"Save query\",\n\tSort: \"Sort\",\n\t\"Specify columns to group by and output(s)\":\n\t\t\"Specify columns to group by and output(s)\",\n\t\"Specify columns to sort by\": \"Specify columns to sort by\",\n\tSum: \"Sum\",\n\tTable: \"Table\",\n\tTitle: \"Title\",\n\t\"Type to search\": \"Type to search\",\n\tView: \"View\",\n\tYear: \"Year\",\n\t//chart\n\tAxes: \"Axes\",\n\t\"X Axis\": \"X Axis\",\n\t\"Y Axis\": \"Y Axis\",\n\tcolumns: \"columns\",\n\trows: \"rows\",\n\t\"Data series\": \"Data series\",\n\t\"Chart type\": \"Chart type\",\n\t\"Keys column\": \"Keys column\",\n\t\"X axis column\": \"X axis column\",\n\t\"Values column\": \"Values column\",\n\tColor: \"Color\",\n\t\"Marker type\": \"Marker type\",\n\t\"Fill marker\": \"Fill marker\",\n\tLegend: \"Legend\",\n\t\"Logarithmic scale\": \"Logarithmic scale\",\n\tGridlines: \"Gridlines\",\n\tBottom: \"Bottom\",\n\tNone: \"None\",\n\tRight: \"Right\",\n\tLine: \"Line\",\n\tSpline: \"Spline\",\n\tArea: \"Area\",\n\t\"Stacked area\": \"Stacked area\",\n\t\"Spline area\": \"Spline area\",\n\tBar: \"Bar\",\n\t\"Stacked bar\": \"Stacked bar\",\n\tRadar: \"Radar\",\n\t\"Create copy\": \"Create copy\",\n\tcircle: \"circle\",\n\tsquare: \"square\",\n\ttriangle: \"triangle\",\n\tdiamond: \"diamond\",\n\t\"no markers\": \"no markers\",\n\t\"Vertical labels\": \"Vertical labels\",\n\t\"Extract series from\": \"Extract series from\",\n\tTrue: \"True\",\n\tFalse: \"False\",\n\t\"Save filter to use it in other reports\":\n\t\t\"Save filter to use it in other reports\",\n\t\"No filter\": \"No filter\",\n\tText: \"Text\",\n\tSelect: \"Select\",\n\tbuckets: \"buckets\",\n\t\"Data buckets\": \"Data buckets\",\n\t\"Bucket name\": \"Bucket name\",\n\t\"Bucket values\": \"Bucket values\",\n\t\"Add bucket\": \"Add bucket\",\n\t\"Specify columns and their data buckets\":\n\t\t\"Specify columns and their data buckets\",\n\tSearch: \"Search\",\n\tOther: \"Other\",\n\t\"Other values\": \"Other values\",\n\t\"Are you sure to delete?\": \"Are you sure to delete?\",\n};\n"],"names":["webix","config","this","webixJet","_events","_subs","_data","params","extend","JetBase","_root","_detachEvents","_destroySubs","_container","app","_parent","id","value","url","_segment","update","show","parent","view","getParentView","getParam","suburl","toString","root_1","getRoot","queryView","obj","localId","$scope","name","code","attachEvent","push","key","kid","contains","sub","getSubViewInfo","subview","popup","events","i","length","detachEvent","subView","destructor","current","default","branch","child","_getDefaultSub","_routed_view","parse","substr","parts","split","chunks","test","result","pos","indexOf","params_1","_i","dchunk","decodeURIComponent","page","isNew","url2str","stack","stack_1","chunk","obj2str","join","str","encodeURIComponent","route","index","_next","path","Route","slice","setParams","old","kids","reset","concat","_join","Promise","res","rej","redirect","confirm","resolve","callEvent","NavigationBlocked","catch","err","then","_this","n","_super","_children","__extends","JetView","ui","container","jetview","createView","render","setParam","parent_1","target","_renderFrameLock","_show","segment","_init_url_data","_urlChange","linkRouter","getRouter","set","silent","_$view","_$","_$url","message","destroy","_destroyKids","plugin","getUrl","tagName","refresh","_render","root","document","body","toNode","cfg","_render_final","response","slot","$$","reject","copyConfig","oldui","parent_2","asWin","setPosition","isVisible","_init","_initUrl","ready","e","_initError","init","waits","frame","wait","all","urlChange","lock","_renderFrame","next","_createSubView","shift","_override","error","createFromURL","uis","_ui","JetViewRaw","cb","SubRouter","a","append","_once","window","version","start","_services","EventSystem","JetAppBase","_subSegment","handler","getSubView","prototype","$subview","addSubView","isArray","Array","method","point","DataCollection","RegExp","Map","Date","copy","$router","srcElement","getAttribute","trigger_1","_forView","trigger","cancelBubble","preventDefault","route_1","parentNode","clickHandler","views","_loadError","Error","hidden","replace","require","module","__esModule","loadView","over","override","dv","get","router","rest","apply","data","bind","er","debug","console","text","innerHTML","type","expire","event","_first_start","top","base","setTimeout","animation","node_1","html","addCss","removeCss","now","urlString","template","uid","_detectPrefix","onpopstate","HashRouter","routes","compare","history","pushState","prefix","sufix","_getRaw","routerPrefix","location","href","isPatched","patch","w","win","promise","freeze","some","$freeze","resize","baseAdd","baselayout","addView","baseRemove","removeView","jview_1","subs_1","arguments","subs","layout","protoUI","$init","$app","$ready","proxy","JetApp","UrlRouter","pathname","search","_$config","EmptyRouter","has","store","Object","hasOwnProperty","call","forEach","context","warn","x","String","russianPluralGroups","end","pluralTypes","arabic","lastTwo","bosnian_serbian","chinese","croatian","french","german","russian","lithuanian","czech","polish","icelandic","slovenian","pluralTypeToLanguages","pluralTypeName","locale","ret","langToPluralType","langs","lang","en","escape","token","dollarRegex","defaultTokenRegex","transformPhrase","phrase","substitutions","tokenRegex","TypeError","interpolationRegex","options","smart_count","texts","count","pluralTypeIndex","expression","argument","Polyglot","opts","phrases","currentLocale","allowMissing","onMissingKey","suffix","RangeError","constructTokenRegex","interpolation","newLocale","morePhrases","prefixedKey","unset","clear","newPhrases","t","_","webixPolyglot","plugins","_view","storage","setLangData","pconfig","polyglot","poly","service","put","locName","i18n","setLocale","setLang","getLang","setService","ignoreInitial","withContext","link","source","defineProperty","createState","handlers","out","observe","mask","undefined","queue","waitInQueue","notify","meta","list","keys","enumerable","configurable","values_1","sconfig","nested","reactive","$extend","val","valueOf","BaseExportView","padding","subMenuPos","borderless","subsign","css","GetTemplate","width","submenuConfig","autowidth","autoheight","GetData","on","onMenuItemClick","PopupAction","getService","hide","icon","node","delay","BaseToolbarView","height","skin","$active","barHeight","left","right","bottom","margin","cols","label","click","ShowExportPopup","viewId","ExportMenu","$view","Show","ChartView","rows","Toolbar","State","Local","Charts","getChildViews","Bar","Host","$changes","mod","mode","Export","host","CheckColumns","columns","config_1","GetChartConfig","GetChartData","_a","chart","seriesFrom","ConvertDataBySeries","FormatLabels","numLimit","Chart","labelColumn","labelOptions","find","op","field","item","option","o","fields","dateFormatStr","chartType","legendPosition","series","axises","seriesConfig","s","ApplyTypeConfig","onAfterRender","CorrectLabels","legend","GetLegendConfig","xAxis","yAxis","y","logarithmic","scale","verticalLabels","values","itemTypes","itemSupport","color","markerType","getTextSize","valign","align","getData","getDataConfig","getOptions","fill","area","alpha","radius","borderColor","fillMarker","line","disableItems","border","baseColumn","dataColumn","arr","row","group","aRow","offset","querySelector","className","toPNG","toPDF","display","ctrl","bindOut","els","elements","subkey","getList","newValue","getValue","v","k","setValue","el","bindIn","_value","clearAll","global","factory","types","table","heatmap","empty","main","alt","CommonView","scroll","elementsConfig","labelWidth","labelPosition","JoinListTemplate","onClick","webix_rpt_action_remove","ev","RemoveJoin","ShowJoins","inputWidth","AppState","Models","getModels","map","m","ShowDeleteButton","SourcesList","JoinTemplate","getBody","getItem","AddJoin","batch","addJoin","tid","joins","$batch","cleanLinkedModels","block","filter","alert","sid","f","sf","tf","getLinkedModels","toolbar","prompt","defer","updateConfig","head","hotkey","getTopParentView","close","button","newname","getValues","onShow","input","getInputNode","focus","selectMask","select","$cssName","on_click","webix_rpt_qselect_icon","richselect","exports","extendStatics","d","b","setPrototypeOf","__proto__","p","__","constructor","create","__assign","assign","getUrlString","size","use","_loadViewDynamic","action","_loop_1","webix$1","key2","ActionsPopupView","yCount","Item","Hide","dataPadding","BaseView","GetButton","Add","GetList","AND","OR","GLUE","glue","scheme","$serialize","condition","includes","$css","open","editCss","DisableSwitch","Template","action-menu","Actions","action-close","Delete","wbq-filter_join","SwitchGlue","onItemDblClick","EditStart","EditStop","AddGroup","LastValue","JSON","stringify","ConvertTo","rules","ConvertFrom","getBranch","after","getParentId","getBranchIndex","getFirstId","add","CreateMode","updateItem","Save","DeleteSilent","exists","remove","grand","pIndex","move","Active","GetValue","ActiveId","asString","Format","format","parser","FilterView","onChange","AdjustToField","ApplyFilter","GetField","fselect","CreateFilter","conditions","place","rule","FilterPopup","at","TopBarView","$name","env","scrollSize","paddingX","paddingY","getItemNode","TopListView","classList","Backend","_app","save","log","queryToFilter","query","ops","filters","findIndex","isUndefined","con","singleFilter","glueOr","glueAnd","App","state","defaults","simple","dynamic","locales","getState","GetFilter","getFilterFunction","jetapp","services","Add filter","in","equal","notEqual","less","greater","greaterOrEqual","lessOrEqual","notContains","beginsWith","notBeginsWith","endsWith","notEndsWith","between","notBetween","and","or","Edit","Add Filter","Add Group","Apply","Cancel","define","amd","self","QueryView","local","column","getFieldData","model","fixDates","$observe","c","QueryBuilderView","visibleBatch","tooltip","DeleteQuery","CopyQuery","RenameQuery","disabled","SaveQuery","suggest","QSelectTemplate","minHeight","firstChild","setAttribute","onClearClick","NewQuery","Query","Operations","qData","Queries","getQueries","LocalState","saved","waitData","tables","models","sync","each","changed","saveBtn","disable","enable","showBatch","updateQuery","addQuery","title","ok","cancel","deleteQuery","QueryMenu","TopView","tabbar","optionWidth","tabMinWidth","ShowView","initial","newModule","ChangeModule","ctx","load","ChangeModel","ShowHideButton","timer","clearTimeout","debounce","TrackChanges","_key","oldColumns","getFields","numColumns","UpdateMeta","publicFields","prev_1","groupColumns","by","was_1","now_1","Reset","getModuleSaveData","moduleId","updateModule","SaveCallback","addModule","getModule","setDataSource","InitStateValue","InitName","getSeries","masterName","Name","SummaryPopupView","ClickHandler","GetOptions","ApplyAction","SetActionStates","disableItem","enableItem","pstate","ParentState","BucketView","ValueSeparator","inputs","layoutMargin","form","other","placeholder","Changed","isNotEmpty","layoutPadding","AddNewBucket","Forms","GetRowKeys","Data","sort","Sort","CreateForm","Focus","keys_1","GetColumnData","baseOptions","keyOption","appState","moduleConfig","buckets","getOptionsList","LoadBuckets","AddBucket","bucket","LoadOther","setValues","GetRowForm","separator","OptionTemplate","onBeforeShow","ShowPopup","Popup","ActiveForm","GetValues","otherForm","otherName","validate","names","ForEachFormRow","markInvalid","CorrectValues","GetValidBuckets","selected","$checked","DeleteBucket","isNaN","toLowerCase","forms","master","Master","fitMaster","onItemClick","List","AddColumn","View","onEnter","getSelectedItem","BucketState","Text","Find","offsetWidth","adjust","GetColumns","selectIcon","modifiers","renderModifier","mid","_modifiers","$renderTag","content","aria","removeItem","webix_rpt_date_selector","locate","multicombo","getModifier","setModifier","$setSize","_custom_last_size","px","py","BucketSettingsView","Views","ShowColumns","header","Update","fillspace","common","RowTemplate","ToggleSub","_hasFocus","activeElement","onSubViewOpen","HideAllEditors","onSubViewClose","ResetEditor","webix_rpt_bucket_delete","RemoveColumn","Table","newColumn","ColumnList","BucketPopup","tableData","splice","_ActiveEditor","newV","oldV","openSub","subrow","prevId","closeSub","FocusEditor","$subopen","DateView","GetPopupTemplate","ActiveGroup","isSelected","Summaries","labels","AddNewAggregation","GroupState","SummaryColumns","ValidateFormData","aggregate","LoadAggregations","ApplyOneRowMode","AddAggregation","summary","aggregation","GetDefaultFormData","formId","GetOperations","onTimedKeypress","groupBy","operations","NewColumnTemplate","j","this_1","operation","DeleteAggregation","formList","valid","oId","cId","ChangeNewColumnName","OtherSettingsView","GetDateOptions","ChangeGroupBy","onModifierClick","ShowModifierPopup","groupState","LoadColumns","getPopup","ListTemplate","DatePopup","DatePopupView","ToggleGroupBy","ToggleBuckets","ToggleSortBy","gravity","ChangeSortBy","ChangeDirection","sortBy","chartState","Axis","ChartState","AxisPropertiesView","labelAlign","ApplyYAxis","ApplyXAxis","lineColor","BaseStructureView","SaveOrder","Id","ColorPopupView","onColorSelect","GetSeries","updatedSeries","closeIcon","$renderInput","badge","webix_input_icon","hideCloseIcon","_onSearch","showCloseIcon","setIcon","nodes","getElementsByClassName","setBadge","class","appendChild","Series","SeriesPropertiesView","ItemListTemplate","getItemTypes","getTypes","labelField","ChangeLabelField","valueFields","editable","SubState","UpdateSeries","SeriesProperties","drag","onAfterDrop","data->onClearAll","webix_rpt_chart_color","ShowColorPopup","action-visible","HideField","action-hidden","ShowField","webix_rpt_config_row_name","axisFields","axis","UpdateAxis","AxisProperties","AxisRowTemplate","legendFields","ChangeLegend","GetDataInputs","Types","Fields","ValueFields","GetInitState","UpdateModuleState","prev","ApplyChartType","ApplySeriesFrom","GenerateSeries","prevType","ShowAxisInputs","RenderSeries","LoadSeries","noAxisSupport","lines","sourceArray","ApplySeriesKeys","base_1","prevValue","ind","ColorPopup","ActiveSeries","serialize","col","Column","ColumnPropertiesView","valueField","colorField","lc","vc","cc","OnChange","check","StructureView","ChangeReportType","ColumnsView","onSearchChange","FilterFields","ColumnProperties","onBeforeDrag","$width","FrozenTemplate","GetFreeze","order","freezeColumn","EmptyView","mods","getModules","GetText","GetSVG","TableView","cssClass","CssFactory","TooltipFactory","prop","min","Infinity","max","step","bases","valueColumn","colorColumn","props","MenuPopup","ID","trg","GridsView","icons","asc","desc","rowHeight","GetListTemplate","$change","date","webix_rpt_action_menu","Menu","onDblClick","onAfterSelect","LoadModule","Sorting","dir","SearchCompare","parsed","longDateFormatStr","updated","readonly","sState","prevState","as","ChangeSortButtons","btn","prevBtn","ExportView","ToolbarView","maxWidth","minWidth","typeToSort","number","boolean","picklist","reference","ignore","$selection","plainOutput","filterHTML","toExcel","toCSV","GetTableConfig","table_1","GetTableData","$destructed","IsBucketColumn","getColumnConfig","collection","groups","dateColumns","gColumns","GetColumnConfig","edit","grid","resizeColumn","headerOnly","leftSplit","onColumnResize","byUser","SetColWidth","_1","Tbl","blockEvent","setColumnWidth","unblockEvent","h","clearCss","ignoreDateNumber_1","hasNonDigits","regexp_1","wildToRegexp","matchers_1","colId","optionsMatch_1","findOptions","matchPerColumn","dateFormats_1","found_1","showItem","UIManager","addHotKey","removeHotKey","offIcon","onIcon","SetVisibleButtons","newBtn","deleteModule","copyModule","m0","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","m13","m14","m15","m16","m17","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","m30","m31","m32","m33","setSize","appView","appWidth","appHeight","$height","_fillApp","setHandlers","resizeEv","_fieldData","_optionsData","_modules","$sort","modules","_models","_models_async","refs","ref","_refs","major","newField","limit","onlyNew","getRefs","was","origin","links","queryObj","collectTables","check_1","_queries","q","r","_url","ajax","json","post","del","_local","_back","moduleProps","replacements","from","to","Helpers","wild","match","regexp","colors","lineTypes","multiTypeSupport","fiedls","colorIndex","appId","appNode","addStyle","fullscreen","firstShow","defaultHandler","Add column","All reports","Are you sure to delete this report?","Are you sure to delete this query?","Average","Columns","Color column","Common","Copy of","Count","Created on","Data source","Day","Delete report","Description","Enter query name","To Excel","To CSV","To PNG","To PDF","Filter","Filtering query","Frozen columns above","Function","Group","Group summaries","Join data","Heatmap","Labels column","Max","Min","Month","New","Click 'New' button to add a new report","Select any report from the list","No reports","No saved queries","Last modified","New column name","New report","Please delete the related query filter first","Please delete the related group rule first","Rename","Report name","Reports","Save query","Specify columns to group by and output(s)","Specify columns to sort by","Sum","Title","Type to search","Year","Axes","X Axis","Y Axis","Data series","Chart type","Keys column","X axis column","Values column","Color","Marker type","Fill marker","Legend","Logarithmic scale","Gridlines","Bottom","None","Right","Line","Spline","Area","Stacked area","Spline area","Stacked bar","Radar","Create copy","circle","square","triangle","diamond","no markers","Vertical labels","Extract series from","True","False","Save filter to use it in other reports","No filter","Select","Data buckets","Bucket name","Bucket values","Add bucket","Specify columns and their data buckets","Search","Other","Other values","Are you sure to delete?"],"mappings":"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"}